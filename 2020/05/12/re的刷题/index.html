<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="buuctf,">










<meta name="description" content="教练我要学逆向！！！">
<meta name="keywords" content="buuctf">
<meta property="og:type" content="article">
<meta property="og:title" content="re的刷题">
<meta property="og:url" content="http://yoursite.com/2020/05/12/re的刷题/index.html">
<meta property="og:site_name" content="SunDaSheng&#39;s blog">
<meta property="og:description" content="教练我要学逆向！！！">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/D:%5Cstudy%5C%E7%9E%8C%E7%9D%A1%E8%99%AB-%E5%AE%89%E5%85%A8%5C%E9%A2%98%E7%9B%AE%5Cre%5Creverse1%5CSnipaste_2020-05-05_20-15-53.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E6%2596%25B0%25E5%25B9%25B4%25E5%25BF%25AB%25E4%25B9%2590/Snipaste_2020-05-05_21-14-01.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E6%2596%25B0%25E5%25B9%25B4%25E5%25BF%25AB%25E4%25B9%2590/Snipaste_2020-05-05_21-13-47.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E6%2596%25B0%25E5%25B9%25B4%25E5%25BF%25AB%25E4%25B9%2590/Snipaste_2020-05-05_21-26-53.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E6%2596%25B0%25E5%25B9%25B4%25E5%25BF%25AB%25E4%25B9%2590/Snipaste_2020-05-05_21-28-08.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E5%2586%2585%25E6%25B6%25B5%25E8%25BD%25AF%25E4%25BB%25B6/Snipaste_2020-05-06_19-15-27.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E4%25B8%258D%25E4%25B8%2580%25E6%25A0%25B7%25E7%259A%2584flag/Snipaste_2020-05-07_20-35-40.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/findit/Snipaste_2020-05-08_20-38-41.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/pyre/Snipaste_2020-05-11_17-10-58.png">
<meta property="og:updated_time" content="2020-05-12T09:46:42.663Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="re的刷题">
<meta name="twitter:description" content="教练我要学逆向！！！">
<meta name="twitter:image" content="http://yoursite.com/2020/05/12/re的刷题/D:%5Cstudy%5C%E7%9E%8C%E7%9D%A1%E8%99%AB-%E5%AE%89%E5%85%A8%5C%E9%A2%98%E7%9B%AE%5Cre%5Creverse1%5CSnipaste_2020-05-05_20-15-53.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/05/12/re的刷题/">





  <title>re的刷题 | SunDaSheng's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">SunDaSheng's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">hello,stupid wrold</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archives"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/12/re的刷题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SunDaSheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/zzx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SunDaSheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">re的刷题</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-12T17:40:47+08:00">
                2020-05-12
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-05-12T17:46:42+08:00">
                2020-05-12
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf/" itemprop="url" rel="index">
                    <span itemprop="name">ctf</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf/re/" itemprop="url" rel="index">
                    <span itemprop="name">re</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  41
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>教练我要学逆向！！！</p>
<a id="more"></a> 

<p>[TOC]</p>
<h2 id="day1-5-5"><a href="#day1-5-5" class="headerlink" title="day1    5.5"></a>day1    5.5</h2><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><p>拖进ida，shift+F12查找flag</p>
<blockquote>
<p>  IDA Pro:交互式反汇编器，是典型的递归下降反汇编器。</p>
<p>  导航条:<br>     蓝色 表示常规的指令函数<br>     黑色 节与节之间的间隙<br>     银白色 数据内容<br>     粉色 表示外部导入符号<br>     暗黄色 表示ida未识别的内容</p>
<p>  IDA主界面:<br>     IDA View三种反汇编视图:文本视图、图表视图、路径视图<br>     Hex View 十六进制窗口<br>     Imports 导入函数窗口<br>     Struceures 结构体窗口<br>     Exports 导出函数窗口<br>     Enums 枚举窗口<br>     Strings 字符串窗口</p>
<p>  常用功能及快捷键:<br>     空格键:切换文本视图与图表视图<br>     ESC:返回上一个操作地址<br>     G:搜索地址和符号<br>     N:对符号进行重命名<br>     冒号键:常规注释<br>     分号键:可重复注释<br>     Alt+M:添加标签<br>     Ctrl+M:查看标签<br>     Ctrl+S:查看段的信息<br>     代码数据切换<br>     C–&gt;代码/D–&gt;数据/A–&gt;ascii字符串/U–&gt;解析成未定义的内容<br>     X:查看交叉应用<br>     F5:查看伪代码<br>     Alt+T:搜索文本<br>     Alt+B:搜索十六进制</p>
<p>  导入jni.h分析jni库函数。</p>
<p>  伪C代码窗口:<br>     右键<br>     comment-注释伪c代码。<br>     copy to -assembly-把伪c代码复制到反汇编窗口的汇编代码。</p>
<p>  IDA可以修改so的hex来修改so，edit，然后edit-patchrogram，<br>  在这里建议使用winhex来实现。</p>
<p>  原文链接：<a href="https://blog.csdn.net/qq_30531517/java/article/details/82559428" target="_blank" rel="noopener">https://blog.csdn.net/qq_30531517/java/article/details/82559428</a></p>
</blockquote>
<h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h3><p>查找flag找到</p>
<p>aThisIsTheRight db ‘this is the right flag!’,0Ah,0</p>
<p>接下来寻找什么时候调用的</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">loc_140011948:</span>                          <span class="comment">; CODE XREF: sub_1400118C0+61j</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011948</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, aInputTheFlag <span class="comment">; "input the flag:"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001194F                 <span class="keyword">call</span>    sub_1400111D1</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011954</span>                 <span class="keyword">lea</span>     <span class="built_in">rdx</span>, [<span class="built_in">rbp</span>+<span class="number">130h</span>+Str1]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011958</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, a20s       <span class="comment">; "%20s"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001195F                 <span class="keyword">call</span>    sub_14001128F</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011964</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, Str2       <span class="comment">; "&#123;hello_world&#125;"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001196B                 <span class="keyword">call</span>    j_strlen</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011970</span>                 <span class="keyword">mov</span>     <span class="built_in">r8</span>, <span class="built_in">rax</span>         <span class="comment">; MaxCount</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011973</span>                 <span class="keyword">lea</span>     <span class="built_in">rdx</span>, Str2       <span class="comment">; "&#123;hello_world&#125;"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001197A                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">130h</span>+Str1] <span class="comment">; Str1</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001197E                 <span class="keyword">call</span>    <span class="built_in">cs</span>:strncmp</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011984</span>                 <span class="keyword">test</span>    <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011986</span>                 <span class="keyword">jz</span>      short loc_140011996</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011988</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, aWrongFlag <span class="comment">; "wrong flag\n"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001198F                 <span class="keyword">call</span>    sub_1400111D1</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011994</span>                 <span class="keyword">jmp</span>     short loc_1400119A2</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011996</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011996</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011996</span> loc_140011996:                          <span class="comment">; CODE XREF: sub_1400118C0+C6j</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011996</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, aThisIsTheRight <span class="comment">; "this is the right flag!\n"</span></span><br></pre></td></tr></table></figure>

<p>第一次：hello_world，错误。</p>
<blockquote>
<p>  1，所用的寄存器不同于32下的eax,ebx,ecx,edx,esi,edi,esp,ebp等，在64位下是rax,rbx,rcx,rdx,rsi,rdi,rsp,rbp,此外又增加了r8,r9,r10,r11,r12,r13,r14,r15等寄存器。但eax,ax,ah,al等依然可用，且增加了spl,bpl等8位寄存器调用，r8等也可以用r8d,r8w,r8b进行32位，16位，8位的调用。<br>  2，函数调用参数传递不同于32下的stdcall规范，而采用fastcall，前四个参数为别放入rcx,rdx,r8,r9四个寄存器中，并在堆栈中留出4*8=32个字节的空间，多于四个的参数放入堆栈。<br>  3，函数调用后，由调用者负责堆栈回收。</p>
</blockquote>
<p>伪代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_1400118C0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v0; <span class="comment">// rdi@1</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// rcx@1</span></span><br><span class="line">  <span class="keyword">size_t</span> v2; <span class="comment">// rax@5</span></span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rax@9</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [sp+0h] [bp-20h]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v6; <span class="comment">// [sp+20h] [bp+0h]@4</span></span><br><span class="line">  <span class="keyword">char</span> Str1; <span class="comment">// [sp+48h] [bp+28h]@9</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [sp+128h] [bp+108h]@5</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// [sp+130h] [bp+110h]@4</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v5;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">82</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v0 = <span class="number">-858993460</span>;</span><br><span class="line">    v0 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = (<span class="keyword">unsigned</span> __int64)&amp;v6 ^ _security_cookie;</span><br><span class="line">  <span class="keyword">for</span> ( *(&amp;v6 + <span class="number">1</span>) = <span class="number">0</span>; ; ++*(&amp;v6 + <span class="number">1</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = *(&amp;v6 + <span class="number">1</span>);</span><br><span class="line">    v2 = j_strlen(Str2);</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt; v2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( Str2[(<span class="keyword">signed</span> __int64)*(&amp;v6 + <span class="number">1</span>)] == <span class="number">111</span> )</span><br><span class="line">      Str2[(<span class="keyword">signed</span> __int64)*(&amp;v6 + <span class="number">1</span>)] = <span class="number">48</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400111D1(<span class="string">"input the flag:"</span>);</span><br><span class="line">  sub_14001128F(<span class="string">"%20s"</span>, &amp;Str1);</span><br><span class="line">  v3 = j_strlen(Str2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(&amp;Str1, Str2, v3) )</span><br><span class="line">    sub_1400111D1(<span class="string">"this is the right flag!\n"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_1400111D1(<span class="string">"wrong flag\n"</span>);</span><br><span class="line">  sub_14001113B(&amp;v5, &amp;unk_140019D00);</span><br><span class="line">  <span class="keyword">return</span> sub_1400112E9((<span class="keyword">unsigned</span> __int64)&amp;v6 ^ v9);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  strncmp函数为字符串比较函数，字符串大小的比较是以ASCII 码表上的顺序来决定，此顺序亦为字符的值。其函数声明为int strncmp ( const char * str1, const char * str2, size_t n );功能是把 str1 和 str2 进行比较，最多比较前 <strong>n</strong> 个字节，若str1与str2的前n个字符相同，则返回0；若s1大于s2，则返回大于0的值；若s1 小于s2，则返回小于0的值。</p>
</blockquote>
<p>111为o，48为0，把str2字符串的o变成0</p>
<p>lea —-取内存单元的有效知地址指令，只用于传送地道址。</p>
<p>ptr—–是临时的类型转换，相当于C语言中的强制类型转换</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/D:%5Cstudy%5C%E7%9E%8C%E7%9D%A1%E8%99%AB-%E5%AE%89%E5%85%A8%5C%E9%A2%98%E7%9B%AE%5Cre%5Creverse1%5CSnipaste_2020-05-05_20-15-53.png" alt></p>
<h3 id="reserve2"><a href="#reserve2" class="headerlink" title="reserve2"></a>reserve2</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601080 ; char flag</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601080 flag            db 7Bh                  ; <span class="type">DATA</span> <span class="type">XREF</span>: main+34r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601080                                         ; main+44r ...</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601081 aHacking_for_fu db 'hacking_for_fun&#125;',0</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601081 _data           ends</span></span><br></pre></td></tr></table></figure>

<p>flag：hacking_for_fun}</p>
<p>伪代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span> ( pid )</span><br><span class="line">  &#123;</span><br><span class="line">    argv = (<span class="keyword">const</span> <span class="keyword">char</span> **)&amp;stat_loc;</span><br><span class="line">    waitpid(pid, &amp;stat_loc, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="built_in">strlen</span>(&amp;flag); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(&amp;flag + i) == <span class="number">105</span> || *(&amp;flag + i) == <span class="number">114</span> )</span><br><span class="line">        *(&amp;flag + i) = <span class="number">49</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"input the flag:"</span>, argv);</span><br><span class="line">  __isoc99_scanf(<span class="number">4196628L</span>L, &amp;s2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;flag, &amp;s2) )</span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">"this is the right flag!"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">"wrong flag!"</span>);</span><br><span class="line">  v4 = *MK_FP(__FS__, <span class="number">40L</span>L) ^ v9;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>105：i，114：r，49：1</p>
<p>试一试hack1ng_fo1_fun，起飞。</p>
<p>版本不兼容，后来点了以兼容模式运行</p>
<h3 id="新年快乐"><a href="#新年快乐" class="headerlink" title="新年快乐"></a>新年快乐</h3><p>打开有点不对</p>
<blockquote>
<p>  UPX是一个著名的压缩壳,主要功能是压缩PE文件(比如exe,dll等文件),有时候也可能被病毒用于免杀.壳upx是一种保护程序。一般是EXE文件的一种外保护措施，主要用途 ：</p>
<p>  1、让正规文件被保护起来，不容易被修改和破解。</p>
<p>  2、使文件压缩变小。</p>
<p>  3、保护杀毒软件安装程序，使之不受病毒侵害。</p>
<p>  4、木马，病毒的保护外壳，使之难以为攻破。 </p>
<ul>
<li><p>技术原理</p>
<p>对于可执行程序资源压缩,是保护文件的常用手段. 俗称加壳,加壳过的程序可以直接运行,但是不能查看源代码.要经过脱壳才可以查看源代码.</p>
<p>加壳：其实是利用特殊的算法，对EXE、DLL文件里的资源进行压缩。类似WINZIP的效果，只不过这个压缩之后的文件，可以独立运行，解压过程完全隐蔽，都在内存中完成。解压原理，是加壳工具在文件头里加了一段指令，告诉CPU，怎么才能解压自己。当加壳时，其实就是给可执行的文件加上个外衣。用户执行的只是这个外壳程序。当执行这个程序的时候这个壳就会把原来的程序在内存中解开，解开后，以后的就交给真正的程序。</p>
</li>
<li><p>加壳脱壳</p>
<p>程序为了反跟踪、被人跟踪调试、防止算法程序被别人静态分析就需要加壳。使用加壳软件加密代码和数据，就可以保护你程序数据的完整性，防止被程序修改和被窥视内幕。<br><a href="https://blog.csdn.net/dubuqingfenggzy/java/article/details/16881607" target="_blank" rel="noopener">https://blog.csdn.net/dubuqingfenggzy/java/article/details/16881607</a></p>
</li>
</ul>
</blockquote>
<p><img src="//yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E6%2596%25B0%25E5%25B9%25B4%25E5%25BF%25AB%25E4%25B9%2590/Snipaste_2020-05-05_21-14-01.png" alt="Snipaste_2020-05-05_21-14-01"></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E6%2596%25B0%25E5%25B9%25B4%25E5%25BF%25AB%25E4%25B9%2590/Snipaste_2020-05-05_21-13-47.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E6%2596%25B0%25E5%25B9%25B4%25E5%25BF%25AB%25E4%25B9%2590/Snipaste_2020-05-05_21-26-53.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E6%2596%25B0%25E5%25B9%25B4%25E5%25BF%25AB%25E4%25B9%2590/Snipaste_2020-05-05_21-28-08.png" alt></p>
<p>happly new year!</p>
<h2 id="day2-5-6"><a href="#day2-5-6" class="headerlink" title="day2    5.6"></a>day2    5.6</h2><h3 id="helloworld"><a href="#helloworld" class="headerlink" title="helloworld"></a>helloworld</h3><p>apk文件。</p>
<blockquote>
<p>  APK是Android操作系统使用的一种应用程序包文件格式，基于 ZIP 文件格式。</p>
</blockquote>
<p>我用jadx打开。</p>
<h3 id="内涵软件"><a href="#内涵软件" class="headerlink" title="内涵软件"></a>内涵软件</h3><p><img src="//yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E5%2586%2585%25E6%25B6%25B5%25E8%25BD%25AF%25E4%25BB%25B6/Snipaste_2020-05-06_19-15-27.png" alt></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">v3 = (<span class="keyword">int</span>)<span class="string">"DBAPP&#123;49d3c93df25caad81232130f3d2ebfad&#125;"</span>;</span><br><span class="line"><span class="keyword">while</span> ( v4 &gt;= <span class="number">0</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"距离出现答案还有%d秒，请耐心等待！\n"</span>, v4);</span><br><span class="line">  sub_40100A();</span><br><span class="line">  --v4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n\n\n这里本来应该是答案的,但是粗心的程序员忘记把变量写进来了,你要不逆向试试看:(Y/N)\n"</span>);</span><br><span class="line">v2 = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%c"</span>, &amp;v2);</span><br><span class="line"><span class="keyword">if</span> ( v2 == <span class="number">89</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"OD吾爱破解或者IDA这些逆向软件都挺好的！"</span>);</span><br><span class="line">  result = sub_40100A();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>内涵</p>
<h3 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h3><p>我傻了，没注意64位。</p>
<p>伪代码，v7是输入且33位异或后==global</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"Input your flag:\n"</span>, <span class="number">0L</span>L);</span><br><span class="line">  get_line(v7, <span class="number">256L</span>L);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v7) != <span class="number">33</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt; <span class="number">33</span>; ++i )</span><br><span class="line">    v7[i] ^= v7[i - <span class="number">1</span>];</span><br><span class="line">  v3 = (<span class="keyword">signed</span> __int64)global;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(v7, global, <span class="number">0x21</span>uLL) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Success"</span>, v3);</span><br></pre></td></tr></table></figure>

<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aFKWO_<span class="meta">@XZUPFVMD</span> </span><br><span class="line">db <span class="string">'f'</span>,<span class="number">0</span>Ah              </span><br><span class="line">; DATA <span class="string">XREF:</span> <span class="string">__data:</span>_globalo</span><br><span class="line">db <span class="string">'k'</span>,<span class="number">0</span>Ch,<span class="string">'w&amp;O.@'</span>,<span class="number">11</span>h,<span class="string">'x'</span>,<span class="number">0</span>Dh,<span class="string">'Z;U'</span>,<span class="number">11</span>h,<span class="string">'p'</span>,<span class="number">19</span>h,<span class="string">'F'</span>,<span class="number">1</span>Fh,<span class="string">'v"M#D'</span>,<span class="number">0</span>Eh,<span class="string">'g'</span>,<span class="number">6</span>,<span class="string">'h'</span>,<span class="number">0</span>Fh,<span class="string">'G2O'</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="string">'f'</span>, <span class="string">'k'</span>,<span class="number">0xC</span>,<span class="string">'w&amp;O.@'</span>,<span class="number">0x11</span>,<span class="string">'x'</span>,<span class="number">0xD</span>,<span class="string">'Z;U'</span>,<span class="number">0x11</span>,<span class="string">'p'</span>,<span class="number">0x19</span>,<span class="string">'F'</span>,<span class="number">0x1F</span>,<span class="string">'v"M#D'</span>,<span class="number">0x0E</span>,<span class="string">'g'</span>,<span class="number">6</span>,<span class="string">'h'</span>,<span class="number">0xF</span>,<span class="string">'G2O'</span>,<span class="number">0</span>]</span><br><span class="line"><span class="comment">#print(len(a))</span></span><br><span class="line"><span class="comment">#print(type(a[2]))</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    <span class="keyword">if</span> type(a[i]).__name__ == <span class="string">'int'</span>:</span><br><span class="line">        a[i]=chr(a[i])</span><br><span class="line">print(a)</span><br><span class="line">a=<span class="string">""</span>.join(a)</span><br><span class="line"><span class="comment">#print(len(a))</span></span><br><span class="line">flag=<span class="string">'f'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    flag+=chr(ord(a[i])^ord(a[i<span class="number">-1</span>]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>写的脚本有点问题，得到fg{QianQiuWanDai_YiTongJiangHu}O，应该是flag{QianQiuWanDai_YiTongJiangHu}</p>
<h3 id="guessgame"><a href="#guessgame" class="headerlink" title="guessgame"></a>guessgame</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lea</span>     <span class="built_in">rax</span>, aBjdS1mple_rev3 <span class="comment">; "BJD&#123;S1mple_ReV3r5e_W1th_0D_0r_IDA&#125;"</span></span><br></pre></td></tr></table></figure>

<p>签到题</p>
<h3 id="reserve-3"><a href="#reserve-3" class="headerlink" title="reserve_3"></a>reserve_3</h3><p>输入flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sub_41132F(<span class="string">"please enter the flag:"</span>, v4);</span><br><span class="line">sub_411375(<span class="string">"%20s"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;Str);</span><br><span class="line">v0 = j_strlen(&amp;Str);</span><br><span class="line">v1 = (<span class="keyword">const</span> <span class="keyword">char</span> *)sub_4110BE(&amp;Str, v0, &amp;v11);</span><br><span class="line"><span class="built_in">strncpy</span>(Dest, v1, <span class="number">0x28</span>u);</span><br><span class="line">sub_411127();</span><br><span class="line">i = j_strlen(Dest);</span><br><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; (<span class="keyword">signed</span> <span class="keyword">int</span>)j &lt; (<span class="keyword">signed</span> <span class="keyword">int</span>)i; ++j )</span><br><span class="line">   Dest[j] += j;</span><br><span class="line">v2 = j_strlen(Dest);</span><br><span class="line"><span class="built_in">strncmp</span>(Dest, Str2, v2);</span><br><span class="line"><span class="keyword">if</span> ( sub_411127() )</span><br><span class="line">   sub_41132F(<span class="string">"wrong flag!\n"</span>, v4);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   sub_41132F(<span class="string">"rigth flag!\n"</span>, v4);</span><br><span class="line">sub_41126C(&amp;savedregs, &amp;dword_415890);</span><br></pre></td></tr></table></figure>

<p>sub_41132F输出，sub_411375输入。输入str经过sub_4110BE变成v1，变成Dest，dest里循环加j，0&lt;j&lt;len(dest),比较str2。</p>
<p>找str2</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">push</span>    offset Str2     ; <span class="string">"e3nifIH9b_C@n@dH"</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">"e3nifIH9b_C@n@dH"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    flag+=chr(ord(a[i])-i )</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>结果：e2lfbDB2ZV95b3V9，错误。忘了还有sub_4110BE。sub_411AB0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( i == <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[(<span class="keyword">signed</span> <span class="keyword">int</span>)(<span class="keyword">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( v4 == <span class="number">2</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[(<span class="keyword">signed</span> <span class="keyword">int</span>)(<span class="keyword">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">2</span>] &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>) | <span class="number">4</span> * (byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( v4 == <span class="number">3</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[(<span class="keyword">signed</span> <span class="keyword">int</span>)(<span class="keyword">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">2</span>] &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>) | <span class="number">4</span> * (byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[byte_41A144[<span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span>     <span class="built_in">cl</span>, <span class="built_in">byte</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:aAbcdefghijklmn[<span class="built_in">edx</span>] <span class="comment">; "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm"...</span></span><br></pre></td></tr></table></figure>

<p>base64,emmmmmmmmm~~</p>
<h2 id="day3-5-7"><a href="#day3-5-7" class="headerlink" title="day3    5.7"></a>day3    5.7</h2><h3 id="不一样的flag"><a href="#不一样的flag" class="headerlink" title="不一样的flag"></a>不一样的flag</h3><p>看到提示我觉得不妙，会不会f5不能用了。</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/%25E4%25B8%258D%25E4%25B8%2580%25E6%25A0%25B7%25E7%259A%2584flag/Snipaste_2020-05-07_20-35-40.png" alt></p>
<p>搜索flag。</p>
<p>call    _puts应该是输出ptr，call    _printf</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"you can choose one action to execute"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"1 up"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"2 down"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"3 left"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"4 right\n:"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v3);</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v3 &gt; <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 == <span class="number">3</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        --v2;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 != <span class="number">4</span> )</span><br><span class="line">           LABEL_13:</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        ++v2;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">1</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      --v1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(&amp;v1 + i) &lt; <span class="number">0</span> || *(&amp;v1 + i) &gt; <span class="number">4</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v5 + <span class="number">5</span> * v1 + v2 - <span class="number">41</span>) == <span class="number">49</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v5 + <span class="number">5</span> * v1 + v2 - <span class="number">41</span>) == <span class="number">35</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"\nok, the order you enter is the flag!"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>v3=1,v1–;</p>
<p>v3=2,v1++;</p>
<p>v3=3,v2–;</p>
<p>v3=4,v2++;</p>
<p>v5+5*v1+v2-41=35(‘#’)!=49(‘1’)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> v0; <span class="comment">// [sp+17h] [bp-35h]@1</span></span><br><span class="line">qmemcpy(&amp;v0, _data_start__, <span class="number">0x19</span>u);</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov     ebx, offset __data_start__ ; <span class="string">"*11110100001010000101111#"</span></span><br></pre></td></tr></table></figure>

<p>想多了，这是一个迷宫</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*<span class="number">1111</span></span><br><span class="line"><span class="number">01000</span></span><br><span class="line"><span class="number">01010</span></span><br><span class="line"><span class="number">00010</span></span><br><span class="line"><span class="number">1111</span>#</span><br></pre></td></tr></table></figure>

<p>相当于二维数组，v1v2是坐标，1是可以走的，*头#尾。</p>
<h3 id="刮开有奖"><a href="#刮开有奖" class="headerlink" title="刮开有奖"></a>刮开有奖</h3><p>挂不了，生气。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">GetDlgItemTextA(hDlg, <span class="number">1000</span>, &amp;String, <span class="number">0xFFFF</span>);</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;String) == <span class="number">8</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 = <span class="number">90</span>;</span><br><span class="line">        v8 = <span class="number">74</span>;</span><br><span class="line">        v9 = <span class="number">83</span>;</span><br><span class="line">        v10 = <span class="number">69</span>;</span><br><span class="line">        v11 = <span class="number">67</span>;</span><br><span class="line">        v12 = <span class="number">97</span>;</span><br><span class="line">        v13 = <span class="number">78</span>;</span><br><span class="line">        v14 = <span class="number">72</span>;</span><br><span class="line">        v15 = <span class="number">51</span>;</span><br><span class="line">        v16 = <span class="number">110</span>;</span><br><span class="line">        v17 = <span class="number">103</span>;</span><br><span class="line">        sub_4010F0(&amp;v7, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">        <span class="built_in">memset</span>(&amp;v26, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">        v26 = v23;</span><br><span class="line">        v28 = v25;</span><br><span class="line">        v27 = v24;</span><br><span class="line">        v4 = (<span class="keyword">const</span> <span class="keyword">char</span> *)sub_401000(&amp;v26, <span class="built_in">strlen</span>(&amp;v26));</span><br><span class="line">        <span class="built_in">memset</span>(&amp;v26, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">        v27 = v21;</span><br><span class="line">        v26 = v20;</span><br><span class="line">        v28 = v22;</span><br><span class="line">        v5 = (<span class="keyword">const</span> <span class="keyword">char</span> *)sub_401000(&amp;v26, <span class="built_in">strlen</span>(&amp;v26));</span><br><span class="line">        <span class="keyword">if</span> ( String == v7 + <span class="number">34</span></span><br><span class="line">          &amp;&amp; v19 == v11</span><br><span class="line">          &amp;&amp; <span class="number">4</span> * v20 - <span class="number">141</span> == <span class="number">3</span> * v9</span><br><span class="line">          &amp;&amp; v21 / <span class="number">4</span> == <span class="number">2</span> * (v14 / <span class="number">9</span>)</span><br><span class="line">          &amp;&amp; !<span class="built_in">strcmp</span>(v4, <span class="string">"ak1w"</span>)</span><br><span class="line">          &amp;&amp; !<span class="built_in">strcmp</span>(v5, <span class="string">"V1Ax"</span>) )</span><br><span class="line">          MessageBoxA(hDlg, <span class="string">"U g3t 1T!"</span>, <span class="string">"@_@"</span>, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>看看sub_4010F0对v7-v17做了什么</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_4010F0</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// esi@1</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx@2</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// edx@2</span></span><br><span class="line"></span><br><span class="line">  result = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">4</span> * i;</span><br><span class="line">    v6 = *(_DWORD *)(<span class="number">4</span> * i + a1);</span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; *(_DWORD *)(a1 + <span class="number">4</span> * result) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          *(_DWORD *)(v5 + a1) = *(_DWORD *)(a1 + <span class="number">4</span> * result);</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( *(_DWORD *)(a1 + <span class="number">4</span> * i) &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            ++i;</span><br><span class="line">            <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = <span class="number">4</span> * i;</span><br><span class="line">          *(_DWORD *)(a1 + <span class="number">4</span> * result) = *(_DWORD *)(<span class="number">4</span> * i + a1);</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4</span> * result) = v6;</span><br><span class="line">    sub_4010F0(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = a3;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">char</span> *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// esi@1</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx@2</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// edx@2</span></span><br><span class="line"></span><br><span class="line">  result = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">4</span> * i;</span><br><span class="line">    v6 = a1[<span class="number">4</span> * i];</span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; a1[<span class="number">4</span> * result] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          a1[v5] = a1[<span class="number">4</span> * result];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( a1[<span class="number">4</span> * i] &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            ++i;</span><br><span class="line">            <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = <span class="number">4</span> * i;</span><br><span class="line">          a1 [<span class="number">4</span> * result] = a1[<span class="number">4</span> * i];</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;<span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    a1 [<span class="number">4</span> * result] = v6;</span><br><span class="line">    sub(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = a3;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> a1[<span class="number">11</span>]=&#123;<span class="number">90</span>,<span class="number">74</span>,<span class="number">83</span>,<span class="number">69</span>,<span class="number">67</span>,<span class="number">97</span>,<span class="number">78</span>,<span class="number">72</span>,<span class="number">51</span>,<span class="number">110</span>,<span class="number">103</span>&#125;;</span><br><span class="line">    sub(a1,<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;a1[i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JSE aNH ng</p>
<p>淦，我的汇编就是一坨屎</p>
<p>去掉4*。</p>
<blockquote>
<p>  淦，我的保存没了。</p>
</blockquote>
<p>string是flag，其中(v4, “ak1w”)(v5, “V1Ax”)是base64结果。</p>
<p>string = “UJWP1jMp”</p>
<h2 id="day4-5-8"><a href="#day4-5-8" class="headerlink" title="day4    5.8"></a>day4    5.8</h2><h3 id="simpleRev"><a href="#simpleRev" class="headerlink" title="simpleRev"></a>simpleRev</h3><p>64位。</p>
<p>48-57:0-9</p>
<p>65-90：A-Z</p>
<p>97-122：a-z</p>
<p>Decry()里</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int64 <span class="title">Decry</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// [sp+Fh] [bp-51h]@19</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [sp+10h] [bp-50h]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v3; <span class="comment">// [sp+14h] [bp-4Ch]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [sp+18h] [bp-48h]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v5; <span class="comment">// [sp+1Ch] [bp-44h]@1</span></span><br><span class="line">  <span class="keyword">char</span> src[<span class="number">8</span>]; <span class="comment">// [sp+20h] [bp-40h]@1</span></span><br><span class="line">  __int64 v7; <span class="comment">// [sp+28h] [bp-38h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [sp+30h] [bp-30h]@1</span></span><br><span class="line">  __int64 v9; <span class="comment">// [sp+40h] [bp-20h]@1</span></span><br><span class="line">  __int64 v10; <span class="comment">// [sp+48h] [bp-18h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [sp+50h] [bp-10h]@1</span></span><br><span class="line">  __int64 v12; <span class="comment">// [sp+58h] [bp-8h]@1</span></span><br><span class="line"></span><br><span class="line">  v12 = *MK_FP(__FS__, <span class="number">40L</span>L);</span><br><span class="line">  *(_QWORD *)src = <span class="number">357761762382L</span>L;</span><br><span class="line">  v7 = <span class="number">0L</span>L;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">512969957736L</span>L;</span><br><span class="line">  v10 = <span class="number">0L</span>L;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  text = join(key3, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v9);</span><br><span class="line">  <span class="built_in">strcpy</span>(key, key1);</span><br><span class="line">  <span class="built_in">strcat</span>(key, src);</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  getchar();</span><br><span class="line">  v5 = <span class="built_in">strlen</span>(key);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( key[v3 % v5] &gt; <span class="number">64</span> &amp;&amp; key[v3 % v5] &lt;= <span class="number">90</span> )</span><br><span class="line">      key[i] = key[v3 % v5] + <span class="number">32</span>;</span><br><span class="line">    ++v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please input your flag:"</span>, src);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = getchar();</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">32</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v1 &lt;= <span class="number">96</span> || v1 &gt; <span class="number">122</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v1 &gt; <span class="number">64</span> &amp;&amp; v1 &lt;= <span class="number">90</span> )</span><br><span class="line">          str2[v2] = (v1 - <span class="number">39</span> - key[v3++ % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        str2[v2] = (v1 - <span class="number">39</span> - key[v3++ % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !(v3 % v5) )</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(text, str2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Congratulation!\n"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Try again!\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> *MK_FP(__FS__, <span class="number">40L</span>L) ^ v12;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> *__<span class="function">fastcall <span class="title">join</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1, <span class="keyword">const</span> <span class="keyword">char</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v2; <span class="comment">// rbx@1</span></span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rax@1</span></span><br><span class="line">  <span class="keyword">char</span> *dest; <span class="comment">// [sp+18h] [bp-18h]@1</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(a2);</span><br><span class="line">  dest = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(v2 + v3 + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !dest )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, a1);</span><br><span class="line">  <span class="built_in">strcat</span>(dest, a2);</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>join就是字符串相连</p>
<p>主要变量：</p>
<p>v9 = 512969957736LL;==hadow</p>
<p>*(_QWORD *)src = 357761762382LL;==NDCLS</p>
<blockquote>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">&gt;      <span class="keyword">long</span> <span class="keyword">long</span> a = <span class="number">512969957736L</span>L;</span><br><span class="line">&gt;      <span class="keyword">char</span> buffer[<span class="number">100</span>];</span><br><span class="line">&gt;      <span class="built_in">sprintf</span>(buffer, <span class="string">"%lld"</span>, a);</span><br><span class="line">&gt;      <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, buffer);</span><br><span class="line">&gt;      <span class="keyword">const</span> <span class="keyword">char</span> *b=(<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;a;</span><br><span class="line">&gt;      <span class="built_in">cout</span>&lt;&lt;b;</span><br><span class="line">&gt;      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt;   </span><br><span class="line">&gt;   </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>text = join(key3, (const char *)&amp;v9);</p>
<p>key3       ; “kills”</p>
<p>key1       ; “ADSFK”</p>
<p>过程：</p>
<p>key=key1+src </p>
<p>//text=killshadow，key=ADSFKNDCLS</p>
<p>key变小写</p>
<p>//keyt=adsfkndcls</p>
<p>str2变换</p>
<p>最后str2=test</p>
<p>str2[v3] = (v2 - 39 - key[v4++ % v6] + 97) % 26 + 97;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">key=<span class="string">"adsfkndcls"</span></span><br><span class="line">text=<span class="string">"killshadow"</span></span><br><span class="line">str2=<span class="string">""</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">print(len(key))</span><br><span class="line">v4 = <span class="number">9</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">65</span>,<span class="number">91</span>):</span><br><span class="line">        zm = chr((j - <span class="number">39</span> - ord(key[(v4+<span class="number">1</span>) % <span class="number">10</span>]) + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">        <span class="keyword">if</span> zm==text[i]:</span><br><span class="line">            flag+=chr(j)</span><br><span class="line">            v4=v4+<span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h3 id="java逆向解密"><a href="#java逆向解密" class="headerlink" title="java逆向解密"></a>java逆向解密</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> defpackage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: Reverse  reason: default package */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Reverse</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.println(<span class="string">"Please input the flag ："</span>);</span><br><span class="line">        String str = s.next();</span><br><span class="line">        System.out.println(<span class="string">"Your input is ："</span>);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">        Encrypt(str.toCharArray());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Encrypt</span><span class="params">(<span class="keyword">char</span>[] arr)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;Integer&gt; Resultlist = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : arr) &#123;</span><br><span class="line">            Resultlist.add(Integer.valueOf((c + <span class="string">'@'</span>) ^ <span class="number">32</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] KEY = &#123;<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>&#125;;</span><br><span class="line">        ArrayList&lt;Integer&gt; KEYList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> valueOf : KEY) &#123;</span><br><span class="line">            KEYList.add(Integer.valueOf(valueOf));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"Result:"</span>);</span><br><span class="line">        <span class="keyword">if</span> (Resultlist.equals(KEYList)) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Congratulations！"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.err.println(<span class="string">"Error！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(flag+@)^32==key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">KEY = [<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>]</span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(KEY)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> (j+ord(<span class="string">'@'</span>))^<span class="number">32</span>==KEY[i]:</span><br><span class="line">            flag+=chr(j)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>芜湖！！！</p>
<h3 id="findit"><a href="#findit" class="headerlink" title="findit"></a>findit</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">ActionBarActivity</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* access modifiers changed from: protected */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView((<span class="keyword">int</span>) R.layout.activity_main);</span><br><span class="line">        <span class="keyword">final</span> EditText edit = (EditText) findViewById(R.id.widget2);</span><br><span class="line">        <span class="keyword">final</span> TextView text = (TextView) findViewById(R.id.widget1);</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">char</span>[] a = &#123;<span class="string">'T'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'s'</span>, <span class="string">'I'</span>, <span class="string">'s'</span>, <span class="string">'T'</span>, <span class="string">'h'</span>, <span class="string">'e'</span>, <span class="string">'F'</span>, <span class="string">'l'</span>, <span class="string">'a'</span>, <span class="string">'g'</span>, <span class="string">'H'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>, <span class="string">'e'</span>&#125;;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">char</span>[] b = &#123;<span class="string">'p'</span>, <span class="string">'v'</span>, <span class="string">'k'</span>, <span class="string">'q'</span>, <span class="string">'&#123;'</span>, <span class="string">'m'</span>, <span class="string">'1'</span>, <span class="string">'6'</span>, <span class="string">'4'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'2'</span>, <span class="string">'6'</span>, <span class="string">'2'</span>, <span class="string">'0'</span>, <span class="string">'3'</span>, <span class="string">'3'</span>, <span class="string">'l'</span>, <span class="string">'4'</span>, <span class="string">'m'</span>, <span class="string">'4'</span>, <span class="string">'9'</span>, <span class="string">'l'</span>, <span class="string">'n'</span>, <span class="string">'p'</span>, <span class="string">'7'</span>, <span class="string">'p'</span>, <span class="string">'9'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'k'</span>, <span class="string">'2'</span>, <span class="string">'8'</span>, <span class="string">'k'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'&#125;'</span>&#125;;</span><br><span class="line">        ((Button) findViewById(R.id.widget3)).setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">char</span>[] x = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">17</span>];</span><br><span class="line">                <span class="keyword">char</span>[] y = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">38</span>];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((a[i] &lt; <span class="string">'I'</span> &amp;&amp; a[i] &gt;= <span class="string">'A'</span>) || (a[i] &lt; <span class="string">'i'</span> &amp;&amp; a[i] &gt;= <span class="string">'a'</span>)) &#123;</span><br><span class="line">                        x[i] = (<span class="keyword">char</span>) (a[i] + <span class="number">18</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((a[i] &lt; <span class="string">'A'</span> || a[i] &gt; <span class="string">'Z'</span>) &amp;&amp; (a[i] &lt; <span class="string">'a'</span> || a[i] &gt; <span class="string">'z'</span>)) &#123;</span><br><span class="line">                        x[i] = a[i];</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        x[i] = (<span class="keyword">char</span>) (a[i] - <span class="number">8</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (String.valueOf(x).equals(edit.getText().toString())) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i2 = <span class="number">0</span>; i2 &lt; <span class="number">38</span>; i2++) &#123;</span><br><span class="line">                        <span class="keyword">if</span> ((b[i2] &lt; <span class="string">'A'</span> || b[i2] &gt; <span class="string">'Z'</span>) &amp;&amp; (b[i2] &lt; <span class="string">'a'</span> || b[i2] &gt; <span class="string">'z'</span>)) &#123;</span><br><span class="line">                            y[i2] = b[i2];</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            y[i2] = (<span class="keyword">char</span>) (b[i2] + <span class="number">16</span>);</span><br><span class="line">                            <span class="keyword">if</span> ((y[i2] &gt; <span class="string">'Z'</span> &amp;&amp; y[i2] &lt; <span class="string">'a'</span>) || y[i2] &gt;= <span class="string">'z'</span>) &#123;</span><br><span class="line">                                y[i2] = (<span class="keyword">char</span>) (y[i2] - <span class="number">26</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    text.setText(String.valueOf(y));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                text.setText(<span class="string">"答案错了肿么办。。。不给你又不好意思。。。哎呀好纠结啊~~~"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (item.getItemId() == R.id.action_settings) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b变y，y是flag</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i2 = <span class="number">0</span>; i2 &lt; <span class="number">38</span>; i2++) &#123;</span><br><span class="line">	<span class="keyword">if</span> ((b[i2] &lt; <span class="string">'A'</span> || b[i2] &gt; <span class="string">'Z'</span>) &amp;&amp; (b[i2] &lt; <span class="string">'a'</span> || b[i2] &gt; <span class="string">'z'</span>)) &#123;</span><br><span class="line">		y[i2] = b[i2];</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		y[i2] = (<span class="keyword">char</span>) (b[i2] + <span class="number">16</span>);</span><br><span class="line">		<span class="keyword">if</span> ((y[i2] &gt; <span class="string">'Z'</span> &amp;&amp; y[i2] &lt; <span class="string">'a'</span>) || y[i2] &gt;= <span class="string">'z'</span>) &#123;</span><br><span class="line">			y[i2] = (<span class="keyword">char</span>) (y[i2] - <span class="number">26</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>凯撒，16位。我不管，爆破</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/findit/Snipaste_2020-05-08_20-38-41.png" alt></p>
<p>pvkq{m164675262033l4m49lnp7p9mnk28k75}</p>
<h3 id="8086"><a href="#8086" class="headerlink" title="8086"></a>8086</h3><p>迷~~</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db <span class="number">0</span>B9h, <span class="number">22</span>h, <span class="number">0</span>, <span class="number">8</span>Dh, <span class="number">1</span>Eh, <span class="number">2</span> dup(<span class="number">0</span>), <span class="number">8</span>Bh, <span class="number">0</span>F9h, <span class="number">4</span>Fh, <span class="number">80</span>h</span><br><span class="line">db <span class="number">31</span>h, <span class="number">1</span>Fh, <span class="number">0E2</span>h, <span class="number">0</span>F8h, <span class="number">8</span>Dh, <span class="number">16</span>h, <span class="number">2</span> dup(<span class="number">0</span>), <span class="number">0</span>B4h, <span class="number">9</span>, <span class="number">0</span>CDh</span><br><span class="line">db <span class="number">21</span>h, <span class="number">0</span>C3h</span><br></pre></td></tr></table></figure>

<p>c强制转换代码</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span>     <span class="built_in">cx</span>, <span class="number">22h</span> <span class="comment">; '"'</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">bx</span>, aUDuT@Z@wj__Q@g <span class="comment">; "]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~/b;"</span></span><br><span class="line"><span class="symbol">loc_10039:</span>                              <span class="comment">; CODE XREF: seg001:000Fj</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">di</span>, <span class="built_in">cx</span></span><br><span class="line"><span class="keyword">dec</span>     <span class="built_in">di</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">bx</span>+<span class="built_in">di</span>], <span class="number">1Fh</span></span><br><span class="line"><span class="keyword">loop</span>    loc_10039</span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">dx</span>, aUDuT@Z@wj__Q@g <span class="comment">; "]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~/b;"</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">9</span></span><br><span class="line"><span class="keyword">int</span>     <span class="number">21h</span>             <span class="comment">; DOS - PRINT STRING; DS:DX -&gt; string terminated by "$"</span></span><br><span class="line"><span class="keyword">retn</span></span><br></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">xor</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">bx</span>+<span class="built_in">di</span>], <span class="number">1Fh</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">"]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~/b;"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line">b=<span class="number">0x1f</span></span><br><span class="line">print(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    flag+=chr(ord(a[i])^b)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><p>public key：MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMAzLFxkrkcYL2wch21CM2kQVFpY9+7+./AvKr1rzQczdAgMBAAE=</p>
<p><a href="http://tool.chacuo.net/cryptrsakeyparse" target="_blank" rel="noopener">http://tool.chacuo.net/cryptrsakeyparse</a></p>
<table>
<thead>
<tr>
<th>key长度：</th>
<th>256</th>
</tr>
</thead>
<tbody><tr>
<td>模数：</td>
<td>C0332C5C64AE47182F6C1C876D42336910545A58F7EEFEFC0BCAAF5AF341CCDD</td>
</tr>
<tr>
<td>指数：</td>
<td>65537 (0x10001)</td>
</tr>
</tbody></table>
<p>86934482296048119190666062003494800588905656017203025617216654058378322103517</p>
<p>p=285960468890451637935629440372639283459</p>
<p>q=304008741604601924494328155975272418463</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -pubin -text -modulus -<span class="keyword">in</span> pub.txt</span><br><span class="line">python2 rsatool<span class="selector-class">.py</span> -o private<span class="selector-class">.pem</span> -e <span class="number">65537</span> -<span class="selector-tag">p</span> <span class="number">285960468890451637935629440372639283459</span> -<span class="selector-tag">q</span> <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> flag<span class="selector-class">.enc</span> -inkey private.pem</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">arsa=RSA.generate(<span class="number">1024</span>)</span><br><span class="line">arsa.p=</span><br><span class="line">arsa.q=</span><br><span class="line">arsa.e=</span><br><span class="line">arsa.n=arsa.p*arsa.q</span><br><span class="line">Fn=long((arsa.p<span class="number">-1</span>)*(arsa.q<span class="number">-1</span>))</span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    x=(Fn*i)+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(x%arsa.e==<span class="number">0</span>):</span><br><span class="line">           arsa.d=x/arsa.e</span><br><span class="line">           <span class="keyword">break</span></span><br><span class="line">    i=i+<span class="number">1</span></span><br><span class="line">private=open(<span class="string">'private.pem'</span>,<span class="string">'w'</span>)</span><br><span class="line">private.write(arsa.exportKey())</span><br><span class="line">private.close()</span><br></pre></td></tr></table></figure>

<h2 id="day5-5-9"><a href="#day5-5-9" class="headerlink" title="day5    5.9"></a>day5    5.9</h2><h3 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h3><p>32位</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"pls input the first passwd(1): "</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;pbData);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pbData) != <span class="number">6</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Must be 6 characters!\n"</span>);</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>pw6位</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v<span class="number">5</span> = u<span class="symbol">nknown_libname_1</span><span class="comment">((char *)</span>&amp;pbData);</span><br><span class="line">  <span class="keyword">if</span> <span class="comment">( v5 &lt; 100000 )</span></span><br><span class="line">    ExitProcess<span class="comment">(0)</span>;</span><br><span class="line">  strcat<span class="comment">((char *)</span>&amp;pbData, <span class="string">"@DBApp"</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__int32 __cdecl unknown_libname_1(<span class="keyword">char</span> *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">return</span> <span class="title">atol</span><span class="params">(a1)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>pw&gt;100000</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcat</span>((<span class="keyword">char</span> *)&amp;pbData, <span class="string">"@DBApp"</span>);</span><br><span class="line">v0 = <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pbData);</span><br></pre></td></tr></table></figure>

<p>pbData=pw+”@DBApp”</p>
<p>v0=12</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_40100A(&amp;pbData, v0, &amp;String1);</span><br></pre></td></tr></table></figure>

<p>好像hash</p>
<p>去搜CryptCreateHash</p>
<p><a href="#https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptcreatehash">CryptCreateHash:ALG_ID</a></p>
<p>sha1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">data=<span class="string">"@DBApp"</span></span><br><span class="line">a=<span class="string">"6E32D0943418C2C33385BC35A1470250DD8923A9"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>,<span class="number">1000000</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    flag=str(i)+data</span><br><span class="line">    sha1 = (hashlib.sha1(flag).hexdigest()).upper()</span><br><span class="line">    <span class="keyword">if</span> sha1==a:</span><br><span class="line">        print(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>跑了好久。。。。</p>
<p>pw=123321@DBApp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !_strcmpi(&amp;String1, <span class="string">"6E32D0943418C2C33385BC35A1470250DD8923A9"</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"continue...\n\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"pls input the first passwd(2): "</span>);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;String, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;String);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;String) != <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Must be 6 characters!\n"</span>);</span><br><span class="line">      ExitProcess(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">strcat</span>(&amp;String, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pbData);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;String1, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">    v1 = <span class="built_in">strlen</span>(&amp;String);</span><br><span class="line">    sub_401019((BYTE *)&amp;String, v1, &amp;String1);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">"27019e688a4e62a649fd99cadaafdb4e"</span>, &amp;String1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> __int8)sub_40100F(&amp;String) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Error!!\n"</span>);</span><br><span class="line">        ExitProcess(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"bye ~~\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcat</span>(&amp;String, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pbData);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;String1, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">    v1 = <span class="built_in">strlen</span>(&amp;String);</span><br><span class="line">    sub_401019((BYTE *)&amp;String, v1, &amp;String1);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">"27019e688a4e62a649fd99cadaafdb4e"</span>, &amp;String1) )</span><br></pre></td></tr></table></figure>

<p>string=pw2+”123321@DBApp”</p>
<p>CryptCreateHash里0x8003u是MD5，查不到。</p>
<p>会不会还是数字，爆破数字。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">data=<span class="string">"123321@DBApp"</span></span><br><span class="line">a=<span class="string">"27019e688a4e62a649fd99cadaafdb4e"</span></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>,<span class="number">1000000</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    flag=str(i)+data</span><br><span class="line">    md5.update(flag)</span><br><span class="line">    <span class="keyword">if</span> md5==a:</span><br><span class="line">        print(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>无</p>
<p>看后面吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hResInfo = FindResourceA(<span class="number">0</span>, (LPCSTR)<span class="number">0x65</span>, <span class="string">"AAA"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( hResInfo )</span><br><span class="line">  &#123;</span><br><span class="line">    nNumberOfBytesToWrite = SizeofResource(<span class="number">0</span>, hResInfo);</span><br><span class="line">    hResData = LoadResource(<span class="number">0</span>, hResInfo);</span><br><span class="line">    <span class="keyword">if</span> ( hResData )</span><br><span class="line">    &#123;</span><br><span class="line">      lpBuffer = LockResource(hResData);</span><br><span class="line">      sub_401005(lpString, (<span class="keyword">int</span>)lpBuffer, nNumberOfBytesToWrite);</span><br><span class="line">      hFile = CreateFileA(<span class="string">"dbapp.rtf"</span>, <span class="number">0x10000000</span>u, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2u</span>, <span class="number">0x80</span>u, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>到这里，</p>
<p>sub_401019((BYTE *)&amp;String, v1, &amp;String1);</p>
<p>函数sub_401040(BYTE *pbData, DWORD dwDataLen, LPSTR lpString1)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(&amp;v4, <span class="number">0xCC</span>u, <span class="number">0x4C</span>u);</span><br><span class="line"> v7 = lstrlenA(lpString);</span><br><span class="line"> v6 = lpString;</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   result = i;</span><br><span class="line">   <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">   *(_BYTE *)(i + a2) ^= v6[i % v7];</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>发现lpString进行了异或，a2为lpString首地址。</p>
<p>AAA是啥？我受不了了了，看wp。</p>
<p>{\rtf1\ansi\</p>
<p>。。。。。。。。。。。就这样吧，累了</p>
<h2 id="day6-5-10"><a href="#day6-5-10" class="headerlink" title="day6    5.10"></a>day6    5.10</h2><h3 id="注册器"><a href="#注册器" class="headerlink" title="注册器"></a>注册器</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">char[] x = <span class="string">"dd2940c04462b4dd7c450528835cca15"</span>.toCharArray();</span><br><span class="line">                    x[<span class="number">2</span>] = (char) ((x[<span class="number">2</span>] + x[<span class="number">3</span>]) - <span class="number">50</span>);</span><br><span class="line">                    x[<span class="number">4</span>] = (char) ((x[<span class="number">2</span>] + x[<span class="number">5</span>]) - <span class="number">48</span>);</span><br><span class="line">                    x[<span class="number">30</span>] = (char) ((x[<span class="number">31</span>] + x[<span class="number">9</span>]) - <span class="number">48</span>);</span><br><span class="line">                    x[<span class="number">14</span>] = (char) ((x[<span class="number">27</span>] + x[<span class="number">28</span>]) - <span class="number">97</span>);</span><br><span class="line">                    for (int i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">                        char a = x[<span class="number">31</span> - i];</span><br><span class="line">                        x[<span class="number">31</span> - i] = x[i];</span><br><span class="line">                        x[i] = a;</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="string">"dd2940c04462b4dd7c450528835cca15"</span></span><br><span class="line">b=list(x)</span><br><span class="line">print(b)</span><br><span class="line">b[<span class="number">2</span>] = chr((ord(b[<span class="number">2</span>]) + ord(b[<span class="number">3</span>])) - <span class="number">50</span>)</span><br><span class="line">b[<span class="number">4</span>] = chr((ord(b[<span class="number">2</span>]) + ord(b[<span class="number">5</span>])) - <span class="number">48</span>)</span><br><span class="line">b[<span class="number">30</span>] = chr((ord(b[<span class="number">31</span>]) + ord(b[<span class="number">9</span>])) - <span class="number">48</span>)</span><br><span class="line">b[<span class="number">14</span>] = chr((ord(b[<span class="number">27</span>]) + ord(b[<span class="number">28</span>])) - <span class="number">97</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        a = b[<span class="number">31</span> - i];</span><br><span class="line">        b[<span class="number">31</span> - i] = b[i];</span><br><span class="line">        b[i] = a;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">''</span>.join(b))</span><br></pre></td></tr></table></figure>

<h3 id="luck-guy"><a href="#luck-guy" class="headerlink" title="luck_guy"></a>luck_guy</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">patch_me</span><span class="params">(<span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@2</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( ((((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">unsigned</span> __int64)a1 &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">31</span>) + (_BYTE)a1) &amp; <span class="number">1</span>)</span><br><span class="line">     - ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">unsigned</span> __int64)a1 &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">31</span>) == <span class="number">1</span> )</span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">"just finished"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = get_flag();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>a1最后一位为0</p>
<p>flag=f1+f2</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400845</span> loc_400845:                             <span class="comment">; DATA XREF: .rodata:0000000000400BC8o</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400845</span>                 <span class="keyword">mov</span>     <span class="built_in">edi</span>, offset aOkItSFlag <span class="comment">; "OK, it's flag:"</span></span><br><span class="line"><span class="symbol">.text:</span>000000000040084A                 <span class="keyword">call</span>    _puts</span><br><span class="line"><span class="symbol">.text:</span>000000000040084F                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400853</span>                 <span class="keyword">mov</span>     <span class="built_in">edx</span>, <span class="number">28h</span>        <span class="comment">; n</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400858</span>                 <span class="keyword">mov</span>     <span class="built_in">esi</span>, <span class="number">0</span>          <span class="comment">; c</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">000000000040085D</span>                 <span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span>        <span class="comment">; s</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400860</span>                 <span class="keyword">call</span>    _memset</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400865</span>                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400869</span>                 <span class="keyword">mov</span>     <span class="built_in">esi</span>, offset f1  <span class="comment">; "GXY&#123;do_not_"</span></span><br><span class="line"><span class="symbol">.text:</span>000000000040086E                 <span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span>        <span class="comment">; dest</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400871</span>                 <span class="keyword">call</span>    _strcat</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400876</span>                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span>000000000040087A                 <span class="keyword">mov</span>     <span class="built_in">esi</span>, offset f2  <span class="comment">; src</span></span><br><span class="line"><span class="symbol">.text:</span>000000000040087F                 <span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span>        <span class="comment">; dest</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400882</span>                 <span class="keyword">call</span>    _strcat</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400887</span>                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span>000000000040088B                 <span class="keyword">mov</span>     <span class="built_in">rsi</span>, <span class="built_in">rax</span></span><br><span class="line"><span class="symbol">.text:</span>000000000040088E                 <span class="keyword">mov</span>     <span class="built_in">edi</span>, offset format <span class="comment">; "%s"</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400893</span>                 <span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="number">0</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400898</span>                 <span class="keyword">call</span>    _printf</span><br><span class="line"><span class="symbol">.text:</span><span class="number">000000000040089D</span>                 <span class="keyword">jmp</span>     loc_400975</span><br></pre></td></tr></table></figure>

<p>f2=i c u g ` o f </p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text:</span>00000000004008CA loc_4008CA:                             <span class="comment">; DATA XREF: .rodata:0000000000400BE0o</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008CA                 <span class="keyword">mov</span>     [<span class="built_in">rbp</span>+s], <span class="number">0</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008D2                 <span class="keyword">mov</span>     [<span class="built_in">rbp</span>+var_28], <span class="number">0</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008D6                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s], <span class="number">69h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008DA                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">1</span>], <span class="number">63h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008DE                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">2</span>], <span class="number">75h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008E2                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">3</span>], <span class="number">67h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008E6                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">4</span>], <span class="number">60h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008EA                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">5</span>], <span class="number">6Fh</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008EE                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">6</span>], <span class="number">66h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008F2                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">7</span>], <span class="number">7Fh</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008F6                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span>00000000004008FA                 <span class="keyword">mov</span>     <span class="built_in">rsi</span>, <span class="built_in">rax</span>        <span class="comment">; src</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008FD                 <span class="keyword">mov</span>     <span class="built_in">edi</span>, offset f2  <span class="comment">; dest</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400902</span>                 <span class="keyword">call</span>    _strcat</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400907</span>                 <span class="keyword">jmp</span>     short loc_400975</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400963</span> <span class="selector-tag">loc_400963</span>:                             ; <span class="selector-tag">CODE</span> <span class="selector-tag">XREF</span>: <span class="selector-tag">get_flag</span>+145<span class="selector-tag">j</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400963</span>                 <span class="selector-tag">cmp</span>     <span class="selector-attr">[rbp+var_38]</span>, 7</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400967</span>                 <span class="selector-tag">jle</span>     <span class="selector-tag">short</span> <span class="selector-tag">loc_400912</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400969</span>                 <span class="selector-tag">jmp</span>     <span class="selector-tag">short</span> <span class="selector-tag">loc_400975</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400912</span> <span class="selector-tag">loc_400912</span>:                             ; <span class="selector-tag">CODE</span> <span class="selector-tag">XREF</span>: <span class="selector-tag">get_flag</span>+19<span class="selector-tag">C</span><span class="selector-tag">j</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400912</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">eax</span>, <span class="selector-attr">[rbp+var_38]</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400915</span>                 <span class="selector-tag">cdq</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400916</span>                 <span class="selector-tag">shr</span>     <span class="selector-tag">edx</span>, 1<span class="selector-tag">Fh</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400919</span>                 <span class="selector-tag">add</span>     <span class="selector-tag">eax</span>, <span class="selector-tag">edx</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:000000000040091B</span>                 <span class="selector-tag">and</span>     <span class="selector-tag">eax</span>, 1</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:000000000040091E</span>                 <span class="selector-tag">sub</span>     <span class="selector-tag">eax</span>, <span class="selector-tag">edx</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400920</span>                 <span class="selector-tag">cmp</span>     <span class="selector-tag">eax</span>, 1</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400923</span>                 <span class="selector-tag">jnz</span>     <span class="selector-tag">short</span> <span class="selector-tag">loc_400943</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400925</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">eax</span>, <span class="selector-attr">[rbp+var_38]</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400928</span>                 <span class="selector-tag">cdqe</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:000000000040092A</span>                 <span class="selector-tag">movzx</span>   <span class="selector-tag">eax</span>, <span class="selector-tag">ds</span><span class="selector-pseudo">:f2</span><span class="selector-attr">[rax]</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400931</span>                 <span class="selector-tag">sub</span>     <span class="selector-tag">eax</span>, 2</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400934</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">edx</span>, <span class="selector-tag">eax</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400936</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">eax</span>, <span class="selector-attr">[rbp+var_38]</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400939</span>                 <span class="selector-tag">cdqe</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:000000000040093B</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">ds</span><span class="selector-pseudo">:f2</span><span class="selector-attr">[rax]</span>, <span class="selector-tag">dl</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400941</span>                 <span class="selector-tag">jmp</span>     <span class="selector-tag">short</span> <span class="selector-tag">loc_40095F</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>  CDQ 是一个让很多人感到困惑的指令。  这个指令把 EAX 的第 31 bit 复制到 EDX 的每一个 bit 上。 它大多出现在除法运算之前。它实际的作用只是把EDX的所有位都设成EAX最高位的值。也就是说，当EAX &lt;80000000, EDX 为00000000；当EAX &gt;= 80000000， EDX 则为FFFFFFFF。</p>
</blockquote>
<p>我的f5和wp不一样，只能看汇编。头疼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">f2=[<span class="number">0x69</span>,<span class="number">0x63</span>,<span class="number">0x75</span>,<span class="number">0x67</span>,<span class="number">0x60</span>,<span class="number">0x6f</span>,<span class="number">0x66</span>,<span class="number">0x7f</span>]</span><br><span class="line">flag = <span class="string">'GXY&#123;do_not_'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> ( j % <span class="number">2</span> == <span class="number">1</span> ):</span><br><span class="line">        flag+= chr(f2[j] - <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+= chr(f2[j] <span class="number">-1</span>)</span><br><span class="line">    </span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h3 id="younger-drive"><a href="#younger-drive" class="headerlink" title="younger_drive"></a>younger_drive</h3><p>脱壳，32位。</p>
<p>v0是printf返回值，为1008</p>
<p>sub_41116D(&amp;v5 == &amp;v5, v0);</p>
<p>没看出什么</p>
<p>v1=12</p>
<p>v2=flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __usercall sub_411E30@&lt;eax&gt;(<span class="keyword">char</span> a1@&lt;zf&gt;, <span class="keyword">int</span> result@&lt;eax&gt;)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// ST18_4@2</span></span><br><span class="line">  <span class="keyword">int</span> _0; <span class="comment">// [sp+0h] [bp+0h]@2</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = result;</span><br><span class="line">    sub_4111F9(_0, <span class="number">0</span>);</span><br><span class="line">    result = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/ajiannet/archive/2007/04/20/721679.html" target="_blank" rel="noopener">堆栈平衡看看</a></p>
<h2 id="day7-5-11"><a href="#day7-5-11" class="headerlink" title="day7    5.11"></a>day7    5.11</h2><h3 id="pyre"><a href="#pyre" class="headerlink" title="pyre"></a>pyre</h3><blockquote>
<p>  pyc文件是python编译后的字节码文件。<br>  在python中，输入一个模块相对来说是一个比较费时的事情，所以Python做了一些技巧，以便使输入模块更加快一些。一种方法是创建字节编译的文件，这些文件以.pyc作为扩展名。<br>  当你在下次从别的程序输入这个模块的时候，.pyc文件是十分有用的——它会快得多，因为一部分输入模块所需的处理已经完成了。<br>  在你import别的py文件时(也就是模块)，那个py文件会被存一份pyc文件以加速下次装载。而主文件因为只需要装载一次就没有存pyc。</p>
</blockquote>
<p><img src="//yoursite.com/2020/05/12/re的刷题/../../../%25E7%259E%258C%25E7%259D%25A1%25E8%2599%25AB-%25E5%25AE%2589%25E5%2585%25A8/%25E9%25A2%2598%25E7%259B%25AE/re/pyre/Snipaste_2020-05-11_17-10-58.png" alt></p>
<p><a href="https://tool.lu/pyc/" target="_blank" rel="noopener">https://tool.lu/pyc/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">'Welcome to Re World!'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Your input1 is your flag~'</span></span><br><span class="line">l = len(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> code</span><br><span class="line">code = [</span><br><span class="line">    <span class="string">'\x1f'</span>,</span><br><span class="line">    <span class="string">'\x12'</span>,</span><br><span class="line">    <span class="string">'\x1d'</span>,</span><br><span class="line">    <span class="string">'('</span>,</span><br><span class="line">    <span class="string">'0'</span>,</span><br><span class="line">    <span class="string">'4'</span>,</span><br><span class="line">    <span class="string">'\x01'</span>,</span><br><span class="line">    <span class="string">'\x06'</span>,</span><br><span class="line">    <span class="string">'\x14'</span>,</span><br><span class="line">    <span class="string">'4'</span>,</span><br><span class="line">    <span class="string">','</span>,</span><br><span class="line">    <span class="string">'\x1b'</span>,</span><br><span class="line">    <span class="string">'U'</span>,</span><br><span class="line">    <span class="string">'?'</span>,</span><br><span class="line">    <span class="string">'o'</span>,</span><br><span class="line">    <span class="string">'6'</span>,</span><br><span class="line">    <span class="string">'*'</span>,</span><br><span class="line">    <span class="string">':'</span>,</span><br><span class="line">    <span class="string">'\x01'</span>,</span><br><span class="line">    <span class="string">'D'</span>,</span><br><span class="line">    <span class="string">';'</span>,</span><br><span class="line">    <span class="string">'%'</span>,</span><br><span class="line">    <span class="string">'\x13'</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">input1=<span class="string">''</span></span><br><span class="line">code = [<span class="string">'\x1f'</span>, <span class="string">'\x12'</span>, <span class="string">'\x1d'</span>, <span class="string">'('</span>, <span class="string">'0'</span>, <span class="string">'4'</span>, <span class="string">'\x01'</span>, <span class="string">'\x06'</span>, <span class="string">'\x14'</span>, <span class="string">'4'</span>, <span class="string">','</span>, <span class="string">'\x1b'</span>, <span class="string">'U'</span>, <span class="string">'?'</span>, <span class="string">'o'</span>, <span class="string">'6'</span>, <span class="string">'*'</span>, <span class="string">':'</span>, <span class="string">'\x01'</span>, <span class="string">'D'</span>, <span class="string">';'</span>, <span class="string">'%'</span>, <span class="string">'\x13'</span>]</span><br><span class="line">I=len(code)</span><br><span class="line">print(ord(code[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(I<span class="number">-2</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">    code[i]=chr(ord(code[i])^ord(code[i+<span class="number">1</span>]))</span><br><span class="line">print(code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(I):</span><br><span class="line">    input1+=chr( (ord(code[i])-i)%<span class="number">128</span> )</span><br><span class="line">print(input1)</span><br></pre></td></tr></table></figure>

<h3 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h3><p>jadx打开。搜.com，有点弱智。</p>
<p>搜mail，有一个sendMailByJavaMail</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">m.set_host(C2.MAILHOST);</span><br><span class="line">m.set_port(C2.PORT);</span><br><span class="line">m.set_debuggable(<span class="keyword">true</span>);</span><br><span class="line">m.set_to(<span class="keyword">new</span> String[]&#123;mailto&#125;);</span><br><span class="line">m.set_from(C2.MAILFROME);</span><br><span class="line">m.set_subject(title);</span><br><span class="line">m.setBody(mailmsg);</span><br></pre></td></tr></table></figure>

<p>去c2看看</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CANCELNUMBER = <span class="string">"%23%2321%23"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILFROME = Base64.decode(NativeMethod.m());</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILHOST = <span class="string">"smtp.163.com"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILPASS = Base64.decode(NativeMethod.pwd());</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILSERVER = Base64.decode(NativeMethod.m());</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILUSER = Base64.decode(NativeMethod.m());</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MOVENUMBER = <span class="string">"**21*121%23"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String PORT = <span class="string">"25"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String date = <span class="string">"2115-11-1"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String phoneNumber = Base64.decode(NativeMethod.p());</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.net.cn;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NativeMethod</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">m</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">p</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">pwd</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不知道这是什么。</p>
<blockquote>
<p>  一个Native Method就是一个Java调用非java代码的接口</p>
<p>  “A native method is a Java method whose implementation is provided by non-java code.”</p>
</blockquote>
<p>wp：Java中NativeMethod一般用于调用外部文件，再用IDA打libcore.so</p>
<h3 id="easyRE"><a href="#easyRE" class="headerlink" title="easyRE"></a>easyRE</h3><p>在sub_4009C6()里有</p>
<p>char v57[36]</p>
<p>if ( (unsigned __int8)(v57[i] ^ i) != *(&amp;v21 + i) </p>
<p>写个代码看看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">b=a.replace(<span class="string">' '</span>,<span class="string">''</span>)</span><br><span class="line">c=b.replace(<span class="string">'\n'</span>,<span class="string">''</span>)</span><br><span class="line"><span class="comment">#c='v21=73;v22=111;v23=100;v24=108;v25=62;v26=81;v27=110;v28=98;v29=40;v30=111;v31=99;v32=121;v33=127;v34=121;v35=46;v36=105;v37=127;v38=100;v39=96;v40=51;v41=119;v42=125;v43=119;v44=101;v45=107;v46=57;v47=123;v48=105;v49=121;v50=61;v51=126;v52=121;v53=76;v54=64;v55=69;v56=67'</span></span><br><span class="line">fin=re.sub(<span class="string">r'v..='</span>, <span class="string">""</span>, c)</span><br><span class="line">num=fin.split(<span class="string">';'</span>)</span><br><span class="line">print(num)</span><br><span class="line">I=len(num)</span><br><span class="line">s=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(I):</span><br><span class="line">    s+=chr(int(num[i])^i)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<p>Info:The first four chars are <code>flag</code></p>
<p>sub_400E44是base64</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v9 == <span class="number">39</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v10 = sub_400E44((<span class="keyword">const</span> __m128i *)&amp;v59);</span><br><span class="line">  v11 = sub_400E44((<span class="keyword">const</span> __m128i *)v10);</span><br><span class="line">  v12 = sub_400E44((<span class="keyword">const</span> __m128i *)v11);</span><br><span class="line">  v13 = sub_400E44((<span class="keyword">const</span> __m128i *)v12);</span><br><span class="line">  v14 = sub_400E44((<span class="keyword">const</span> __m128i *)v13);</span><br><span class="line">  v15 = sub_400E44((<span class="keyword">const</span> __m128i *)v14);</span><br><span class="line">  v16 = sub_400E44((<span class="keyword">const</span> __m128i *)v15);</span><br><span class="line">  v17 = sub_400E44((<span class="keyword">const</span> __m128i *)v16);</span><br><span class="line">  v18 = sub_400E44((<span class="keyword">const</span> __m128i *)v17);</span><br><span class="line">  v19 = sub_400E44((<span class="keyword">const</span> __m128i *)v18);</span><br><span class="line">  v2 = off_6CC090;</span><br><span class="line">  v3 = (<span class="keyword">char</span> *)v19;</span><br><span class="line">  <span class="keyword">if</span> ( !sub_400360(v19, off_6CC090) )</span><br></pre></td></tr></table></figure>

<p>10次，最后和off_6CC090比：</p>
<blockquote>
<p>  Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==</p>
</blockquote>
<p><a href="https://bbs.pediy.com/thread-254172.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-254172.htm</a></p>
<p>毛线啊神经病</p>
<p>不知道该怎么下手，看wp</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A0 byte_6CC0A0     db 40h                  ; <span class="type">DATA</span> <span class="type">XREF</span>: sub_400D35+95r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A0                                         ; sub_400D35+<span class="type">C1</span>r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A1                 db  35h ; 5</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A2                 db  20h</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A3 byte_6CC0A3     db 56h                  ; <span class="type">DATA</span> <span class="type">XREF</span>: sub_400D35+<span class="type">A6</span>r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A4                 db  5Dh ; ]</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A5                 db  18h</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A6                 db  22h ; "</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A7                 db  45h ; <span class="type">E</span></span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A8                 db  17h</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A9                 db  2Fh ; /</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AA                 db  24h ; $</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AB                 db  6Eh ; n</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AC                 db  62h ; b</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AD                 db  3Ch ; &lt;</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AE                 db  27h ; '</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AF                 db  54h ; <span class="type">T</span></span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B0                 db  48h ; <span class="type">H</span></span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B1                 db  6Ch ; l</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B2                 db  24h ; $</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B3                 db  6Eh ; n</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B4                 db  72h ; r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B5                 db  3Ch ; &lt;</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B6                 db  32h ; 2</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B7                 db  45h ; <span class="type">E</span></span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B8                 db  5Bh ; [</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">v7 = v4;</span><br><span class="line">v9 = BYTE3(v4);</span><br><span class="line"><span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> __int8)v4 ^ byte_6CC0A0[<span class="number">0</span>]) == <span class="number">102</span> &amp;&amp; (v9 ^ (<span class="keyword">unsigned</span> __int8)byte_6CC0A3) == <span class="number">103</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">24</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = (<span class="keyword">unsigned</span> __int8)(byte_6CC0A0[(<span class="keyword">signed</span> __int64)j] ^ *((_BYTE *)&amp;v7</span><br><span class="line">                                                              + (<span class="keyword">signed</span> <span class="keyword">int</span>)(((((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">unsigned</span> __int64)j &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">30</span>)</span><br><span class="line">                                                                             + (_BYTE)j) &amp; <span class="number">3</span>)</span><br><span class="line">                                                                           - ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">unsigned</span> __int64)j &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">30</span>))));</span><br><span class="line">      sub_410E90(v2);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>102是f，103是g。byte_6CC0A0应该是flag，先把v7解出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">''</span></span><br><span class="line">enc1 = <span class="string">'flag'</span></span><br><span class="line">dec = <span class="string">''</span></span><br><span class="line">enc = [<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    key += chr(enc[i] ^ ord(enc1[i]))</span><br><span class="line"><span class="keyword">print</span> (key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    dec += chr(enc[i] ^ ord(key[i%<span class="number">4</span>]))</span><br><span class="line">print(dec)</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/Mayfly-nymph/p/11869959.html" target="_blank" rel="noopener">https://www.cnblogs.com/Mayfly-nymph/p/11869959.html</a></p>
<p>脱壳</p>
<p>shift+f12字符串表</p>
<p>alt+t搜索字符串</p>
<p>f5伪代码</p>
<p>c强制转换代码</p>
<p>写py</p>
<h2 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h2><h3 id="CryptCreateHash-ALG-ID"><a href="#CryptCreateHash-ALG-ID" class="headerlink" title="CryptCreateHash:ALG_ID"></a>CryptCreateHash:ALG_ID</h3><table>
<thead>
<tr>
<th align="left">Identifier</th>
<th align="left">Value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CALG_3DES</td>
<td align="left">0x00006603</td>
<td align="left"><a href="https://docs.microsoft.com/windows/desktop/SecGloss/t-gly" target="_blank" rel="noopener"><em>Triple DES</em></a> encryption algorithm.</td>
</tr>
<tr>
<td align="left">CALG_3DES_112</td>
<td align="left">0x00006609</td>
<td align="left">Two-key <a href="https://docs.microsoft.com/windows/desktop/SecGloss/t-gly" target="_blank" rel="noopener"><em>triple DES</em></a> encryption with effective key length equal to 112 bits.</td>
</tr>
<tr>
<td align="left">CALG_AES</td>
<td align="left">0x00006611</td>
<td align="left">Advanced Encryption Standard (AES). This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-aes-cryptographic-provider" target="_blank" rel="noopener">Microsoft AES Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_AES_128</td>
<td align="left">0x0000660e</td>
<td align="left">128 bit AES. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-aes-cryptographic-provider" target="_blank" rel="noopener">Microsoft AES Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_AES_192</td>
<td align="left">0x0000660f</td>
<td align="left">192 bit AES. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-aes-cryptographic-provider" target="_blank" rel="noopener">Microsoft AES Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_AES_256</td>
<td align="left">0x00006610</td>
<td align="left">256 bit AES. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-aes-cryptographic-provider" target="_blank" rel="noopener">Microsoft AES Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_AGREEDKEY_ANY</td>
<td align="left">0x0000aa03</td>
<td align="left">Temporary algorithm identifier for handles of Diffie-Hellman–agreed keys.</td>
</tr>
<tr>
<td align="left">CALG_CYLINK_MEK</td>
<td align="left">0x0000660c</td>
<td align="left">An algorithm to create a 40-bit DES key that has parity bits and zeroed key bits to make its key length 64 bits. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_DES</td>
<td align="left">0x00006601</td>
<td align="left">DES encryption algorithm.</td>
</tr>
<tr>
<td align="left">CALG_DESX</td>
<td align="left">0x00006604</td>
<td align="left">DESX encryption algorithm.</td>
</tr>
<tr>
<td align="left">CALG_DH_EPHEM</td>
<td align="left">0x0000aa02</td>
<td align="left">Diffie-Hellman ephemeral key exchange algorithm.</td>
</tr>
<tr>
<td align="left">CALG_DH_SF</td>
<td align="left">0x0000aa01</td>
<td align="left">Diffie-Hellman store and forward key exchange algorithm.</td>
</tr>
<tr>
<td align="left">CALG_DSS_SIGN</td>
<td align="left">0x00002200</td>
<td align="left">DSA <a href="https://docs.microsoft.com/windows/desktop/SecGloss/p-gly" target="_blank" rel="noopener"><em>public key</em></a> signature algorithm.</td>
</tr>
<tr>
<td align="left">CALG_ECDH</td>
<td align="left">0x0000aa05</td>
<td align="left">Elliptic curve Diffie-Hellman key exchange algorithm.[!Note] This algorithm is supported only through <a href="https://docs.microsoft.com/windows/desktop/SecCNG/cng-portal" target="_blank" rel="noopener">Cryptography API: Next Generation</a>. <strong>Windows Server 2003 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_ECDH_EPHEM</td>
<td align="left">0x0000ae06</td>
<td align="left">Ephemeral elliptic curve Diffie-Hellman key exchange algorithm.[!Note] This algorithm is supported only through <a href="https://docs.microsoft.com/windows/desktop/SecCNG/cng-portal" target="_blank" rel="noopener">Cryptography API: Next Generation</a>. <strong>Windows Server 2003 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_ECDSA</td>
<td align="left">0x00002203</td>
<td align="left">Elliptic curve digital signature algorithm.[!Note] This algorithm is supported only through <a href="https://docs.microsoft.com/windows/desktop/SecCNG/cng-portal" target="_blank" rel="noopener">Cryptography API: Next Generation</a>. <strong>Windows Server 2003 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_ECMQV</td>
<td align="left">0x0000a001</td>
<td align="left">Elliptic curve Menezes, Qu, and Vanstone (MQV) key exchange algorithm. This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_HASH_REPLACE_OWF</td>
<td align="left">0x0000800b</td>
<td align="left">One way function hashing algorithm.</td>
</tr>
<tr>
<td align="left">CALG_HUGHES_MD5</td>
<td align="left">0x0000a003</td>
<td align="left">Hughes MD5 hashing algorithm.</td>
</tr>
<tr>
<td align="left">CALG_HMAC</td>
<td align="left">0x00008009</td>
<td align="left">HMAC keyed hash algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_KEA_KEYX</td>
<td align="left">0x0000aa04</td>
<td align="left">KEA key exchange algorithm (FORTEZZA). This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_MAC</td>
<td align="left">0x00008005</td>
<td align="left"><a href="https://docs.microsoft.com/windows/desktop/SecGloss/m-gly" target="_blank" rel="noopener"><em>MAC</em></a> keyed hash algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_MD2</td>
<td align="left">0x00008001</td>
<td align="left">MD2 hashing algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_MD4</td>
<td align="left">0x00008002</td>
<td align="left">MD4 hashing algorithm.</td>
</tr>
<tr>
<td align="left">CALG_MD5</td>
<td align="left">0x00008003</td>
<td align="left">MD5 hashing algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_NO_SIGN</td>
<td align="left">0x00002000</td>
<td align="left">No signature algorithm.</td>
</tr>
<tr>
<td align="left">CALG_OID_INFO_CNG_ONLY</td>
<td align="left">0xffffffff</td>
<td align="left">The algorithm is only implemented in CNG. The macro, IS_SPECIAL_OID_INFO_ALGID, can be used to determine whether a cryptography algorithm is only supported by using the CNG functions.</td>
</tr>
<tr>
<td align="left">CALG_OID_INFO_PARAMETERS</td>
<td align="left">0xfffffffe</td>
<td align="left">The algorithm is defined in the encoded parameters. The algorithm is only supported by using CNG. The macro, IS_SPECIAL_OID_INFO_ALGID, can be used to determine whether a cryptography algorithm is only supported by using the CNG functions.</td>
</tr>
<tr>
<td align="left">CALG_PCT1_MASTER</td>
<td align="left">0x00004c04</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_RC2</td>
<td align="left">0x00006602</td>
<td align="left">RC2 block encryption algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_RC4</td>
<td align="left">0x00006801</td>
<td align="left">RC4 stream encryption algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_RC5</td>
<td align="left">0x0000660d</td>
<td align="left">RC5 block encryption algorithm.</td>
</tr>
<tr>
<td align="left">CALG_RSA_KEYX</td>
<td align="left">0x0000a400</td>
<td align="left">RSA public key exchange algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_RSA_SIGN</td>
<td align="left">0x00002400</td>
<td align="left">RSA public key signature algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_SCHANNEL_ENC_KEY</td>
<td align="left">0x00004c07</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SCHANNEL_MAC_KEY</td>
<td align="left">0x00004c03</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SCHANNEL_MASTER_HASH</td>
<td align="left">0x00004c02</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SEAL</td>
<td align="left">0x00006802</td>
<td align="left">SEAL encryption algorithm. This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SHA</td>
<td align="left">0x00008004</td>
<td align="left">SHA hashing algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_SHA1</td>
<td align="left">0x00008004</td>
<td align="left">Same as <strong>CALG_SHA</strong>. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_SHA_256</td>
<td align="left">0x0000800c</td>
<td align="left">256 bit SHA hashing algorithm. This algorithm is supported by Microsoft Enhanced RSA and AES Cryptographic Provider..<strong>Windows XP with SP3:</strong> This algorithm is supported by the Microsoft Enhanced RSA and AES Cryptographic Provider (Prototype). <strong>Windows XP with SP2, Windows XP with SP1 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SHA_384</td>
<td align="left">0x0000800d</td>
<td align="left">384 bit SHA hashing algorithm. This algorithm is supported by Microsoft Enhanced RSA and AES Cryptographic Provider.<strong>Windows XP with SP3:</strong> This algorithm is supported by the Microsoft Enhanced RSA and AES Cryptographic Provider (Prototype). <strong>Windows XP with SP2, Windows XP with SP1 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SHA_512</td>
<td align="left">0x0000800e</td>
<td align="left">512 bit SHA hashing algorithm. This algorithm is supported by Microsoft Enhanced RSA and AES Cryptographic Provider.<strong>Windows XP with SP3:</strong> This algorithm is supported by the Microsoft Enhanced RSA and AES Cryptographic Provider (Prototype). <strong>Windows XP with SP2, Windows XP with SP1 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SKIPJACK</td>
<td align="left">0x0000660a</td>
<td align="left">Skipjack block encryption algorithm (FORTEZZA). This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SSL2_MASTER</td>
<td align="left">0x00004c05</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SSL3_MASTER</td>
<td align="left">0x00004c01</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SSL3_SHAMD5</td>
<td align="left">0x00008008</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_TEK</td>
<td align="left">0x0000660b</td>
<td align="left">TEK (FORTEZZA). This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_TLS1_MASTER</td>
<td align="left">0x00004c06</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_TLS1PRF</td>
<td align="left">0x0000800a</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
</tbody></table>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/buuctf/" rel="tag"># buuctf</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/25/ceshi/" rel="next" title="ceshi">
                <i class="fa fa-chevron-left"></i> ceshi
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/zzx.jpg" alt="SunDaSheng">
            
              <p class="site-author-name" itemprop="name">SunDaSheng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/st12138" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:best_st@outlook.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#day1-5-5"><span class="nav-number">1.</span> <span class="nav-text">day1    5.5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#easyre"><span class="nav-number">1.1.</span> <span class="nav-text">easyre</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse1"><span class="nav-number">1.2.</span> <span class="nav-text">reverse1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reserve2"><span class="nav-number">1.3.</span> <span class="nav-text">reserve2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#新年快乐"><span class="nav-number">1.4.</span> <span class="nav-text">新年快乐</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day2-5-6"><span class="nav-number">2.</span> <span class="nav-text">day2    5.6</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#helloworld"><span class="nav-number">2.1.</span> <span class="nav-text">helloworld</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内涵软件"><span class="nav-number">2.2.</span> <span class="nav-text">内涵软件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xor"><span class="nav-number">2.3.</span> <span class="nav-text">xor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#guessgame"><span class="nav-number">2.4.</span> <span class="nav-text">guessgame</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reserve-3"><span class="nav-number">2.5.</span> <span class="nav-text">reserve_3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day3-5-7"><span class="nav-number">3.</span> <span class="nav-text">day3    5.7</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#不一样的flag"><span class="nav-number">3.1.</span> <span class="nav-text">不一样的flag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#刮开有奖"><span class="nav-number">3.2.</span> <span class="nav-text">刮开有奖</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day4-5-8"><span class="nav-number">4.</span> <span class="nav-text">day4    5.8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#simpleRev"><span class="nav-number">4.1.</span> <span class="nav-text">simpleRev</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#java逆向解密"><span class="nav-number">4.2.</span> <span class="nav-text">java逆向解密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#findit"><span class="nav-number">4.3.</span> <span class="nav-text">findit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8086"><span class="nav-number">4.4.</span> <span class="nav-text">8086</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rsa"><span class="nav-number">4.5.</span> <span class="nav-text">rsa</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day5-5-9"><span class="nav-number">5.</span> <span class="nav-text">day5    5.9</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CrackRTF"><span class="nav-number">5.1.</span> <span class="nav-text">CrackRTF</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day6-5-10"><span class="nav-number">6.</span> <span class="nav-text">day6    5.10</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注册器"><span class="nav-number">6.1.</span> <span class="nav-text">注册器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#luck-guy"><span class="nav-number">6.2.</span> <span class="nav-text">luck_guy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#younger-drive"><span class="nav-number">6.3.</span> <span class="nav-text">younger_drive</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day7-5-11"><span class="nav-number">7.</span> <span class="nav-text">day7    5.11</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pyre"><span class="nav-number">7.1.</span> <span class="nav-text">pyre</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#相册"><span class="nav-number">7.2.</span> <span class="nav-text">相册</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyRE"><span class="nav-number">7.3.</span> <span class="nav-text">easyRE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附件"><span class="nav-number">8.</span> <span class="nav-text">附件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CryptCreateHash-ALG-ID"><span class="nav-number">8.1.</span> <span class="nav-text">CryptCreateHash:ALG_ID</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SunDaSheng</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">16.5k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
