<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="buuctf,">










<meta name="description" content="教练我想学逆向">
<meta name="keywords" content="buuctf">
<meta property="og:type" content="article">
<meta property="og:title" content="re的刷题">
<meta property="og:url" content="http://yoursite.com/2020/05/12/re的刷题/index.html">
<meta property="og:site_name" content="SunDaSheng&#39;s blog">
<meta property="og:description" content="教练我想学逆向">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/D:%5Cstudy%5C%E7%9E%8C%E7%9D%A1%E8%99%AB-%E5%AE%89%E5%85%A8%5C%E9%A2%98%E7%9B%AE%5Cre%5Creverse1%5CSnipaste_2020-05-05_20-15-53.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-05_21-14-01.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-05_21-13-47.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-05_21-26-53.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-05_21-28-08.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-06_19-15-27.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-07_20-35-40.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-08_20-38-41.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-11_17-10-58.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-14_20-38-27.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-15_19-38-24.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-15_19-38-39.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-15_19-38-52.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-15_19-37-47.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-17_17-05-21.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-17_17-20-18.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-19_17-15-39.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-19_17-15-55.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-19_17-13-58.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-19_17-21-58.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-23_17-03-35.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-06-05_21-47-36.png">
<meta property="og:image" content="http://yoursite.com/2020/05/12/re的刷题/Snipaste_2020-06-05_17-04-13.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/08/01/a8I9KO.png">
<meta property="og:image" content="https://s1.ax1x.com/2020/08/01/a85vP1.png">
<meta property="og:updated_time" content="2020-08-01T10:42:32.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="re的刷题">
<meta name="twitter:description" content="教练我想学逆向">
<meta name="twitter:image" content="http://yoursite.com/2020/05/12/re的刷题/D:%5Cstudy%5C%E7%9E%8C%E7%9D%A1%E8%99%AB-%E5%AE%89%E5%85%A8%5C%E9%A2%98%E7%9B%AE%5Cre%5Creverse1%5CSnipaste_2020-05-05_20-15-53.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/05/12/re的刷题/">





  <title>re的刷题 | SunDaSheng's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">SunDaSheng's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">hello,stupid wrold</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archives"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/12/re的刷题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SunDaSheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/zzx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SunDaSheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">re的刷题</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-12T14:22:47+08:00">
                2020-05-12
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-08-01T18:42:32+08:00">
                2020-08-01
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf/" itemprop="url" rel="index">
                    <span itemprop="name">ctf</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf/re/" itemprop="url" rel="index">
                    <span itemprop="name">re</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  30.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  170
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>教练我想学逆向</p>
<a id="more"></a>

<h2 id="day1-5-5"><a href="#day1-5-5" class="headerlink" title="day1    5.5"></a>day1    5.5</h2><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><p>拖进ida，shift+F12查找flag</p>
<blockquote>
<p>  IDA Pro:交互式反汇编器，是典型的递归下降反汇编器。</p>
<p>  导航条:<br>      蓝色 表示常规的指令函数<br>      黑色 节与节之间的间隙<br>      银白色 数据内容<br>      粉色 表示外部导入符号<br>      暗黄色 表示ida未识别的内容</p>
<p>  IDA主界面:<br>      IDA View三种反汇编视图:文本视图、图表视图、路径视图<br>      Hex View 十六进制窗口<br>      Imports 导入函数窗口<br>      Struceures 结构体窗口<br>      Exports 导出函数窗口<br>      Enums 枚举窗口<br>      Strings 字符串窗口</p>
<p>  常用功能及快捷键:<br>      空格键:切换文本视图与图表视图<br>      ESC:返回上一个操作地址<br>      G:搜索地址和符号<br>      N:对符号进行重命名<br>      冒号键:常规注释<br>      分号键:可重复注释<br>      Alt+M:添加标签<br>      Ctrl+M:查看标签<br>      Ctrl+S:查看段的信息<br>      代码数据切换<br>      C–&gt;代码/D–&gt;数据/A–&gt;ascii字符串/U–&gt;解析成未定义的内容<br>      X:查看交叉应用<br>      F5:查看伪代码<br>      Alt+T:搜索文本<br>      Alt+B:搜索十六进制</p>
<p>  导入jni.h分析jni库函数。</p>
<p>  伪C代码窗口:<br>      右键<br>      comment-注释伪c代码。<br>      copy to -assembly-把伪c代码复制到反汇编窗口的汇编代码。</p>
<p>  IDA可以修改so的hex来修改so，edit，然后edit-patchrogram，<br>  在这里建议使用winhex来实现。<br>  ————————————————<br>  版权声明：本文为CSDN博主「阿鲁巴110」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>  原文链接：<a href="https://blog.csdn.net/qq_30531517/java/article/details/82559428" target="_blank" rel="noopener">https://blog.csdn.net/qq_30531517/java/article/details/82559428</a></p>
</blockquote>
<h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h3><p>查找flag找到</p>
<p>aThisIsTheRight db ‘this is the right flag!’,0Ah,0</p>
<p>接下来寻找什么时候调用的</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">loc_140011948:</span>                          <span class="comment">; CODE XREF: sub_1400118C0+61j</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011948</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, aInputTheFlag <span class="comment">; "input the flag:"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001194F                 <span class="keyword">call</span>    sub_1400111D1</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011954</span>                 <span class="keyword">lea</span>     <span class="built_in">rdx</span>, [<span class="built_in">rbp</span>+<span class="number">130h</span>+Str1]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011958</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, a20s       <span class="comment">; "%20s"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001195F                 <span class="keyword">call</span>    sub_14001128F</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011964</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, Str2       <span class="comment">; "&#123;hello_world&#125;"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001196B                 <span class="keyword">call</span>    j_strlen</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011970</span>                 <span class="keyword">mov</span>     <span class="built_in">r8</span>, <span class="built_in">rax</span>         <span class="comment">; MaxCount</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011973</span>                 <span class="keyword">lea</span>     <span class="built_in">rdx</span>, Str2       <span class="comment">; "&#123;hello_world&#125;"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001197A                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">130h</span>+Str1] <span class="comment">; Str1</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001197E                 <span class="keyword">call</span>    <span class="built_in">cs</span>:strncmp</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011984</span>                 <span class="keyword">test</span>    <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011986</span>                 <span class="keyword">jz</span>      short loc_140011996</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011988</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, aWrongFlag <span class="comment">; "wrong flag\n"</span></span><br><span class="line"><span class="symbol">.text:</span>000000014001198F                 <span class="keyword">call</span>    sub_1400111D1</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011994</span>                 <span class="keyword">jmp</span>     short loc_1400119A2</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011996</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011996</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011996</span> loc_140011996:                          <span class="comment">; CODE XREF: sub_1400118C0+C6j</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000140011996</span>                 <span class="keyword">lea</span>     <span class="built_in">rcx</span>, aThisIsTheRight <span class="comment">; "this is the right flag!\n"</span></span><br></pre></td></tr></table></figure>

<p>第一次：hello_world，错误。</p>
<blockquote>
<p>  1，所用的寄存器不同于32下的eax,ebx,ecx,edx,esi,edi,esp,ebp等，在64位下是rax,rbx,rcx,rdx,rsi,rdi,rsp,rbp,此外又增加了r8,r9,r10,r11,r12,r13,r14,r15等寄存器。但eax,ax,ah,al等依然可用，且增加了spl,bpl等8位寄存器调用，r8等也可以用r8d,r8w,r8b进行32位，16位，8位的调用。<br>  2，函数调用参数传递不同于32下的stdcall规范，而采用fastcall，前四个参数为别放入rcx,rdx,r8,r9四个寄存器中，并在堆栈中留出4*8=32个字节的空间，多于四个的参数放入堆栈。<br>  3，函数调用后，由调用者负责堆栈回收。</p>
</blockquote>
<p>伪代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_1400118C0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v0; <span class="comment">// rdi@1</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// rcx@1</span></span><br><span class="line">  <span class="keyword">size_t</span> v2; <span class="comment">// rax@5</span></span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rax@9</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [sp+0h] [bp-20h]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v6; <span class="comment">// [sp+20h] [bp+0h]@4</span></span><br><span class="line">  <span class="keyword">char</span> Str1; <span class="comment">// [sp+48h] [bp+28h]@9</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [sp+128h] [bp+108h]@5</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// [sp+130h] [bp+110h]@4</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v5;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">82</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v0 = <span class="number">-858993460</span>;</span><br><span class="line">    v0 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = (<span class="keyword">unsigned</span> __int64)&amp;v6 ^ _security_cookie;</span><br><span class="line">  <span class="keyword">for</span> ( *(&amp;v6 + <span class="number">1</span>) = <span class="number">0</span>; ; ++*(&amp;v6 + <span class="number">1</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = *(&amp;v6 + <span class="number">1</span>);</span><br><span class="line">    v2 = j_strlen(Str2);</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt; v2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( Str2[(<span class="keyword">signed</span> __int64)*(&amp;v6 + <span class="number">1</span>)] == <span class="number">111</span> )</span><br><span class="line">      Str2[(<span class="keyword">signed</span> __int64)*(&amp;v6 + <span class="number">1</span>)] = <span class="number">48</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400111D1(<span class="string">"input the flag:"</span>);</span><br><span class="line">  sub_14001128F(<span class="string">"%20s"</span>, &amp;Str1);</span><br><span class="line">  v3 = j_strlen(Str2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(&amp;Str1, Str2, v3) )</span><br><span class="line">    sub_1400111D1(<span class="string">"this is the right flag!\n"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_1400111D1(<span class="string">"wrong flag\n"</span>);</span><br><span class="line">  sub_14001113B(&amp;v5, &amp;unk_140019D00);</span><br><span class="line">  <span class="keyword">return</span> sub_1400112E9((<span class="keyword">unsigned</span> __int64)&amp;v6 ^ v9);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  strncmp函数为字符串比较函数，字符串大小的比较是以ASCII 码表上的顺序来决定，此顺序亦为字符的值。其函数声明为int strncmp ( const char * str1, const char * str2, size_t n );功能是把 str1 和 str2 进行比较，最多比较前 <strong>n</strong> 个字节，若str1与str2的前n个字符相同，则返回0；若s1大于s2，则返回大于0的值；若s1 小于s2，则返回小于0的值。</p>
</blockquote>
<p>111为o，48为0，把str2字符串的o变成0</p>
<p>lea —-取内存单元的有效知地址指令，只用于传送地道址。</p>
<p>ptr—–是临时的类型转换，相当于C语言中的强制类型转换</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/D:%5Cstudy%5C%E7%9E%8C%E7%9D%A1%E8%99%AB-%E5%AE%89%E5%85%A8%5C%E9%A2%98%E7%9B%AE%5Cre%5Creverse1%5CSnipaste_2020-05-05_20-15-53.png" alt></p>
<h3 id="reserve2"><a href="#reserve2" class="headerlink" title="reserve2"></a>reserve2</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601080 ; char flag</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601080 flag            db 7Bh                  ; <span class="type">DATA</span> <span class="type">XREF</span>: main+34r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601080                                         ; main+44r ...</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601081 aHacking_for_fu db 'hacking_for_fun&#125;',0</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:0000000000601081 _data           ends</span></span><br></pre></td></tr></table></figure>

<p>flag：hacking_for_fun}</p>
<p>伪代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span> ( pid )</span><br><span class="line">  &#123;</span><br><span class="line">    argv = (<span class="keyword">const</span> <span class="keyword">char</span> **)&amp;stat_loc;</span><br><span class="line">    waitpid(pid, &amp;stat_loc, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="built_in">strlen</span>(&amp;flag); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(&amp;flag + i) == <span class="number">105</span> || *(&amp;flag + i) == <span class="number">114</span> )</span><br><span class="line">        *(&amp;flag + i) = <span class="number">49</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"input the flag:"</span>, argv);</span><br><span class="line">  __isoc99_scanf(<span class="number">4196628L</span>L, &amp;s2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;flag, &amp;s2) )</span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">"this is the right flag!"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">"wrong flag!"</span>);</span><br><span class="line">  v4 = *MK_FP(__FS__, <span class="number">40L</span>L) ^ v9;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>105：i，114：r，49：1</p>
<p>试一试hack1ng_fo1_fun，起飞。</p>
<p>版本不兼容，后来点了以兼容模式运行</p>
<h3 id="新年快乐"><a href="#新年快乐" class="headerlink" title="新年快乐"></a>新年快乐</h3><p>打开有点不对</p>
<blockquote>
<p>  UPX是一个著名的压缩壳,主要功能是压缩PE文件(比如exe,dll等文件),有时候也可能被病毒用于免杀.壳upx是一种保护程序。一般是EXE文件的一种外保护措施，主要用途 ：</p>
<p>  1、让正规文件被保护起来，不容易被修改和破解。</p>
<p>  2、使文件压缩变小。</p>
<p>  3、保护杀毒软件安装程序，使之不受病毒侵害。</p>
<p>  4、木马，病毒的保护外壳，使之难以为攻破。 </p>
<ul>
<li>技术原理</li>
</ul>
<p>  对于可执行程序资源压缩,是保护文件的常用手段. 俗称加壳,加壳过的程序可以直接运行,但是不能查看源代码.要经过脱壳才可以查看源代码.</p>
<p>  加壳：其实是利用特殊的算法，对EXE、DLL文件里的资源进行压缩。类似WINZIP的效果，只不过这个压缩之后的文件，可以独立运行，解压过程完全隐蔽，都在内存中完成。解压原理，是加壳工具在文件头里加了一段指令，告诉CPU，怎么才能解压自己。当加壳时，其实就是给可执行的文件加上个外衣。用户执行的只是这个外壳程序。当执行这个程序的时候这个壳就会把原来的程序在内存中解开，解开后，以后的就交给真正的程序。</p>
<ul>
<li><p>加壳脱壳</p>
<p>程序为了反跟踪、被人跟踪调试、防止算法程序被别人静态分析就需要加壳。使用加壳软件加密代码和数据，就可以保护你程序数据的完整性，防止被程序修改和被窥视内幕。<br><a href="https://blog.csdn.net/dubuqingfenggzy/java/article/details/16881607" target="_blank" rel="noopener">https://blog.csdn.net/dubuqingfenggzy/java/article/details/16881607</a></p>
</li>
</ul>
</blockquote>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-05_21-14-01.png" alt="Snipaste_2020-05-05_21-14-01"></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-05_21-13-47.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-05_21-26-53.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-05_21-28-08.png" alt></p>
<p>happly new year!</p>
<h2 id="day2-5-6"><a href="#day2-5-6" class="headerlink" title="day2    5.6"></a>day2    5.6</h2><h3 id="helloworld"><a href="#helloworld" class="headerlink" title="helloworld"></a>helloworld</h3><p>apk文件。</p>
<blockquote>
<p>  APK是Android操作系统使用的一种应用程序包文件格式，基于 ZIP 文件格式。</p>
</blockquote>
<p>我用jadx打开。</p>
<h3 id="内涵软件"><a href="#内涵软件" class="headerlink" title="内涵软件"></a>内涵软件</h3><p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-06_19-15-27.png" alt></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">v3 = (<span class="keyword">int</span>)<span class="string">"DBAPP&#123;49d3c93df25caad81232130f3d2ebfad&#125;"</span>;</span><br><span class="line"><span class="keyword">while</span> ( v4 &gt;= <span class="number">0</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"距离出现答案还有%d秒，请耐心等待！\n"</span>, v4);</span><br><span class="line">  sub_40100A();</span><br><span class="line">  --v4;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n\n\n这里本来应该是答案的,但是粗心的程序员忘记把变量写进来了,你要不逆向试试看:(Y/N)\n"</span>);</span><br><span class="line">v2 = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%c"</span>, &amp;v2);</span><br><span class="line"><span class="keyword">if</span> ( v2 == <span class="number">89</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"OD吾爱破解或者IDA这些逆向软件都挺好的！"</span>);</span><br><span class="line">  result = sub_40100A();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>内涵</p>
<h3 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h3><p>我傻了，没注意64位。</p>
<p>伪代码，v7是输入且33位异或后==global</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"Input your flag:\n"</span>, <span class="number">0L</span>L);</span><br><span class="line">  get_line(v7, <span class="number">256L</span>L);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v7) != <span class="number">33</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt; <span class="number">33</span>; ++i )</span><br><span class="line">    v7[i] ^= v7[i - <span class="number">1</span>];</span><br><span class="line">  v3 = (<span class="keyword">signed</span> __int64)global;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(v7, global, <span class="number">0x21</span>uLL) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Success"</span>, v3);</span><br></pre></td></tr></table></figure>

<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aFKWO_<span class="meta">@XZUPFVMD</span> </span><br><span class="line">db <span class="string">'f'</span>,<span class="number">0</span>Ah              </span><br><span class="line">; DATA <span class="string">XREF:</span> <span class="string">__data:</span>_globalo</span><br><span class="line">db <span class="string">'k'</span>,<span class="number">0</span>Ch,<span class="string">'w&amp;O.@'</span>,<span class="number">11</span>h,<span class="string">'x'</span>,<span class="number">0</span>Dh,<span class="string">'Z;U'</span>,<span class="number">11</span>h,<span class="string">'p'</span>,<span class="number">19</span>h,<span class="string">'F'</span>,<span class="number">1</span>Fh,<span class="string">'v"M#D'</span>,<span class="number">0</span>Eh,<span class="string">'g'</span>,<span class="number">6</span>,<span class="string">'h'</span>,<span class="number">0</span>Fh,<span class="string">'G2O'</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="string">'f'</span>, <span class="string">'k'</span>,<span class="number">0xC</span>,<span class="string">'w&amp;O.@'</span>,<span class="number">0x11</span>,<span class="string">'x'</span>,<span class="number">0xD</span>,<span class="string">'Z;U'</span>,<span class="number">0x11</span>,<span class="string">'p'</span>,<span class="number">0x19</span>,<span class="string">'F'</span>,<span class="number">0x1F</span>,<span class="string">'v"M#D'</span>,<span class="number">0x0E</span>,<span class="string">'g'</span>,<span class="number">6</span>,<span class="string">'h'</span>,<span class="number">0xF</span>,<span class="string">'G2O'</span>,<span class="number">0</span>]</span><br><span class="line"><span class="comment">#print(len(a))</span></span><br><span class="line"><span class="comment">#print(type(a[2]))</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    <span class="keyword">if</span> type(a[i]).__name__ == <span class="string">'int'</span>:</span><br><span class="line">        a[i]=chr(a[i])</span><br><span class="line">print(a)</span><br><span class="line">a=<span class="string">""</span>.join(a)</span><br><span class="line"><span class="comment">#print(len(a))</span></span><br><span class="line">flag=<span class="string">'f'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    flag+=chr(ord(a[i])^ord(a[i<span class="number">-1</span>]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>写的脚本有点问题，得到fg{QianQiuWanDai_YiTongJiangHu}O，应该是flag{QianQiuWanDai_YiTongJiangHu}</p>
<h3 id="guessgame"><a href="#guessgame" class="headerlink" title="guessgame"></a>guessgame</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lea</span>     <span class="built_in">rax</span>, aBjdS1mple_rev3 <span class="comment">; "BJD&#123;S1mple_ReV3r5e_W1th_0D_0r_IDA&#125;"</span></span><br></pre></td></tr></table></figure>

<p>签到题</p>
<h3 id="reserve-3"><a href="#reserve-3" class="headerlink" title="reserve_3"></a>reserve_3</h3><p>输入flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sub_41132F(<span class="string">"please enter the flag:"</span>, v4);</span><br><span class="line">sub_411375(<span class="string">"%20s"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;Str);</span><br><span class="line">v0 = j_strlen(&amp;Str);</span><br><span class="line">v1 = (<span class="keyword">const</span> <span class="keyword">char</span> *)sub_4110BE(&amp;Str, v0, &amp;v11);</span><br><span class="line"><span class="built_in">strncpy</span>(Dest, v1, <span class="number">0x28</span>u);</span><br><span class="line">sub_411127();</span><br><span class="line">i = j_strlen(Dest);</span><br><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; (<span class="keyword">signed</span> <span class="keyword">int</span>)j &lt; (<span class="keyword">signed</span> <span class="keyword">int</span>)i; ++j )</span><br><span class="line">   Dest[j] += j;</span><br><span class="line">v2 = j_strlen(Dest);</span><br><span class="line"><span class="built_in">strncmp</span>(Dest, Str2, v2);</span><br><span class="line"><span class="keyword">if</span> ( sub_411127() )</span><br><span class="line">   sub_41132F(<span class="string">"wrong flag!\n"</span>, v4);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   sub_41132F(<span class="string">"rigth flag!\n"</span>, v4);</span><br><span class="line">sub_41126C(&amp;savedregs, &amp;dword_415890);</span><br></pre></td></tr></table></figure>

<p>sub_41132F输出，sub_411375输入。输入str经过sub_4110BE变成v1，变成Dest，dest里循环加j，0&lt;j&lt;len(dest),比较str2。</p>
<p>找str2</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">push</span>    offset Str2     ; <span class="string">"e3nifIH9b_C@n@dH"</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">"e3nifIH9b_C@n@dH"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    flag+=chr(ord(a[i])-i )</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>结果：e2lfbDB2ZV95b3V9，错误。忘了还有sub_4110BE。sub_411AB0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( i == <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[(<span class="keyword">signed</span> <span class="keyword">int</span>)(<span class="keyword">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( v4 == <span class="number">2</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[(<span class="keyword">signed</span> <span class="keyword">int</span>)(<span class="keyword">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">2</span>] &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>) | <span class="number">4</span> * (byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( v4 == <span class="number">3</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[(<span class="keyword">signed</span> <span class="keyword">int</span>)(<span class="keyword">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">2</span>] &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>) | <span class="number">4</span> * (byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF</span>)];</span><br><span class="line">          *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[byte_41A144[<span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span>     <span class="built_in">cl</span>, <span class="built_in">byte</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:aAbcdefghijklmn[<span class="built_in">edx</span>] <span class="comment">; "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm"...</span></span><br></pre></td></tr></table></figure>

<p>base64,emmmmmmmmm~~</p>
<h2 id="day3-5-7"><a href="#day3-5-7" class="headerlink" title="day3    5.7"></a>day3    5.7</h2><h3 id="不一样的flag"><a href="#不一样的flag" class="headerlink" title="不一样的flag"></a>不一样的flag</h3><p>看到提示我觉得不妙，会不会f5不能用了。</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-07_20-35-40.png" alt></p>
<p>搜索flag。</p>
<p>call    _puts应该是输出ptr，call    _printf</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"you can choose one action to execute"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"1 up"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"2 down"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"3 left"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"4 right\n:"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v3);</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v3 &gt; <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 == <span class="number">3</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        --v2;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v3 != <span class="number">4</span> )</span><br><span class="line">           LABEL_13:</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        ++v2;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">1</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      --v1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(&amp;v1 + i) &lt; <span class="number">0</span> || *(&amp;v1 + i) &gt; <span class="number">4</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v5 + <span class="number">5</span> * v1 + v2 - <span class="number">41</span>) == <span class="number">49</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v5 + <span class="number">5</span> * v1 + v2 - <span class="number">41</span>) == <span class="number">35</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"\nok, the order you enter is the flag!"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>v3=1,v1–;</p>
<p>v3=2,v1++;</p>
<p>v3=3,v2–;</p>
<p>v3=4,v2++;</p>
<p>v5+5*v1+v2-41=35(‘#’)!=49(‘1’)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> v0; <span class="comment">// [sp+17h] [bp-35h]@1</span></span><br><span class="line">qmemcpy(&amp;v0, _data_start__, <span class="number">0x19</span>u);</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov     ebx, offset __data_start__ ; <span class="string">"*11110100001010000101111#"</span></span><br></pre></td></tr></table></figure>

<p>想多了，这是一个迷宫</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*<span class="number">1111</span></span><br><span class="line"><span class="number">01000</span></span><br><span class="line"><span class="number">01010</span></span><br><span class="line"><span class="number">00010</span></span><br><span class="line"><span class="number">1111</span>#</span><br></pre></td></tr></table></figure>

<p>相当于二维数组，v1v2是坐标，1是可以走的，*头#尾。</p>
<h3 id="刮开有奖"><a href="#刮开有奖" class="headerlink" title="刮开有奖"></a>刮开有奖</h3><p>挂不了，生气。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">GetDlgItemTextA(hDlg, <span class="number">1000</span>, &amp;String, <span class="number">0xFFFF</span>);</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;String) == <span class="number">8</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 = <span class="number">90</span>;</span><br><span class="line">        v8 = <span class="number">74</span>;</span><br><span class="line">        v9 = <span class="number">83</span>;</span><br><span class="line">        v10 = <span class="number">69</span>;</span><br><span class="line">        v11 = <span class="number">67</span>;</span><br><span class="line">        v12 = <span class="number">97</span>;</span><br><span class="line">        v13 = <span class="number">78</span>;</span><br><span class="line">        v14 = <span class="number">72</span>;</span><br><span class="line">        v15 = <span class="number">51</span>;</span><br><span class="line">        v16 = <span class="number">110</span>;</span><br><span class="line">        v17 = <span class="number">103</span>;</span><br><span class="line">        sub_4010F0(&amp;v7, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">        <span class="built_in">memset</span>(&amp;v26, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">        v26 = v23;</span><br><span class="line">        v28 = v25;</span><br><span class="line">        v27 = v24;</span><br><span class="line">        v4 = (<span class="keyword">const</span> <span class="keyword">char</span> *)sub_401000(&amp;v26, <span class="built_in">strlen</span>(&amp;v26));</span><br><span class="line">        <span class="built_in">memset</span>(&amp;v26, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">        v27 = v21;</span><br><span class="line">        v26 = v20;</span><br><span class="line">        v28 = v22;</span><br><span class="line">        v5 = (<span class="keyword">const</span> <span class="keyword">char</span> *)sub_401000(&amp;v26, <span class="built_in">strlen</span>(&amp;v26));</span><br><span class="line">        <span class="keyword">if</span> ( String == v7 + <span class="number">34</span></span><br><span class="line">          &amp;&amp; v19 == v11</span><br><span class="line">          &amp;&amp; <span class="number">4</span> * v20 - <span class="number">141</span> == <span class="number">3</span> * v9</span><br><span class="line">          &amp;&amp; v21 / <span class="number">4</span> == <span class="number">2</span> * (v14 / <span class="number">9</span>)</span><br><span class="line">          &amp;&amp; !<span class="built_in">strcmp</span>(v4, <span class="string">"ak1w"</span>)</span><br><span class="line">          &amp;&amp; !<span class="built_in">strcmp</span>(v5, <span class="string">"V1Ax"</span>) )</span><br><span class="line">          MessageBoxA(hDlg, <span class="string">"U g3t 1T!"</span>, <span class="string">"@_@"</span>, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>看看sub_4010F0对v7-v17做了什么</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_4010F0</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// esi@1</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx@2</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// edx@2</span></span><br><span class="line"></span><br><span class="line">  result = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">4</span> * i;</span><br><span class="line">    v6 = *(_DWORD *)(<span class="number">4</span> * i + a1);</span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; *(_DWORD *)(a1 + <span class="number">4</span> * result) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          *(_DWORD *)(v5 + a1) = *(_DWORD *)(a1 + <span class="number">4</span> * result);</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( *(_DWORD *)(a1 + <span class="number">4</span> * i) &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            ++i;</span><br><span class="line">            <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = <span class="number">4</span> * i;</span><br><span class="line">          *(_DWORD *)(a1 + <span class="number">4</span> * result) = *(_DWORD *)(<span class="number">4</span> * i + a1);</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4</span> * result) = v6;</span><br><span class="line">    sub_4010F0(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = a3;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">char</span> *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// esi@1</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx@2</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// edx@2</span></span><br><span class="line"></span><br><span class="line">  result = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">4</span> * i;</span><br><span class="line">    v6 = a1[<span class="number">4</span> * i];</span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; a1[<span class="number">4</span> * result] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          a1[v5] = a1[<span class="number">4</span> * result];</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( a1[<span class="number">4</span> * i] &lt;= v6 )</span><br><span class="line">          &#123;</span><br><span class="line">            ++i;</span><br><span class="line">            <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = <span class="number">4</span> * i;</span><br><span class="line">          a1 [<span class="number">4</span> * result] = a1[<span class="number">4</span> * i];</span><br><span class="line">        &#125;</span><br><span class="line">        --result;</span><br><span class="line">      &#125;<span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">    a1 [<span class="number">4</span> * result] = v6;</span><br><span class="line">    sub(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = a3;</span><br><span class="line">    ++i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> a1[<span class="number">11</span>]=&#123;<span class="number">90</span>,<span class="number">74</span>,<span class="number">83</span>,<span class="number">69</span>,<span class="number">67</span>,<span class="number">97</span>,<span class="number">78</span>,<span class="number">72</span>,<span class="number">51</span>,<span class="number">110</span>,<span class="number">103</span>&#125;;</span><br><span class="line">    sub(a1,<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;a1[i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JSE aNH ng</p>
<p>淦，我的汇编就是一坨屎</p>
<p>去掉4*。</p>
<blockquote>
<p>  淦，我的保存没了。</p>
</blockquote>
<p>string是flag，其中(v4, “ak1w”)(v5, “V1Ax”)是base64结果。</p>
<p>string = “UJWP1jMp”</p>
<h2 id="day4-5-8"><a href="#day4-5-8" class="headerlink" title="day4    5.8"></a>day4    5.8</h2><h3 id="simpleRev"><a href="#simpleRev" class="headerlink" title="simpleRev"></a>simpleRev</h3><p>64位。</p>
<p>48-57:0-9</p>
<p>65-90：A-Z</p>
<p>97-122：a-z</p>
<p>Decry()里</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int64 <span class="title">Decry</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// [sp+Fh] [bp-51h]@19</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [sp+10h] [bp-50h]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v3; <span class="comment">// [sp+14h] [bp-4Ch]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [sp+18h] [bp-48h]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v5; <span class="comment">// [sp+1Ch] [bp-44h]@1</span></span><br><span class="line">  <span class="keyword">char</span> src[<span class="number">8</span>]; <span class="comment">// [sp+20h] [bp-40h]@1</span></span><br><span class="line">  __int64 v7; <span class="comment">// [sp+28h] [bp-38h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [sp+30h] [bp-30h]@1</span></span><br><span class="line">  __int64 v9; <span class="comment">// [sp+40h] [bp-20h]@1</span></span><br><span class="line">  __int64 v10; <span class="comment">// [sp+48h] [bp-18h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [sp+50h] [bp-10h]@1</span></span><br><span class="line">  __int64 v12; <span class="comment">// [sp+58h] [bp-8h]@1</span></span><br><span class="line"></span><br><span class="line">  v12 = *MK_FP(__FS__, <span class="number">40L</span>L);</span><br><span class="line">  *(_QWORD *)src = <span class="number">357761762382L</span>L;</span><br><span class="line">  v7 = <span class="number">0L</span>L;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">512969957736L</span>L;</span><br><span class="line">  v10 = <span class="number">0L</span>L;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  text = join(key3, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v9);</span><br><span class="line">  <span class="built_in">strcpy</span>(key, key1);</span><br><span class="line">  <span class="built_in">strcat</span>(key, src);</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  getchar();</span><br><span class="line">  v5 = <span class="built_in">strlen</span>(key);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( key[v3 % v5] &gt; <span class="number">64</span> &amp;&amp; key[v3 % v5] &lt;= <span class="number">90</span> )</span><br><span class="line">      key[i] = key[v3 % v5] + <span class="number">32</span>;</span><br><span class="line">    ++v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please input your flag:"</span>, src);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = getchar();</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">32</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v1 &lt;= <span class="number">96</span> || v1 &gt; <span class="number">122</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v1 &gt; <span class="number">64</span> &amp;&amp; v1 &lt;= <span class="number">90</span> )</span><br><span class="line">          str2[v2] = (v1 - <span class="number">39</span> - key[v3++ % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        str2[v2] = (v1 - <span class="number">39</span> - key[v3++ % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !(v3 % v5) )</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(text, str2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Congratulation!\n"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Try again!\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> *MK_FP(__FS__, <span class="number">40L</span>L) ^ v12;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> *__<span class="function">fastcall <span class="title">join</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1, <span class="keyword">const</span> <span class="keyword">char</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v2; <span class="comment">// rbx@1</span></span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rax@1</span></span><br><span class="line">  <span class="keyword">char</span> *dest; <span class="comment">// [sp+18h] [bp-18h]@1</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(a2);</span><br><span class="line">  dest = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(v2 + v3 + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !dest )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, a1);</span><br><span class="line">  <span class="built_in">strcat</span>(dest, a2);</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>join就是字符串相连</p>
<p>主要变量：</p>
<p>v9 = 512969957736LL;==hadow</p>
<p>*(_QWORD *)src = 357761762382LL;==NDCLS</p>
<blockquote>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">&gt;       <span class="keyword">long</span> <span class="keyword">long</span> a = <span class="number">512969957736L</span>L;</span><br><span class="line">&gt;       <span class="keyword">char</span> buffer[<span class="number">100</span>];</span><br><span class="line">&gt;       <span class="built_in">sprintf</span>(buffer, <span class="string">"%lld"</span>, a);</span><br><span class="line">&gt;       <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, buffer);</span><br><span class="line">&gt;       <span class="keyword">const</span> <span class="keyword">char</span> *b=(<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;a;</span><br><span class="line">&gt;       <span class="built_in">cout</span>&lt;&lt;b;</span><br><span class="line">&gt;       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt;   </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>text = join(key3, (const char *)&amp;v9);</p>
<p>key3       ; “kills”</p>
<p>key1       ; “ADSFK”</p>
<p>过程：</p>
<p>key=key1+src </p>
<p>//text=killshadow，key=ADSFKNDCLS</p>
<p>key变小写</p>
<p>//keyt=adsfkndcls</p>
<p>str2变换</p>
<p>最后str2=test</p>
<p>str2[v3] = (v2 - 39 - key[v4++ % v6] + 97) % 26 + 97;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">key=<span class="string">"adsfkndcls"</span></span><br><span class="line">text=<span class="string">"killshadow"</span></span><br><span class="line">str2=<span class="string">""</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">print(len(key))</span><br><span class="line">v4 = <span class="number">9</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">65</span>,<span class="number">91</span>):</span><br><span class="line">        zm = chr((j - <span class="number">39</span> - ord(key[(v4+<span class="number">1</span>) % <span class="number">10</span>]) + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">        <span class="keyword">if</span> zm==text[i]:</span><br><span class="line">            flag+=chr(j)</span><br><span class="line">            v4=v4+<span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h3 id="java逆向解密"><a href="#java逆向解密" class="headerlink" title="java逆向解密"></a>java逆向解密</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> defpackage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: Reverse  reason: default package */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Reverse</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.println(<span class="string">"Please input the flag ："</span>);</span><br><span class="line">        String str = s.next();</span><br><span class="line">        System.out.println(<span class="string">"Your input is ："</span>);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">        Encrypt(str.toCharArray());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Encrypt</span><span class="params">(<span class="keyword">char</span>[] arr)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;Integer&gt; Resultlist = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : arr) &#123;</span><br><span class="line">            Resultlist.add(Integer.valueOf((c + <span class="string">'@'</span>) ^ <span class="number">32</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] KEY = &#123;<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>&#125;;</span><br><span class="line">        ArrayList&lt;Integer&gt; KEYList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> valueOf : KEY) &#123;</span><br><span class="line">            KEYList.add(Integer.valueOf(valueOf));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"Result:"</span>);</span><br><span class="line">        <span class="keyword">if</span> (Resultlist.equals(KEYList)) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Congratulations！"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.err.println(<span class="string">"Error！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(flag+@)^32==key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">KEY = [<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>]</span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(KEY)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> (j+ord(<span class="string">'@'</span>))^<span class="number">32</span>==KEY[i]:</span><br><span class="line">            flag+=chr(j)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>芜湖！！！</p>
<h3 id="findit"><a href="#findit" class="headerlink" title="findit"></a>findit</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">ActionBarActivity</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* access modifiers changed from: protected */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView((<span class="keyword">int</span>) R.layout.activity_main);</span><br><span class="line">        <span class="keyword">final</span> EditText edit = (EditText) findViewById(R.id.widget2);</span><br><span class="line">        <span class="keyword">final</span> TextView text = (TextView) findViewById(R.id.widget1);</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">char</span>[] a = &#123;<span class="string">'T'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'s'</span>, <span class="string">'I'</span>, <span class="string">'s'</span>, <span class="string">'T'</span>, <span class="string">'h'</span>, <span class="string">'e'</span>, <span class="string">'F'</span>, <span class="string">'l'</span>, <span class="string">'a'</span>, <span class="string">'g'</span>, <span class="string">'H'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>, <span class="string">'e'</span>&#125;;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">char</span>[] b = &#123;<span class="string">'p'</span>, <span class="string">'v'</span>, <span class="string">'k'</span>, <span class="string">'q'</span>, <span class="string">'&#123;'</span>, <span class="string">'m'</span>, <span class="string">'1'</span>, <span class="string">'6'</span>, <span class="string">'4'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'2'</span>, <span class="string">'6'</span>, <span class="string">'2'</span>, <span class="string">'0'</span>, <span class="string">'3'</span>, <span class="string">'3'</span>, <span class="string">'l'</span>, <span class="string">'4'</span>, <span class="string">'m'</span>, <span class="string">'4'</span>, <span class="string">'9'</span>, <span class="string">'l'</span>, <span class="string">'n'</span>, <span class="string">'p'</span>, <span class="string">'7'</span>, <span class="string">'p'</span>, <span class="string">'9'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'k'</span>, <span class="string">'2'</span>, <span class="string">'8'</span>, <span class="string">'k'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'&#125;'</span>&#125;;</span><br><span class="line">        ((Button) findViewById(R.id.widget3)).setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">char</span>[] x = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">17</span>];</span><br><span class="line">                <span class="keyword">char</span>[] y = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">38</span>];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((a[i] &lt; <span class="string">'I'</span> &amp;&amp; a[i] &gt;= <span class="string">'A'</span>) || (a[i] &lt; <span class="string">'i'</span> &amp;&amp; a[i] &gt;= <span class="string">'a'</span>)) &#123;</span><br><span class="line">                        x[i] = (<span class="keyword">char</span>) (a[i] + <span class="number">18</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((a[i] &lt; <span class="string">'A'</span> || a[i] &gt; <span class="string">'Z'</span>) &amp;&amp; (a[i] &lt; <span class="string">'a'</span> || a[i] &gt; <span class="string">'z'</span>)) &#123;</span><br><span class="line">                        x[i] = a[i];</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        x[i] = (<span class="keyword">char</span>) (a[i] - <span class="number">8</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (String.valueOf(x).equals(edit.getText().toString())) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i2 = <span class="number">0</span>; i2 &lt; <span class="number">38</span>; i2++) &#123;</span><br><span class="line">                        <span class="keyword">if</span> ((b[i2] &lt; <span class="string">'A'</span> || b[i2] &gt; <span class="string">'Z'</span>) &amp;&amp; (b[i2] &lt; <span class="string">'a'</span> || b[i2] &gt; <span class="string">'z'</span>)) &#123;</span><br><span class="line">                            y[i2] = b[i2];</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            y[i2] = (<span class="keyword">char</span>) (b[i2] + <span class="number">16</span>);</span><br><span class="line">                            <span class="keyword">if</span> ((y[i2] &gt; <span class="string">'Z'</span> &amp;&amp; y[i2] &lt; <span class="string">'a'</span>) || y[i2] &gt;= <span class="string">'z'</span>) &#123;</span><br><span class="line">                                y[i2] = (<span class="keyword">char</span>) (y[i2] - <span class="number">26</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    text.setText(String.valueOf(y));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                text.setText(<span class="string">"答案错了肿么办。。。不给你又不好意思。。。哎呀好纠结啊~~~"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (item.getItemId() == R.id.action_settings) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>b变y，y是flag</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i2 = <span class="number">0</span>; i2 &lt; <span class="number">38</span>; i2++) &#123;</span><br><span class="line">	<span class="keyword">if</span> ((b[i2] &lt; <span class="string">'A'</span> || b[i2] &gt; <span class="string">'Z'</span>) &amp;&amp; (b[i2] &lt; <span class="string">'a'</span> || b[i2] &gt; <span class="string">'z'</span>)) &#123;</span><br><span class="line">		y[i2] = b[i2];</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		y[i2] = (<span class="keyword">char</span>) (b[i2] + <span class="number">16</span>);</span><br><span class="line">		<span class="keyword">if</span> ((y[i2] &gt; <span class="string">'Z'</span> &amp;&amp; y[i2] &lt; <span class="string">'a'</span>) || y[i2] &gt;= <span class="string">'z'</span>) &#123;</span><br><span class="line">			y[i2] = (<span class="keyword">char</span>) (y[i2] - <span class="number">26</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>凯撒，16位。我不管，爆破</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-08_20-38-41.png" alt></p>
<p>pvkq{m164675262033l4m49lnp7p9mnk28k75}</p>
<h3 id="8086"><a href="#8086" class="headerlink" title="8086"></a>8086</h3><p>迷~~</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db <span class="number">0</span>B9h, <span class="number">22</span>h, <span class="number">0</span>, <span class="number">8</span>Dh, <span class="number">1</span>Eh, <span class="number">2</span> dup(<span class="number">0</span>), <span class="number">8</span>Bh, <span class="number">0</span>F9h, <span class="number">4</span>Fh, <span class="number">80</span>h</span><br><span class="line">db <span class="number">31</span>h, <span class="number">1</span>Fh, <span class="number">0E2</span>h, <span class="number">0</span>F8h, <span class="number">8</span>Dh, <span class="number">16</span>h, <span class="number">2</span> dup(<span class="number">0</span>), <span class="number">0</span>B4h, <span class="number">9</span>, <span class="number">0</span>CDh</span><br><span class="line">db <span class="number">21</span>h, <span class="number">0</span>C3h</span><br></pre></td></tr></table></figure>

<p>c强制转换代码</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span>     <span class="built_in">cx</span>, <span class="number">22h</span> <span class="comment">; '"'</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">bx</span>, aUDuT@Z@wj__Q@g <span class="comment">; "]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~/b;"</span></span><br><span class="line"><span class="symbol">loc_10039:</span>                              <span class="comment">; CODE XREF: seg001:000Fj</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">di</span>, <span class="built_in">cx</span></span><br><span class="line"><span class="keyword">dec</span>     <span class="built_in">di</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">bx</span>+<span class="built_in">di</span>], <span class="number">1Fh</span></span><br><span class="line"><span class="keyword">loop</span>    loc_10039</span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">dx</span>, aUDuT@Z@wj__Q@g <span class="comment">; "]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~/b;"</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">9</span></span><br><span class="line"><span class="keyword">int</span>     <span class="number">21h</span>             <span class="comment">; DOS - PRINT STRING; DS:DX -&gt; string terminated by "$"</span></span><br><span class="line"><span class="keyword">retn</span></span><br></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">xor</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">bx</span>+<span class="built_in">di</span>], <span class="number">1Fh</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">"]U[du~|t@&#123;z@wj.&#125;.~q@gjz&#123;z@wzqW~/b;"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line">b=<span class="number">0x1f</span></span><br><span class="line">print(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    flag+=chr(ord(a[i])^b)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><p>public key：MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMAzLFxkrkcYL2wch21CM2kQVFpY9+7+./AvKr1rzQczdAgMBAAE=</p>
<p><a href="http://tool.chacuo.net/cryptrsakeyparse" target="_blank" rel="noopener">http://tool.chacuo.net/cryptrsakeyparse</a></p>
<table>
<thead>
<tr>
<th>key长度：</th>
<th>256</th>
</tr>
</thead>
<tbody><tr>
<td>模数：</td>
<td>C0332C5C64AE47182F6C1C876D42336910545A58F7EEFEFC0BCAAF5AF341CCDD</td>
</tr>
<tr>
<td>指数：</td>
<td>65537 (0x10001)</td>
</tr>
</tbody></table>
<p>86934482296048119190666062003494800588905656017203025617216654058378322103517</p>
<p>p=285960468890451637935629440372639283459</p>
<p>q=304008741604601924494328155975272418463</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -pubin -text -modulus -<span class="keyword">in</span> pub.txt</span><br><span class="line">python2 rsatool<span class="selector-class">.py</span> -o private<span class="selector-class">.pem</span> -e <span class="number">65537</span> -<span class="selector-tag">p</span> <span class="number">285960468890451637935629440372639283459</span> -<span class="selector-tag">q</span> <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> flag<span class="selector-class">.enc</span> -inkey private.pem</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">arsa=RSA.generate(<span class="number">1024</span>)</span><br><span class="line">arsa.p=</span><br><span class="line">arsa.q=</span><br><span class="line">arsa.e=</span><br><span class="line">arsa.n=arsa.p*arsa.q</span><br><span class="line">Fn=long((arsa.p<span class="number">-1</span>)*(arsa.q<span class="number">-1</span>))</span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    x=(Fn*i)+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(x%arsa.e==<span class="number">0</span>):</span><br><span class="line">           arsa.d=x/arsa.e</span><br><span class="line">           <span class="keyword">break</span></span><br><span class="line">    i=i+<span class="number">1</span></span><br><span class="line">private=open(<span class="string">'private.pem'</span>,<span class="string">'w'</span>)</span><br><span class="line">private.write(arsa.exportKey())</span><br><span class="line">private.close()</span><br></pre></td></tr></table></figure>

<h2 id="day5-5-9"><a href="#day5-5-9" class="headerlink" title="day5    5.9"></a>day5    5.9</h2><h3 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h3><p>32位</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"pls input the first passwd(1): "</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;pbData);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pbData) != <span class="number">6</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Must be 6 characters!\n"</span>);</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>pw6位</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v<span class="number">5</span> = u<span class="symbol">nknown_libname_1</span><span class="comment">((char *)</span>&amp;pbData);</span><br><span class="line">  <span class="keyword">if</span> <span class="comment">( v5 &lt; 100000 )</span></span><br><span class="line">    ExitProcess<span class="comment">(0)</span>;</span><br><span class="line">  strcat<span class="comment">((char *)</span>&amp;pbData, <span class="string">"@DBApp"</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__int32 __cdecl unknown_libname_1(<span class="keyword">char</span> *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">return</span> <span class="title">atol</span><span class="params">(a1)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>pw&gt;100000</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcat</span>((<span class="keyword">char</span> *)&amp;pbData, <span class="string">"@DBApp"</span>);</span><br><span class="line">v0 = <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pbData);</span><br></pre></td></tr></table></figure>

<p>pbData=pw+”@DBApp”</p>
<p>v0=12</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_40100A(&amp;pbData, v0, &amp;String1);</span><br></pre></td></tr></table></figure>

<p>好像hash</p>
<p>去搜CryptCreateHash</p>
<p><a href="#https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptcreatehash">CryptCreateHash:ALG_ID</a></p>
<p>sha1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">data=<span class="string">"@DBApp"</span></span><br><span class="line">a=<span class="string">"6E32D0943418C2C33385BC35A1470250DD8923A9"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>,<span class="number">1000000</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    flag=str(i)+data</span><br><span class="line">    sha1 = (hashlib.sha1(flag).hexdigest()).upper()</span><br><span class="line">    <span class="keyword">if</span> sha1==a:</span><br><span class="line">        print(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>跑了好久。。。。</p>
<p>pw=123321@DBApp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !_strcmpi(&amp;String1, <span class="string">"6E32D0943418C2C33385BC35A1470250DD8923A9"</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"continue...\n\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"pls input the first passwd(2): "</span>);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;String, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;String);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;String) != <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Must be 6 characters!\n"</span>);</span><br><span class="line">      ExitProcess(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">strcat</span>(&amp;String, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pbData);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;String1, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">    v1 = <span class="built_in">strlen</span>(&amp;String);</span><br><span class="line">    sub_401019((BYTE *)&amp;String, v1, &amp;String1);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">"27019e688a4e62a649fd99cadaafdb4e"</span>, &amp;String1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> __int8)sub_40100F(&amp;String) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Error!!\n"</span>);</span><br><span class="line">        ExitProcess(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"bye ~~\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcat</span>(&amp;String, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;pbData);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;String1, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">    v1 = <span class="built_in">strlen</span>(&amp;String);</span><br><span class="line">    sub_401019((BYTE *)&amp;String, v1, &amp;String1);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">"27019e688a4e62a649fd99cadaafdb4e"</span>, &amp;String1) )</span><br></pre></td></tr></table></figure>

<p>string=pw2+”123321@DBApp”</p>
<p>CryptCreateHash里0x8003u是MD5，查不到。</p>
<p>会不会还是数字，爆破数字。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">data=<span class="string">"123321@DBApp"</span></span><br><span class="line">a=<span class="string">"27019e688a4e62a649fd99cadaafdb4e"</span></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>,<span class="number">1000000</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    flag=str(i)+data</span><br><span class="line">    md5.update(flag)</span><br><span class="line">    <span class="keyword">if</span> md5==a:</span><br><span class="line">        print(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>无</p>
<p>看后面吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">hResInfo = FindResourceA(<span class="number">0</span>, (LPCSTR)<span class="number">0x65</span>, <span class="string">"AAA"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( hResInfo )</span><br><span class="line">  &#123;</span><br><span class="line">    nNumberOfBytesToWrite = SizeofResource(<span class="number">0</span>, hResInfo);</span><br><span class="line">    hResData = LoadResource(<span class="number">0</span>, hResInfo);</span><br><span class="line">    <span class="keyword">if</span> ( hResData )</span><br><span class="line">    &#123;</span><br><span class="line">      lpBuffer = LockResource(hResData);</span><br><span class="line">      sub_401005(lpString, (<span class="keyword">int</span>)lpBuffer, nNumberOfBytesToWrite);</span><br><span class="line">      hFile = CreateFileA(<span class="string">"dbapp.rtf"</span>, <span class="number">0x10000000</span>u, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2u</span>, <span class="number">0x80</span>u, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>到这里，</p>
<p>sub_401019((BYTE *)&amp;String, v1, &amp;String1);</p>
<p>函数sub_401040(BYTE *pbData, DWORD dwDataLen, LPSTR lpString1)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(&amp;v4, <span class="number">0xCC</span>u, <span class="number">0x4C</span>u);</span><br><span class="line"> v7 = lstrlenA(lpString);</span><br><span class="line"> v6 = lpString;</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   result = i;</span><br><span class="line">   <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">   *(_BYTE *)(i + a2) ^= v6[i % v7];</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>发现lpString进行了异或，a2为lpString首地址。</p>
<p>AAA是啥？我受不了了了，看wp。</p>
<p>{\rtf1\ansi\</p>
<p>。。。。。。。。。。。就这样吧，累了</p>
<h2 id="day6-5-10"><a href="#day6-5-10" class="headerlink" title="day6    5.10"></a>day6    5.10</h2><h3 id="注册器"><a href="#注册器" class="headerlink" title="注册器"></a>注册器</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">char[] x = <span class="string">"dd2940c04462b4dd7c450528835cca15"</span>.toCharArray();</span><br><span class="line">                    x[<span class="number">2</span>] = (char) ((x[<span class="number">2</span>] + x[<span class="number">3</span>]) - <span class="number">50</span>);</span><br><span class="line">                    x[<span class="number">4</span>] = (char) ((x[<span class="number">2</span>] + x[<span class="number">5</span>]) - <span class="number">48</span>);</span><br><span class="line">                    x[<span class="number">30</span>] = (char) ((x[<span class="number">31</span>] + x[<span class="number">9</span>]) - <span class="number">48</span>);</span><br><span class="line">                    x[<span class="number">14</span>] = (char) ((x[<span class="number">27</span>] + x[<span class="number">28</span>]) - <span class="number">97</span>);</span><br><span class="line">                    for (int i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">                        char a = x[<span class="number">31</span> - i];</span><br><span class="line">                        x[<span class="number">31</span> - i] = x[i];</span><br><span class="line">                        x[i] = a;</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="string">"dd2940c04462b4dd7c450528835cca15"</span></span><br><span class="line">b=list(x)</span><br><span class="line">print(b)</span><br><span class="line">b[<span class="number">2</span>] = chr((ord(b[<span class="number">2</span>]) + ord(b[<span class="number">3</span>])) - <span class="number">50</span>)</span><br><span class="line">b[<span class="number">4</span>] = chr((ord(b[<span class="number">2</span>]) + ord(b[<span class="number">5</span>])) - <span class="number">48</span>)</span><br><span class="line">b[<span class="number">30</span>] = chr((ord(b[<span class="number">31</span>]) + ord(b[<span class="number">9</span>])) - <span class="number">48</span>)</span><br><span class="line">b[<span class="number">14</span>] = chr((ord(b[<span class="number">27</span>]) + ord(b[<span class="number">28</span>])) - <span class="number">97</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        a = b[<span class="number">31</span> - i];</span><br><span class="line">        b[<span class="number">31</span> - i] = b[i];</span><br><span class="line">        b[i] = a;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">''</span>.join(b))</span><br></pre></td></tr></table></figure>

<h3 id="luck-guy"><a href="#luck-guy" class="headerlink" title="luck_guy"></a>luck_guy</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">patch_me</span><span class="params">(<span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@2</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( ((((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">unsigned</span> __int64)a1 &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">31</span>) + (_BYTE)a1) &amp; <span class="number">1</span>)</span><br><span class="line">     - ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">unsigned</span> __int64)a1 &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">31</span>) == <span class="number">1</span> )</span><br><span class="line">    result = <span class="built_in">puts</span>(<span class="string">"just finished"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = get_flag();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>a1最后一位为0</p>
<p>flag=f1+f2</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400845</span> loc_400845:                             <span class="comment">; DATA XREF: .rodata:0000000000400BC8o</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400845</span>                 <span class="keyword">mov</span>     <span class="built_in">edi</span>, offset aOkItSFlag <span class="comment">; "OK, it's flag:"</span></span><br><span class="line"><span class="symbol">.text:</span>000000000040084A                 <span class="keyword">call</span>    _puts</span><br><span class="line"><span class="symbol">.text:</span>000000000040084F                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400853</span>                 <span class="keyword">mov</span>     <span class="built_in">edx</span>, <span class="number">28h</span>        <span class="comment">; n</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400858</span>                 <span class="keyword">mov</span>     <span class="built_in">esi</span>, <span class="number">0</span>          <span class="comment">; c</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">000000000040085D</span>                 <span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span>        <span class="comment">; s</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400860</span>                 <span class="keyword">call</span>    _memset</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400865</span>                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400869</span>                 <span class="keyword">mov</span>     <span class="built_in">esi</span>, offset f1  <span class="comment">; "GXY&#123;do_not_"</span></span><br><span class="line"><span class="symbol">.text:</span>000000000040086E                 <span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span>        <span class="comment">; dest</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400871</span>                 <span class="keyword">call</span>    _strcat</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400876</span>                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span>000000000040087A                 <span class="keyword">mov</span>     <span class="built_in">esi</span>, offset f2  <span class="comment">; src</span></span><br><span class="line"><span class="symbol">.text:</span>000000000040087F                 <span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span>        <span class="comment">; dest</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400882</span>                 <span class="keyword">call</span>    _strcat</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400887</span>                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span>000000000040088B                 <span class="keyword">mov</span>     <span class="built_in">rsi</span>, <span class="built_in">rax</span></span><br><span class="line"><span class="symbol">.text:</span>000000000040088E                 <span class="keyword">mov</span>     <span class="built_in">edi</span>, offset format <span class="comment">; "%s"</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400893</span>                 <span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="number">0</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400898</span>                 <span class="keyword">call</span>    _printf</span><br><span class="line"><span class="symbol">.text:</span><span class="number">000000000040089D</span>                 <span class="keyword">jmp</span>     loc_400975</span><br></pre></td></tr></table></figure>

<p>f2=i c u g ` o f </p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text:</span>00000000004008CA loc_4008CA:                             <span class="comment">; DATA XREF: .rodata:0000000000400BE0o</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008CA                 <span class="keyword">mov</span>     [<span class="built_in">rbp</span>+s], <span class="number">0</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008D2                 <span class="keyword">mov</span>     [<span class="built_in">rbp</span>+var_28], <span class="number">0</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008D6                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s], <span class="number">69h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008DA                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">1</span>], <span class="number">63h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008DE                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">2</span>], <span class="number">75h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008E2                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">3</span>], <span class="number">67h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008E6                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">4</span>], <span class="number">60h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008EA                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">5</span>], <span class="number">6Fh</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008EE                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">6</span>], <span class="number">66h</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008F2                 <span class="keyword">mov</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+s+<span class="number">7</span>], <span class="number">7Fh</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008F6                 <span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+s]</span><br><span class="line"><span class="symbol">.text:</span>00000000004008FA                 <span class="keyword">mov</span>     <span class="built_in">rsi</span>, <span class="built_in">rax</span>        <span class="comment">; src</span></span><br><span class="line"><span class="symbol">.text:</span>00000000004008FD                 <span class="keyword">mov</span>     <span class="built_in">edi</span>, offset f2  <span class="comment">; dest</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400902</span>                 <span class="keyword">call</span>    _strcat</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0000000000400907</span>                 <span class="keyword">jmp</span>     short loc_400975</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400963</span> <span class="selector-tag">loc_400963</span>:                             ; <span class="selector-tag">CODE</span> <span class="selector-tag">XREF</span>: <span class="selector-tag">get_flag</span>+145<span class="selector-tag">j</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400963</span>                 <span class="selector-tag">cmp</span>     <span class="selector-attr">[rbp+var_38]</span>, 7</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400967</span>                 <span class="selector-tag">jle</span>     <span class="selector-tag">short</span> <span class="selector-tag">loc_400912</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400969</span>                 <span class="selector-tag">jmp</span>     <span class="selector-tag">short</span> <span class="selector-tag">loc_400975</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400912</span> <span class="selector-tag">loc_400912</span>:                             ; <span class="selector-tag">CODE</span> <span class="selector-tag">XREF</span>: <span class="selector-tag">get_flag</span>+19<span class="selector-tag">C</span><span class="selector-tag">j</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400912</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">eax</span>, <span class="selector-attr">[rbp+var_38]</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400915</span>                 <span class="selector-tag">cdq</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400916</span>                 <span class="selector-tag">shr</span>     <span class="selector-tag">edx</span>, 1<span class="selector-tag">Fh</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400919</span>                 <span class="selector-tag">add</span>     <span class="selector-tag">eax</span>, <span class="selector-tag">edx</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:000000000040091B</span>                 <span class="selector-tag">and</span>     <span class="selector-tag">eax</span>, 1</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:000000000040091E</span>                 <span class="selector-tag">sub</span>     <span class="selector-tag">eax</span>, <span class="selector-tag">edx</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400920</span>                 <span class="selector-tag">cmp</span>     <span class="selector-tag">eax</span>, 1</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400923</span>                 <span class="selector-tag">jnz</span>     <span class="selector-tag">short</span> <span class="selector-tag">loc_400943</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400925</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">eax</span>, <span class="selector-attr">[rbp+var_38]</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400928</span>                 <span class="selector-tag">cdqe</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:000000000040092A</span>                 <span class="selector-tag">movzx</span>   <span class="selector-tag">eax</span>, <span class="selector-tag">ds</span><span class="selector-pseudo">:f2</span><span class="selector-attr">[rax]</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400931</span>                 <span class="selector-tag">sub</span>     <span class="selector-tag">eax</span>, 2</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400934</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">edx</span>, <span class="selector-tag">eax</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400936</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">eax</span>, <span class="selector-attr">[rbp+var_38]</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400939</span>                 <span class="selector-tag">cdqe</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:000000000040093B</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">ds</span><span class="selector-pseudo">:f2</span><span class="selector-attr">[rax]</span>, <span class="selector-tag">dl</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0000000000400941</span>                 <span class="selector-tag">jmp</span>     <span class="selector-tag">short</span> <span class="selector-tag">loc_40095F</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>  CDQ 是一个让很多人感到困惑的指令。  这个指令把 EAX 的第 31 bit 复制到 EDX 的每一个 bit 上。 它大多出现在除法运算之前。它实际的作用只是把EDX的所有位都设成EAX最高位的值。也就是说，当EAX &lt;80000000, EDX 为00000000；当EAX &gt;= 80000000， EDX 则为FFFFFFFF。</p>
</blockquote>
<p>我的f5和wp不一样，只能看汇编。头疼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">f2=[<span class="number">0x69</span>,<span class="number">0x63</span>,<span class="number">0x75</span>,<span class="number">0x67</span>,<span class="number">0x60</span>,<span class="number">0x6f</span>,<span class="number">0x66</span>,<span class="number">0x7f</span>]</span><br><span class="line">flag = <span class="string">'GXY&#123;do_not_'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> ( j % <span class="number">2</span> == <span class="number">1</span> ):</span><br><span class="line">        flag+= chr(f2[j] - <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+= chr(f2[j] <span class="number">-1</span>)</span><br><span class="line">    </span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h3 id="younger-drive"><a href="#younger-drive" class="headerlink" title="younger_drive"></a>younger_drive</h3><p>脱壳，32位。</p>
<p>v0是printf返回值，为1008</p>
<p>sub_41116D(&amp;v5 == &amp;v5, v0);</p>
<p>没看出什么</p>
<p>v1=12</p>
<p>v2=flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __usercall sub_411E30@&lt;eax&gt;(<span class="keyword">char</span> a1@&lt;zf&gt;, <span class="keyword">int</span> result@&lt;eax&gt;)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// ST18_4@2</span></span><br><span class="line">  <span class="keyword">int</span> _0; <span class="comment">// [sp+0h] [bp+0h]@2</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = result;</span><br><span class="line">    sub_4111F9(_0, <span class="number">0</span>);</span><br><span class="line">    result = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/ajiannet/archive/2007/04/20/721679.html" target="_blank" rel="noopener">堆栈平衡看看</a></p>
<h2 id="day7-5-11"><a href="#day7-5-11" class="headerlink" title="day7    5.11"></a>day7    5.11</h2><h3 id="pyre"><a href="#pyre" class="headerlink" title="pyre"></a>pyre</h3><blockquote>
<p>  pyc文件是python编译后的字节码文件。<br>  在python中，输入一个模块相对来说是一个比较费时的事情，所以Python做了一些技巧，以便使输入模块更加快一些。一种方法是创建字节编译的文件，这些文件以.pyc作为扩展名。<br>  当你在下次从别的程序输入这个模块的时候，.pyc文件是十分有用的——它会快得多，因为一部分输入模块所需的处理已经完成了。<br>  在你import别的py文件时(也就是模块)，那个py文件会被存一份pyc文件以加速下次装载。而主文件因为只需要装载一次就没有存pyc。</p>
</blockquote>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-11_17-10-58.png" alt></p>
<p><a href="https://tool.lu/pyc/" target="_blank" rel="noopener">https://tool.lu/pyc/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">'Welcome to Re World!'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Your input1 is your flag~'</span></span><br><span class="line">l = len(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> code</span><br><span class="line">code = [</span><br><span class="line">    <span class="string">'\x1f'</span>,</span><br><span class="line">    <span class="string">'\x12'</span>,</span><br><span class="line">    <span class="string">'\x1d'</span>,</span><br><span class="line">    <span class="string">'('</span>,</span><br><span class="line">    <span class="string">'0'</span>,</span><br><span class="line">    <span class="string">'4'</span>,</span><br><span class="line">    <span class="string">'\x01'</span>,</span><br><span class="line">    <span class="string">'\x06'</span>,</span><br><span class="line">    <span class="string">'\x14'</span>,</span><br><span class="line">    <span class="string">'4'</span>,</span><br><span class="line">    <span class="string">','</span>,</span><br><span class="line">    <span class="string">'\x1b'</span>,</span><br><span class="line">    <span class="string">'U'</span>,</span><br><span class="line">    <span class="string">'?'</span>,</span><br><span class="line">    <span class="string">'o'</span>,</span><br><span class="line">    <span class="string">'6'</span>,</span><br><span class="line">    <span class="string">'*'</span>,</span><br><span class="line">    <span class="string">':'</span>,</span><br><span class="line">    <span class="string">'\x01'</span>,</span><br><span class="line">    <span class="string">'D'</span>,</span><br><span class="line">    <span class="string">';'</span>,</span><br><span class="line">    <span class="string">'%'</span>,</span><br><span class="line">    <span class="string">'\x13'</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">input1=<span class="string">''</span></span><br><span class="line">code = [<span class="string">'\x1f'</span>, <span class="string">'\x12'</span>, <span class="string">'\x1d'</span>, <span class="string">'('</span>, <span class="string">'0'</span>, <span class="string">'4'</span>, <span class="string">'\x01'</span>, <span class="string">'\x06'</span>, <span class="string">'\x14'</span>, <span class="string">'4'</span>, <span class="string">','</span>, <span class="string">'\x1b'</span>, <span class="string">'U'</span>, <span class="string">'?'</span>, <span class="string">'o'</span>, <span class="string">'6'</span>, <span class="string">'*'</span>, <span class="string">':'</span>, <span class="string">'\x01'</span>, <span class="string">'D'</span>, <span class="string">';'</span>, <span class="string">'%'</span>, <span class="string">'\x13'</span>]</span><br><span class="line">I=len(code)</span><br><span class="line">print(ord(code[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(I<span class="number">-2</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">    code[i]=chr(ord(code[i])^ord(code[i+<span class="number">1</span>]))</span><br><span class="line">print(code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(I):</span><br><span class="line">    input1+=chr( (ord(code[i])-i)%<span class="number">128</span> )</span><br><span class="line">print(input1)</span><br></pre></td></tr></table></figure>

<h3 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h3><p>jadx打开。搜.com，有点弱智。</p>
<p>搜mail，有一个sendMailByJavaMail</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">m.set_host(C2.MAILHOST);</span><br><span class="line">m.set_port(C2.PORT);</span><br><span class="line">m.set_debuggable(<span class="keyword">true</span>);</span><br><span class="line">m.set_to(<span class="keyword">new</span> String[]&#123;mailto&#125;);</span><br><span class="line">m.set_from(C2.MAILFROME);</span><br><span class="line">m.set_subject(title);</span><br><span class="line">m.setBody(mailmsg);</span><br></pre></td></tr></table></figure>

<p>去c2看看</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CANCELNUMBER = <span class="string">"%23%2321%23"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILFROME = Base64.decode(NativeMethod.m());</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILHOST = <span class="string">"smtp.163.com"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILPASS = Base64.decode(NativeMethod.pwd());</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILSERVER = Base64.decode(NativeMethod.m());</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MAILUSER = Base64.decode(NativeMethod.m());</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MOVENUMBER = <span class="string">"**21*121%23"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String PORT = <span class="string">"25"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String date = <span class="string">"2115-11-1"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String phoneNumber = Base64.decode(NativeMethod.p());</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.net.cn;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NativeMethod</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">m</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">p</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">pwd</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不知道这是什么。</p>
<blockquote>
<p>  一个Native Method就是一个Java调用非java代码的接口</p>
<p>  “A native method is a Java method whose implementation is provided by non-java code.”</p>
</blockquote>
<p>wp：Java中NativeMethod一般用于调用外部文件，再用IDA打libcore.so</p>
<h3 id="easyRE"><a href="#easyRE" class="headerlink" title="easyRE"></a>easyRE</h3><p>在sub_4009C6()里有</p>
<p>char v57[36]</p>
<p>if ( (unsigned __int8)(v57[i] ^ i) != *(&amp;v21 + i) </p>
<p>写个代码看看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">b=a.replace(<span class="string">' '</span>,<span class="string">''</span>)</span><br><span class="line">c=b.replace(<span class="string">'\n'</span>,<span class="string">''</span>)</span><br><span class="line"><span class="comment">#c='v21=73;v22=111;v23=100;v24=108;v25=62;v26=81;v27=110;v28=98;v29=40;v30=111;v31=99;v32=121;v33=127;v34=121;v35=46;v36=105;v37=127;v38=100;v39=96;v40=51;v41=119;v42=125;v43=119;v44=101;v45=107;v46=57;v47=123;v48=105;v49=121;v50=61;v51=126;v52=121;v53=76;v54=64;v55=69;v56=67'</span></span><br><span class="line">fin=re.sub(<span class="string">r'v..='</span>, <span class="string">""</span>, c)</span><br><span class="line">num=fin.split(<span class="string">';'</span>)</span><br><span class="line">print(num)</span><br><span class="line">I=len(num)</span><br><span class="line">s=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(I):</span><br><span class="line">    s+=chr(int(num[i])^i)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<p>Info:The first four chars are <code>flag</code></p>
<p>sub_400E44是base64</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v9 == <span class="number">39</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v10 = sub_400E44((<span class="keyword">const</span> __m128i *)&amp;v59);</span><br><span class="line">  v11 = sub_400E44((<span class="keyword">const</span> __m128i *)v10);</span><br><span class="line">  v12 = sub_400E44((<span class="keyword">const</span> __m128i *)v11);</span><br><span class="line">  v13 = sub_400E44((<span class="keyword">const</span> __m128i *)v12);</span><br><span class="line">  v14 = sub_400E44((<span class="keyword">const</span> __m128i *)v13);</span><br><span class="line">  v15 = sub_400E44((<span class="keyword">const</span> __m128i *)v14);</span><br><span class="line">  v16 = sub_400E44((<span class="keyword">const</span> __m128i *)v15);</span><br><span class="line">  v17 = sub_400E44((<span class="keyword">const</span> __m128i *)v16);</span><br><span class="line">  v18 = sub_400E44((<span class="keyword">const</span> __m128i *)v17);</span><br><span class="line">  v19 = sub_400E44((<span class="keyword">const</span> __m128i *)v18);</span><br><span class="line">  v2 = off_6CC090;</span><br><span class="line">  v3 = (<span class="keyword">char</span> *)v19;</span><br><span class="line">  <span class="keyword">if</span> ( !sub_400360(v19, off_6CC090) )</span><br></pre></td></tr></table></figure>

<p>10次，最后和off_6CC090比：</p>
<blockquote>
<p>  Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==</p>
</blockquote>
<p><a href="https://bbs.pediy.com/thread-254172.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-254172.htm</a></p>
<p>毛线啊神经病</p>
<p>不知道该怎么下手，看wp</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A0 byte_6CC0A0     db 40h                  ; <span class="type">DATA</span> <span class="type">XREF</span>: sub_400D35+95r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A0                                         ; sub_400D35+<span class="type">C1</span>r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A1                 db  35h ; 5</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A2                 db  20h</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A3 byte_6CC0A3     db 56h                  ; <span class="type">DATA</span> <span class="type">XREF</span>: sub_400D35+<span class="type">A6</span>r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A4                 db  5Dh ; ]</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A5                 db  18h</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A6                 db  22h ; "</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A7                 db  45h ; <span class="type">E</span></span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A8                 db  17h</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0A9                 db  2Fh ; /</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AA                 db  24h ; $</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AB                 db  6Eh ; n</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AC                 db  62h ; b</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AD                 db  3Ch ; &lt;</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AE                 db  27h ; '</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0AF                 db  54h ; <span class="type">T</span></span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B0                 db  48h ; <span class="type">H</span></span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B1                 db  6Ch ; l</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B2                 db  24h ; $</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B3                 db  6Eh ; n</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B4                 db  72h ; r</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B5                 db  3Ch ; &lt;</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B6                 db  32h ; 2</span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B7                 db  45h ; <span class="type">E</span></span></span><br><span class="line">.<span class="class"><span class="keyword">data</span>:00000000006CC0B8                 db  5Bh ; [</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">v7 = v4;</span><br><span class="line">v9 = BYTE3(v4);</span><br><span class="line"><span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> __int8)v4 ^ byte_6CC0A0[<span class="number">0</span>]) == <span class="number">102</span> &amp;&amp; (v9 ^ (<span class="keyword">unsigned</span> __int8)byte_6CC0A3) == <span class="number">103</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">24</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = (<span class="keyword">unsigned</span> __int8)(byte_6CC0A0[(<span class="keyword">signed</span> __int64)j] ^ *((_BYTE *)&amp;v7</span><br><span class="line">                                                              + (<span class="keyword">signed</span> <span class="keyword">int</span>)(((((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">unsigned</span> __int64)j &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">30</span>)</span><br><span class="line">                                                                             + (_BYTE)j) &amp; <span class="number">3</span>)</span><br><span class="line">                                                                           - ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">unsigned</span> __int64)j &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">30</span>))));</span><br><span class="line">      sub_410E90(v2);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>102是f，103是g。byte_6CC0A0应该是flag，先把v7解出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">''</span></span><br><span class="line">enc1 = <span class="string">'flag'</span></span><br><span class="line">dec = <span class="string">''</span></span><br><span class="line">enc = [<span class="number">0x40</span>,<span class="number">0x35</span>,<span class="number">0x20</span>,<span class="number">0x56</span>,<span class="number">0x5D</span>,<span class="number">0x18</span>,<span class="number">0x22</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x2F</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x62</span>,<span class="number">0x3C</span>,<span class="number">0x27</span>,<span class="number">0x54</span>,<span class="number">0x48</span>,<span class="number">0x6C</span>,<span class="number">0x24</span>,<span class="number">0x6E</span>,<span class="number">0x72</span>,<span class="number">0x3C</span>,<span class="number">0x32</span>,<span class="number">0x45</span>,<span class="number">0x5B</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    key += chr(enc[i] ^ ord(enc1[i]))</span><br><span class="line"><span class="keyword">print</span> (key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    dec += chr(enc[i] ^ ord(key[i%<span class="number">4</span>]))</span><br><span class="line">print(dec)</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/Mayfly-nymph/p/11869959.html" target="_blank" rel="noopener">https://www.cnblogs.com/Mayfly-nymph/p/11869959.html</a></p>
<p>脱壳</p>
<p>shift+f12字符串表</p>
<p>alt+t搜索字符串</p>
<p>f5伪代码</p>
<p>c强制转换代码</p>
<p>写py</p>
<h2 id="day8-5-12"><a href="#day8-5-12" class="headerlink" title="day8   5.12"></a>day8   5.12</h2><h3 id="singin"><a href="#singin" class="headerlink" title="singin"></a>singin</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">v8 = *MK_FP(__FS__, <span class="number">40L</span>L);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"[sign in]"</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"[input your flag]: "</span>);</span><br><span class="line">__isoc99_scanf(<span class="string">"%99s"</span>, &amp;v6);</span><br><span class="line">sub_96A(&amp;v6, &amp;v7);</span><br><span class="line">__gmpz_init_set_str(&amp;v5, <span class="string">"ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35"</span>, <span class="number">16L</span>L);</span><br><span class="line">__gmpz_init_set_str(&amp;v4, &amp;v7, <span class="number">16L</span>L);</span><br><span class="line">__gmpz_init_set_str(&amp;v2, <span class="string">"103461035900816914121390101299049044413950405173712170434161686539878160984549"</span>, <span class="number">10L</span>L);</span><br><span class="line">__gmpz_init_set_str(&amp;v3, <span class="string">"65537"</span>, <span class="number">10L</span>L);</span><br><span class="line">__gmpz_powm(&amp;v4, &amp;v4, &amp;v3, &amp;v2);</span><br><span class="line"><span class="keyword">if</span> ( __gmpz_cmp(&amp;v4, &amp;v5) )</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"GG!"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"TTTTTTTTTTql!"</span>);</span><br></pre></td></tr></table></figure>

<p>v6=flag</p>
<p> sub_96A：v6变v7</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">size_t</span> __<span class="function">fastcall <span class="title">sub_96A</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> result; <span class="comment">// rax@3</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [sp+18h] [bp-18h]@1</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [sp+1Ch] [bp-14h]@1</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; i += <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="built_in">strlen</span>(a1);</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt;= result )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(a2 + i) = byte_202010[(<span class="keyword">char</span>)(a1[v3] &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">    *(_BYTE *)(a2 + i + <span class="number">1L</span>L) = byte_202010[a1[v3++] &amp; <span class="number">0xF</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>byte_202010：16进制0-f</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">db</span> <span class="number">30h</span>, <span class="number">31h</span>, <span class="number">32h</span>, <span class="number">33h</span>, <span class="number">34h</span>, <span class="number">35h</span>, <span class="number">36h</span>, <span class="number">37h</span>, <span class="number">38h</span>, <span class="number">39h</span>, <span class="number">61h</span> <span class="number">62h</span>, <span class="number">63h</span>, <span class="number">64h</span>, <span class="number">65h</span>, <span class="number">66h</span></span><br></pre></td></tr></table></figure>

<p>__gmpz_init_set_str：</p>
<blockquote>
<p>  　GMP(The GNU Multiple Precision Arithmetic Library)又叫GNU多精度算术库，是一个提供了很多操作高精度的大整数，浮点数的运算的算术库，几乎没有什么精度方面的限制，功能丰富。</p>
</blockquote>
<p>__gmpz_powm</p>
<blockquote>
<p>  gmp_powm()是PHP中的一个内置函数，用于计算以另一个GMP数模数模拟的两个GMP数的幂。（GNU Multiple Precision：For large number）</p>
</blockquote>
<p>没有查到__gmpz_init_set_str具体干嘛的，应该是字符串转数字，gmpz_powm指数模。但是看到65537，rsa。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a,b)</span>:</span>         <span class="comment">#扩展欧几里得算法</span></span><br><span class="line">    <span class="keyword">if</span> a==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span>  (b,<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g,y,x=egcd(b%a,a)</span><br><span class="line">        <span class="keyword">return</span> (g,x-(b//a)*y,y)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a,m)</span>:</span></span><br><span class="line">    g,x,y=egcd(a,m)</span><br><span class="line">    <span class="keyword">if</span> g!=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x%m</span><br><span class="line">c_hex=<span class="string">'ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35'</span></span><br><span class="line">c=int(c_hex,<span class="number">16</span>)</span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line">n=<span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">p=<span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q=<span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">fn=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d=modinv(e,fn)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line"><span class="comment">#m_hex=hex(m)</span></span><br><span class="line"><span class="comment">#print(m_hex)</span></span><br><span class="line">m_hex=<span class="string">'73756374667b50776e5f405f68756e647265645f79656172737d'</span></span><br><span class="line">print(binascii.a2b_hex(m_hex))</span><br></pre></td></tr></table></figure>

<p>原来有gmpy2.mpz</p>
<p><a href="https://www.cnblogs.com/ESHLkangi/p/8576222.html" target="_blank" rel="noopener">https://www.cnblogs.com/ESHLkangi/p/8576222.html</a></p>
<h3 id="justre"><a href="#justre" class="headerlink" title="justre"></a>justre</h3><p>you dian ji dong.</p>
<p>f5不出来，右键create f</p>
<p>sprintf(&amp;String, aBjdDD2069a4579, 19999, 0);</p>
<p>BJD{1999902069a45792d233ac}</p>
<p>这个分值是为什么啊</p>
<p><a href="https://bbs.pediy.com/thread-158896.htm" target="_blank" rel="noopener">ida F5失败原因1</a></p>
<p><a href="https://bbs.pediy.com/thread-158896.htm" target="_blank" rel="noopener">ida F5失败原因2</a></p>
<h2 id="day9-5-13"><a href="#day9-5-13" class="headerlink" title="day9 5.13"></a>day9 5.13</h2><h3 id="strngecpp"><a href="#strngecpp" class="headerlink" title="strngecpp"></a>strngecpp</h3><p>没有什么能阻止我获得flag，Orz。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">  <span class="built_in">puts</span>(<span class="string">"Let me have a look at your computer..."</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = v16; *(_QWORD *)j; j += <span class="number">8</span>i64 )</span><br><span class="line">  &#123;</span><br><span class="line">    v14 = *(_QWORD *)j;</span><br><span class="line">    sub_140011226(<span class="string">"%s\n"</span>, v14);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::<span class="built_in">cout</span>, sub_140011127);</span><br><span class="line">  dword_140021190 = SystemInfo.dwNumberOfProcessors;</span><br><span class="line">  sub_140011226(<span class="string">"now system cpu num is %d\n"</span>, SystemInfo.dwNumberOfProcessors);</span><br><span class="line">  <span class="keyword">if</span> ( dword_140021190 &lt; <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Are you in VM?"</span>);</span><br><span class="line">    _exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( GetUserNameA(Str1, &amp;pcbBuffer) )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v5) = sub_140011172(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"this is useful"</span>);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v5, sub_140011127);</span><br><span class="line">  &#125;</span><br><span class="line">  LODWORD(v6) = <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::<span class="built_in">cout</span>, sub_140011127);</span><br><span class="line">  LODWORD(v7) = sub_140011172(v6, <span class="string">"ok,I am checking..."</span>);</span><br><span class="line">  <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v7, sub_140011127);</span><br><span class="line">  <span class="keyword">if</span> ( !j_strcmp(Str1, <span class="string">"cxx"</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v8) = sub_140011172(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"flag&#123;where_is_my_true_flag?&#125;"</span>);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v8, sub_140011127);</span><br><span class="line">    _exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  system(<span class="string">"pause"</span>);</span><br><span class="line">  sub_1400113E3(&amp;v10, &amp;unk_14001DE50);</span><br><span class="line">  <span class="keyword">return</span> sub_140011104((<span class="keyword">unsigned</span> __int64)&amp;v11 ^ v15);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我觉得flag应该在：</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_1400113E3((<span class="name">__int64</span>)<span class="symbol">&amp;v10</span>, (<span class="name">__int64</span>)<span class="symbol">&amp;unk_14001DE50</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">sub_140014860</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// ebx@1</span></span><br><span class="line">  __int64 v3; <span class="comment">// rsi@1</span></span><br><span class="line">  __int64 v4; <span class="comment">// rbp@1</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdi@2</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx@3</span></span><br><span class="line">  __int64 v7; <span class="comment">// rcx@3</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax@4</span></span><br><span class="line">  <span class="keyword">void</span> *retaddr; <span class="comment">// [sp+28h] [bp+0h]@5</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  v3 = a2;</span><br><span class="line">  v4 = a1;</span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)a2 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = *(_QWORD *)(v3 + <span class="number">8</span>);</span><br><span class="line">      v7 = *(_DWORD *)(v6 + v5);</span><br><span class="line">      <span class="keyword">if</span> ( *(_DWORD *)(v7 + v4 - <span class="number">4</span>) != <span class="number">-858993460</span></span><br><span class="line">        || (v8 = v7 + *(_DWORD *)(v6 + v5 + <span class="number">4</span>), *(_DWORD *)(v8 + v4) != <span class="number">-858993460</span>) )</span><br><span class="line">        LODWORD(v8) = sub_14001117C(retaddr, *(_QWORD *)(v6 + v5 + <span class="number">8</span>));</span><br><span class="line">      ++v2;</span><br><span class="line">      v5 += <span class="number">16</span>i64;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v2 &lt; *(_DWORD *)v3 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>unk_14001DE50=10000000</p>
<p>0i64、16i64应该是64位整数。</p>
<p>-858993460是啥0xcccccccc</p>
<p>等等</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v15 = (unsigned __int64)&amp;v11 ^ _security_cookie;</span><br><span class="line">return sub_140011104((unsigned __int64)&amp;v11 ^ v15);</span><br></pre></td></tr></table></figure>

<p>_security_cookie=47936899621426：i64。好像没什么用。</p>
<p>找到一些奇怪的东西</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">db</span> <span class="number">26h</span>, <span class="number">2Ch</span>, <span class="number">21h</span>, <span class="number">27h</span>, <span class="number">3Bh</span>, <span class="number">0Dh</span>, <span class="number">4</span>, <span class="number">75h</span>, <span class="number">68h</span>, <span class="number">34h</span>, <span class="number">28h</span></span><br><span class="line"><span class="built_in">db</span> <span class="number">25h</span>, <span class="number">0Eh</span>, <span class="number">35h</span>, <span class="number">2Dh</span>, <span class="number">69h</span>, <span class="number">3Dh</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_140013580</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 *v0; <span class="comment">// rdi@1</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// rcx@1</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@4</span></span><br><span class="line">  __int64 v3; <span class="comment">// [sp+0h] [bp-20h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+24h] [bp+4h]@4</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [sp+44h] [bp+24h]@6</span></span><br><span class="line">  __int64 v6; <span class="comment">// [sp+128h] [bp+108h]@4</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v3;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">82</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v0 = <span class="number">-858993460</span>;</span><br><span class="line">    v0 = (__int64 *)((<span class="keyword">char</span> *)v0 + <span class="number">4</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = <span class="number">-2</span>i64;</span><br><span class="line">  sub_1400110AA(&amp;unk_140027033);</span><br><span class="line">  result = sub_140011384((<span class="keyword">unsigned</span> <span class="keyword">int</span>)dword_140021190);</span><br><span class="line">  v4 = result;</span><br><span class="line">  <span class="keyword">if</span> ( result == <span class="number">607052314</span> &amp;&amp; dword_140021190 &lt;= <span class="number">14549743</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">17</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">putchar</span>((<span class="keyword">unsigned</span> __int8)(dword_140021190 ^ byte_140021008[j]));</span><br><span class="line">      result = j + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">sub_140013890</span><span class="params">(<span class="keyword">signed</span> <span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 *v1; <span class="comment">// rdi@1</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 i; <span class="comment">// rcx@1</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax@5</span></span><br><span class="line">  __int64 v4; <span class="comment">// [sp+0h] [bp-20h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+24h] [bp+4h]@4</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [sp+44h] [bp+24h]@4</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [sp+64h] [bp+44h]@4</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v8; <span class="comment">// [sp+160h] [bp+140h]@1</span></span><br><span class="line"></span><br><span class="line">  v8 = a1;</span><br><span class="line">  v1 = &amp;v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">82</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v1 = <span class="number">-858993460</span>;</span><br><span class="line">    v1 = (__int64 *)((<span class="keyword">char</span> *)v1 + <span class="number">4</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_1400110AA(&amp;unk_140027033);</span><br><span class="line">  v5 = v8 &gt;&gt; <span class="number">12</span>;</span><br><span class="line">  v6 = v8 &lt;&lt; <span class="number">8</span>;</span><br><span class="line">  v7 = (v8 &lt;&lt; <span class="number">8</span>) ^ (v8 &gt;&gt; <span class="number">12</span>);</span><br><span class="line">  v7 *= <span class="number">291</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">    result = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v7;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="number">987</span>i64;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>dword_140021190通过sub_140013890变成了result</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">result = 607052314</span></span><br><span class="line"><span class="string">for i in range(14549743):</span></span><br><span class="line"><span class="string">    print(i)</span></span><br><span class="line"><span class="string">    v8=i</span></span><br><span class="line"><span class="string">    v7 = (v8 &lt;&lt; 8) ^ (v8 &gt;&gt; 12)</span></span><br><span class="line"><span class="string">    v7 *= 291</span></span><br><span class="line"><span class="string">    if v70xFFFFFFFF==result:</span></span><br><span class="line"><span class="string">        print(i)</span></span><br><span class="line"><span class="string">        break</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">result = <span class="number">123456</span></span><br><span class="line">a=<span class="string">'26h, 2Ch, 21h, 27h, 3Bh, 0Dh, 4, 75h, 68h, 34h, 28h,25h, 0Eh, 35h, 2Dh, 69h, 3Dh'</span></span><br><span class="line">b=a.replace(<span class="string">'h'</span>,<span class="string">''</span>)</span><br><span class="line">c=b.replace(<span class="string">' '</span>,<span class="string">''</span>)</span><br><span class="line">d=c.split(<span class="string">','</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(d)):</span><br><span class="line">    d[i]=<span class="string">'0x'</span>+d[i]</span><br><span class="line">print(d)</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">    flag += chr((result ^ int(i,<span class="number">16</span>))&amp;<span class="number">0xFF</span>) </span><br><span class="line">print(flag)</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(<span class="string">'123456'</span>)</span><br><span class="line"><span class="keyword">print</span> md5.hexdigest()</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/Mayfly-nymph/p/12609782.html" target="_blank" rel="noopener">没有注意unsigned int和int的我像个弱智跑了好久</a></p>
<h2 id="day10-5-14"><a href="#day10-5-14" class="headerlink" title="day10   5.14"></a>day10   5.14</h2><p>又是元气满满的一天。</p>
<p>我最乐于助人了。</p>
<p>。。。</p>
<p>路由器固件dump文件，tplink我倒是看到了</p>
<p>binwalk -e 后有个.squashfs、7z压缩包、证书、空文件夹</p>
<blockquote>
<p>  Squashfs是一个只读格式的文件系统，具有超高压缩率，其压缩率最高可达34%。当系统启动后，会将文件系统保存在一个压缩过的文件系统的文件中，这个文件可以使用换回的形式挂载并对其中的文件进行访问，当进程需要某些文件时，仅将对应部分的压缩文件解压缩。</p>
<p>  　　Squashfs文件系统常用的压缩格式有GZIP、LZMA、LZO、XZ(LZMA2)，在路由器中被普遍采用。路由器的根文件系统通常会按照Squashfs文件系统常用压缩格式中的一种进行打包，形成一个完整的Squashfs文件系统，然后与路由器操作系统的内核一起形成更新固件。</p>
</blockquote>
<p>然后呢。网上查</p>
<p>用unsquashfs命令解压</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-14_20-38-27.png" alt></p>
<p>去ubuntu试试，不行。</p>
<p>查报错，。。。算了看wp</p>
<blockquote>
<p>  firmware-mod-kit工具的功能和binwalk工具的类似，实际上firmware-mod- kitfirm工具在功能上有调用binwalk工具提供的功能以及其他的固件解包工具的整合。下载firmware-mod-kit工具的链接进入到src目录下就能够看到firmware-mod-kit工具整合了那些固件提取和文件系统解压的工具。firmware-mod-kit工具的功能有固件文件的解包和打包，固件提取文件系统的解压和压缩，DD-WRT<br>  网页的修改等，在每个整合的固件分析中工具的源码文件夹里都有相关的使用说明。</p>
</blockquote>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install git build-essential zlib1g-dev liblzma-dev <span class="keyword">python</span>-magic</span><br><span class="line">git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/mirror/firmware-<span class="keyword">mod</span>-kit.git</span><br><span class="line"><span class="keyword">cd</span> firmware-<span class="keyword">mod</span>-kit/src</span><br><span class="line">./configure &amp;&amp; <span class="keyword">make</span></span><br></pre></td></tr></table></figure>

<p><a href="https://www.linuxidc.com/Linux/2019-05/158461.htm" target="_blank" rel="noopener">gitclone慢</a>没什么用，fq也是</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./unsquashfs_all<span class="selector-class">.sh</span> <span class="number">120200</span>.squashfs</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/blacksunny/p/7208451.html?utm_source=itdadao&utm_medium=referral" target="_blank" rel="noopener">emmm手动</a></p>
<h2 id="day11-5-15"><a href="#day11-5-15" class="headerlink" title="day11 5.15"></a>day11 5.15</h2><p><em>路漫漫其修远兮，吾将上下而求索！</em></p>
<hr>
<h3 id="re"><a href="#re" class="headerlink" title="re"></a>re</h3><p>好短，有壳吧。</p>
<p>脱壳。</p>
<p>搜了一波。</p>
<p>找到aInputYourFlag，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sub_40F950((__int64)<span class="string">"input your flag:"</span>, <span class="number">0L</span>L, <span class="number">0L</span>L, <span class="number">0L</span>L, <span class="number">0L</span>L);</span><br><span class="line">sub_40FA80((__int64)<span class="string">"%s"</span>, &amp;v4);</span><br><span class="line"><span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_4009AE(&amp;v4, &amp;v4) )</span><br><span class="line">&#123;</span><br><span class="line">v0 = <span class="string">"Correct!"</span>;</span><br><span class="line">sub_410350(<span class="string">"Correct!"</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sub_40F950(-92);</span></span><br><span class="line"><span class="keyword"> </span> <span class="keyword">sub_40FA80(-75);</span></span><br><span class="line"><span class="keyword"> </span> if ( <span class="keyword">sub_4009AE(&amp;v2, </span>&amp;v2) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">v0</span> = <span class="number">4855992</span>LL<span class="comment">;</span></span><br><span class="line">    <span class="keyword">sub_410350(4855992LL);</span></span><br><span class="line"><span class="keyword"> </span>   result = <span class="number">0</span>LL<span class="comment">;</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>sub_4009ae里</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall sub_4009AE(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax@2</span></span><br><span class="line"></span><br><span class="line">  if ( <span class="number">1629056</span> * *(_BYTE *)a1 == <span class="number">166163712</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( <span class="number">6771600</span> * *(_BYTE *)(a1 + <span class="number">1</span>) == <span class="number">731332800</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( <span class="number">3682944</span> * *(_BYTE *)(a1 + <span class="number">2</span>) == <span class="number">357245568</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        if ( <span class="number">10431000</span> * *(_BYTE *)(a1 + <span class="number">3</span>) == <span class="number">1074393000</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( <span class="number">3977328</span> * *(_BYTE *)(a1 + <span class="number">4</span>) == <span class="number">489211344</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            if ( <span class="number">5138336</span> * *(_BYTE *)(a1 + <span class="number">5</span>) == <span class="number">518971936</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              if ( <span class="number">7532250</span> * *(_BYTE *)(a1 + <span class="number">7</span>) == <span class="number">406741500</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                if ( <span class="number">5551632</span> * *(_BYTE *)(a1 + <span class="number">8</span>) == <span class="number">294236496</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                  if ( <span class="number">3409728</span> * *(_BYTE *)(a1 + <span class="number">9</span>) == <span class="number">177305856</span> )</span><br><span class="line">                  &#123;</span><br><span class="line">                    if ( <span class="number">13013670</span> * *(_BYTE *)(a1 + <span class="number">10</span>) == <span class="number">650683500</span> )</span><br><span class="line">                    &#123;</span><br><span class="line">                      if ( <span class="number">6088797</span> * *(_BYTE *)(a1 + <span class="number">11</span>) == <span class="number">298351053</span> )</span><br><span class="line">                      &#123;</span><br><span class="line">                        if ( <span class="number">7884663</span> * *(_BYTE *)(a1 + <span class="number">12</span>) == <span class="number">386348487</span> )</span><br><span class="line">                        &#123;</span><br><span class="line">                          if ( <span class="number">8944053</span> * *(_BYTE *)(a1 + <span class="number">13</span>) == <span class="number">438258597</span> )</span><br><span class="line">                          &#123;</span><br><span class="line">                            if ( <span class="number">5198490</span> * *(_BYTE *)(a1 + <span class="number">14</span>) == <span class="number">249527520</span> )</span><br><span class="line">                            &#123;</span><br><span class="line">                              if ( <span class="number">4544518</span> * *(_BYTE *)(a1 + <span class="number">15</span>) == <span class="number">445362764</span> )</span><br><span class="line">                              &#123;</span><br><span class="line">                                if ( <span class="number">3645600</span> * *(_BYTE *)(a1 + <span class="number">17</span>) == <span class="number">174988800</span> )</span><br><span class="line">                                &#123;</span><br><span class="line">                                  if ( <span class="number">10115280</span> * *(_BYTE *)(a1 + <span class="number">16</span>) == <span class="number">981182160</span> )</span><br><span class="line">                                  &#123;</span><br><span class="line">                                    if ( <span class="number">9667504</span> * *(_BYTE *)(a1 + <span class="number">18</span>) == <span class="number">493042704</span> )</span><br><span class="line">                                    &#123;</span><br><span class="line">                                      if ( <span class="number">5364450</span> * *(_BYTE *)(a1 + <span class="number">19</span>) == <span class="number">257493600</span> )</span><br><span class="line">                                      &#123;</span><br><span class="line">                                        if ( <span class="number">13464540</span> * *(_BYTE *)(a1 + <span class="number">20</span>) == <span class="number">767478780</span> )</span><br><span class="line">                                        &#123;</span><br><span class="line">                                          if ( <span class="number">5488432</span> * *(_BYTE *)(a1 + <span class="number">21</span>) == <span class="number">312840624</span> )</span><br><span class="line">                                          &#123;</span><br><span class="line">                                            if ( <span class="number">14479500</span> * *(_BYTE *)(a1 + <span class="number">22</span>) == <span class="number">1404511500</span> )</span><br><span class="line">                                            &#123;</span><br><span class="line">                                              if ( <span class="number">6451830</span> * *(_BYTE *)(a1 + <span class="number">23</span>) == <span class="number">316139670</span> )</span><br><span class="line">                                              &#123;</span><br><span class="line">                                                if ( <span class="number">6252576</span> * *(_BYTE *)(a1 + <span class="number">24</span>) == <span class="number">619005024</span> )</span><br><span class="line">                                                &#123;</span><br><span class="line">                                                  if ( <span class="number">7763364</span> * *(_BYTE *)(a1 + <span class="number">25</span>) == <span class="number">372641472</span> )</span><br><span class="line">                                                  &#123;</span><br><span class="line">                                                    if ( <span class="number">7327320</span> * *(_BYTE *)(a1 + <span class="number">26</span>) == <span class="number">373693320</span> )</span><br><span class="line">                                                    &#123;</span><br><span class="line">                                                      if ( <span class="number">8741520</span> * *(_BYTE *)(a1 + <span class="number">27</span>) == <span class="number">498266640</span> )</span><br><span class="line">                                                      &#123;</span><br><span class="line">                                                        if ( <span class="number">8871876</span> * *(_BYTE *)(a1 + <span class="number">28</span>) == <span class="number">452465676</span> )</span><br><span class="line">                                                        &#123;</span><br><span class="line">                                                          if ( <span class="number">4086720</span> * *(_BYTE *)(a1 + <span class="number">29</span>) == <span class="number">208422720</span> )</span><br><span class="line">                                                          &#123;</span><br><span class="line">                                                            if ( <span class="number">9374400</span> * *(_BYTE *)(a1 + <span class="number">30</span>) == <span class="number">515592000</span> )</span><br><span class="line">                                                              result = <span class="number">5759124</span> * *(_BYTE *)(a1 + <span class="number">31</span>) == <span class="number">719890500</span>;</span><br><span class="line">                                                            else</span><br><span class="line">                                                              result = <span class="number">0</span>LL;</span><br><span class="line">                                                          &#125;</span><br><span class="line">                                                          else</span><br><span class="line">                                                          &#123;</span><br><span class="line">                                                            result = <span class="number">0</span>LL;</span><br><span class="line">                                                          &#125;</span><br><span class="line">                                                        &#125;</span><br><span class="line">                                                        else</span><br><span class="line">                                                        &#123;</span><br><span class="line">                                                          result = <span class="number">0</span>LL;</span><br><span class="line">                                                        &#125;</span><br><span class="line">                                                      &#125;</span><br><span class="line">                                                      else</span><br><span class="line">                                                      &#123;</span><br><span class="line">                                                        result = <span class="number">0</span>LL;</span><br><span class="line">                                                      &#125;</span><br><span class="line">                                                    &#125;</span><br><span class="line">                                                    else</span><br><span class="line">                                                    &#123;</span><br><span class="line">                                                      result = <span class="number">0</span>LL;</span><br><span class="line">                                                    &#125;</span><br><span class="line">                                                  &#125;</span><br><span class="line">                                                  else</span><br><span class="line">                                                  &#123;</span><br><span class="line">                                                    result = <span class="number">0</span>LL;</span><br><span class="line">                                                  &#125;</span><br><span class="line">                                                &#125;</span><br><span class="line">                                                else</span><br><span class="line">                                                &#123;</span><br><span class="line">                                                  result = <span class="number">0</span>LL;</span><br><span class="line">                                                &#125;</span><br><span class="line">                                              &#125;</span><br><span class="line">                                              else</span><br><span class="line">                                              &#123;</span><br><span class="line">                                                result = <span class="number">0</span>LL;</span><br><span class="line">                                              &#125;</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            else</span><br><span class="line">                                            &#123;</span><br><span class="line">                                              result = <span class="number">0</span>LL;</span><br><span class="line">                                            &#125;</span><br><span class="line">                                          &#125;</span><br><span class="line">                                          else</span><br><span class="line">                                          &#123;</span><br><span class="line">                                            result = <span class="number">0</span>LL;</span><br><span class="line">                                          &#125;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        else</span><br><span class="line">                                        &#123;</span><br><span class="line">                                          result = <span class="number">0</span>LL;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                      &#125;</span><br><span class="line">                                      else</span><br><span class="line">                                      &#123;</span><br><span class="line">                                        result = <span class="number">0</span>LL;</span><br><span class="line">                                      &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    else</span><br><span class="line">                                    &#123;</span><br><span class="line">                                      result = <span class="number">0</span>LL;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                  &#125;</span><br><span class="line">                                  else</span><br><span class="line">                                  &#123;</span><br><span class="line">                                    result = <span class="number">0</span>LL;</span><br><span class="line">                                  &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                else</span><br><span class="line">                                &#123;</span><br><span class="line">                                  result = <span class="number">0</span>LL;</span><br><span class="line">                                &#125;</span><br><span class="line">                              &#125;</span><br><span class="line">                              else</span><br><span class="line">                              &#123;</span><br><span class="line">                                result = <span class="number">0</span>LL;</span><br><span class="line">                              &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            else</span><br><span class="line">                            &#123;</span><br><span class="line">                              result = <span class="number">0</span>LL;</span><br><span class="line">                            &#125;</span><br><span class="line">                          &#125;</span><br><span class="line">                          else</span><br><span class="line">                          &#123;</span><br><span class="line">                            result = <span class="number">0</span>LL;</span><br><span class="line">                          &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        else</span><br><span class="line">                        &#123;</span><br><span class="line">                          result = <span class="number">0</span>LL;</span><br><span class="line">                        &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                      else</span><br><span class="line">                      &#123;</span><br><span class="line">                        result = <span class="number">0</span>LL;</span><br><span class="line">                      &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    else</span><br><span class="line">                    &#123;</span><br><span class="line">                      result = <span class="number">0</span>LL;</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                  else</span><br><span class="line">                  &#123;</span><br><span class="line">                    result = <span class="number">0</span>LL;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                  result = <span class="number">0</span>LL;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              else</span><br><span class="line">              &#123;</span><br><span class="line">                result = <span class="number">0</span>LL;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">              result = <span class="number">0</span>LL;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          else</span><br><span class="line">          &#123;</span><br><span class="line">            result = <span class="number">0</span>LL;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">          result = <span class="number">0</span>LL;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="number">0</span>LL;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">0</span>LL;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>32位a1。</p>
<h3 id="crackMe"><a href="#crackMe" class="headerlink" title="crackMe"></a>crackMe</h3><p>32位。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"user(6-16 letters or numbers):"</span>);</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v10);</span><br><span class="line">      v0 = (FILE *)sub_4024BE();</span><br><span class="line">      sub_4022E7(v0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( !(<span class="keyword">unsigned</span> __int8)sub_401000(&amp;v10) );</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"password(6-16 letters or numbers):"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v8);</span><br><span class="line">    v1 = (FILE *)sub_4024BE();</span><br><span class="line">    sub_4022E7(v1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( !(<span class="keyword">unsigned</span> __int8)sub_401000(&amp;v8) );</span><br><span class="line">  sub_401090(&amp;v10);</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v7, <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v5, <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  v3 = ((<span class="keyword">int</span> (__cdecl *)(<span class="keyword">char</span> *, <span class="keyword">char</span> *))loc_4011A0)(&amp;v6, &amp;v4);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)sub_401830(&amp;v10, &amp;v8) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(&amp;v4);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(&amp;v6);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>sub_4020E5==printf</p>
<p>sub_402194==scanf</p>
<p>sub_401000应该是判断用户存在。。是判断输入合法</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> __<span class="function">cdecl <span class="title">sub_401000</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> result; <span class="comment">// al@3</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [sp+8h] [bp-10h]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [sp+Ch] [bp-Ch]@4</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v2 &gt;= <span class="number">6</span> || (<span class="keyword">signed</span> <span class="keyword">int</span>)v2 &lt;= <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (<span class="keyword">signed</span> <span class="keyword">int</span>)v2; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !<span class="built_in">isalnum</span>(a1[i]) )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关键应该是sub_401830，它同时调用user和password</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> __usercall sub_401830@&lt;al&gt;(<span class="keyword">signed</span> <span class="keyword">int</span> ebx0@&lt;ebx&gt;, <span class="keyword">int</span> a1, <span class="keyword">const</span> <span class="keyword">char</span> *a2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; <span class="comment">// [sp+18h] [bp-22Ch]@1</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [sp+1Ch] [bp-228h]@1</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [sp+28h] [bp-21Ch]@1</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v7; <span class="comment">// [sp+30h] [bp-214h]@1</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [sp+36h] [bp-20Eh]@14</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [sp+37h] [bp-20Dh]@4</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [sp+38h] [bp-20Ch]@1</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [sp+39h] [bp-20Bh]@1</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [sp+3Ah] [bp-20Ah]@1</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [sp+3Bh] [bp-209h]@14</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// [sp+3Ch] [bp-208h]@21</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [sp+40h] [bp-204h]@1</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [sp+41h] [bp-203h]@1</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [sp+140h] [bp-104h]@1</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [sp+141h] [bp-103h]@1</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v18, <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v16, <span class="number">0</span>, <span class="number">0xFF</span>u);</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v7 &lt; <span class="built_in">strlen</span>(a2) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">isdigit</span>(a2[v7]) )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = a2[v7] - <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">isxdigit</span>(a2[v7]) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(_DWORD *)(*(_DWORD *)(__readfsdword(<span class="number">48</span>) + <span class="number">24</span>) + <span class="number">12</span>) != <span class="number">2</span> )</span><br><span class="line">        a2[v7] = <span class="number">34</span>;</span><br><span class="line">      v9 = (a2[v7] | <span class="number">0x20</span>) - <span class="number">87</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v9 = ((a2[v7] | <span class="number">0x20</span>) - <span class="number">97</span>) % <span class="number">6</span> + <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v10 = v9 + <span class="number">16</span> * v10;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">    选a2偶数位的数值给v15</span></span><br><span class="line"><span class="comment">    ***/</span></span><br><span class="line">    <span class="keyword">if</span> ( !((<span class="keyword">signed</span> <span class="keyword">int</span>)(v7 + <span class="number">1</span>) % <span class="number">2</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      *(&amp;v15 + v4++) = v10;</span><br><span class="line">      ebx0 = v4;</span><br><span class="line">      v10 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v7;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v6 &lt; <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++v12;</span><br><span class="line">    v11 += byte_416050[(<span class="keyword">unsigned</span> __int8)v12];</span><br><span class="line">    v13 = byte_416050[(<span class="keyword">unsigned</span> __int8)v12];</span><br><span class="line">    v8 = byte_416050[(<span class="keyword">unsigned</span> __int8)v11];</span><br><span class="line">    byte_416050[(<span class="keyword">unsigned</span> __int8)v11] = v13;</span><br><span class="line">    byte_416050[(<span class="keyword">unsigned</span> __int8)v12] = v8;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)(__readfsdword(<span class="number">48</span>) + <span class="number">104</span>) &amp; <span class="number">0x70</span> )</span><br><span class="line">      v13 = v11 + v12;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">    v17有8位，byte_416050[不知道什么鬼]^v15。（v5=v6）</span></span><br><span class="line"><span class="comment">    ***/</span></span><br><span class="line">    *(&amp;v17 + v6) = byte_416050[(<span class="keyword">unsigned</span> __int8)(v8 + v13)] ^ *(&amp;v15 + v5);</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)(__readfsdword(<span class="number">48</span>) + <span class="number">2</span>) &amp; <span class="number">0xFF</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v11 = <span class="number">-83</span>;</span><br><span class="line">      v12 = <span class="number">43</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_401710((<span class="keyword">int</span>)&amp;v17, (<span class="keyword">const</span> <span class="keyword">char</span> *)a1, v6++);</span><br><span class="line">    v5 = v6;</span><br><span class="line">    <span class="keyword">if</span> ( v6 &gt;= <span class="built_in">strlen</span>(&amp;v15) )</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  sub_401470(ebx0, (<span class="keyword">int</span>)&amp;v17, (<span class="keyword">int</span>)&amp;v14);</span><br><span class="line">  <span class="keyword">return</span> v14 == <span class="number">43924</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_401470，传v17，使v14=43924</p>
<p>sub_401470里发现多个 if ( *(_BYTE *)a2 == ‘字符’ )，v17=dbappsec。</p>
<p>byte_416050在sub_401090(user)生成。不不不感谢<a href="https://www.cnblogs.com/basstorm/p/12662023.html。" target="_blank" rel="noopener">https://www.cnblogs.com/basstorm/p/12662023.html。</a></p>
<p>绕过三个if反调试（__readfsdword）</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-15_19-38-24.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-15_19-38-39.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-15_19-38-52.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-15_19-37-47.png" alt></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v = [<span class="number">0x2a</span>,<span class="number">0xd7</span>,<span class="number">0x92</span>,<span class="number">0xe9</span>,<span class="number">0x53</span>,<span class="number">0xe2</span>,<span class="number">0xc4</span>,<span class="number">0xcd</span>]</span><br><span class="line">a =<span class="string">'dbappsec'</span></span><br><span class="line">ps=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    ps+=hex(ord(a[i])^v[i])[<span class="number">2</span>:]</span><br><span class="line">print(ps)</span><br></pre></td></tr></table></figure>

<p>可以说这是我目前为止遇到最难的，结合wp搞了一下午。反调试看了<a href="https://www.cnblogs.com/Crisczy/p/7575521.html，简单理解了一下。" target="_blank" rel="noopener">https://www.cnblogs.com/Crisczy/p/7575521.html，简单理解了一下。</a></p>
<h2 id="day12-5-16"><a href="#day12-5-16" class="headerlink" title="day12 5.16"></a>day12 5.16</h2><h3 id="GUET-2019-re"><a href="#GUET-2019-re" class="headerlink" title="[GUET-2019]re"></a>[GUET-2019]re</h3><p>掐指一算有壳。</p>
<p>根据sub_4009AE写脚本。</p>
<p>这里可以用Z3约束器，也可以用515592000//9374400直接求a1。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#申明未知量</span></span><br><span class="line">a1 = [<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    a1[i] = Int(<span class="string">'a1['</span>+str(i)+<span class="string">']'</span>)</span><br><span class="line">s=Solver() <span class="comment"># 创建约束求解器</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加约束条件</span></span><br><span class="line">s.add( <span class="number">1629056</span> * a1[<span class="number">0</span>] == <span class="number">166163712</span> )</span><br><span class="line">s.add( <span class="number">6771600</span> * a1[<span class="number">1</span>] == <span class="number">731332800</span> )</span><br><span class="line">s.add( <span class="number">3682944</span> * a1[<span class="number">2</span>] == <span class="number">357245568</span> )</span><br><span class="line">s.add( <span class="number">10431000</span> * a1[<span class="number">3</span>] == <span class="number">1074393000</span> )</span><br><span class="line">s.add( <span class="number">3977328</span> * a1[<span class="number">4</span>] == <span class="number">489211344</span> )</span><br><span class="line">s.add( <span class="number">5138336</span> * a1[<span class="number">5</span>] == <span class="number">518971936</span> )</span><br><span class="line">s.add( <span class="number">7532250</span> * a1[<span class="number">7</span>] == <span class="number">406741500</span> )</span><br><span class="line">s.add( <span class="number">5551632</span> * a1[<span class="number">8</span>] == <span class="number">294236496</span> )</span><br><span class="line">s.add( <span class="number">3409728</span> * a1[<span class="number">9</span>] == <span class="number">177305856</span> )</span><br><span class="line">s.add( <span class="number">13013670</span> * a1[<span class="number">10</span>] == <span class="number">650683500</span> )</span><br><span class="line">s.add( <span class="number">6088797</span> * a1[<span class="number">11</span>] == <span class="number">298351053</span> )</span><br><span class="line">s.add( <span class="number">7884663</span> * a1[<span class="number">12</span>] == <span class="number">386348487</span> )</span><br><span class="line">s.add( <span class="number">8944053</span> * a1[<span class="number">13</span>] == <span class="number">438258597</span> )</span><br><span class="line">s.add( <span class="number">5198490</span> * a1[<span class="number">14</span>] == <span class="number">249527520</span> )</span><br><span class="line">s.add( <span class="number">4544518</span> * a1[<span class="number">15</span>] == <span class="number">445362764</span> )</span><br><span class="line">s.add( <span class="number">3645600</span> * a1[<span class="number">17</span>] == <span class="number">174988800</span> )</span><br><span class="line">s.add( <span class="number">10115280</span> * a1[<span class="number">16</span>] == <span class="number">981182160</span> )</span><br><span class="line">s.add( <span class="number">9667504</span> * a1[<span class="number">18</span>] == <span class="number">493042704</span> )</span><br><span class="line">s.add( <span class="number">5364450</span> * a1[<span class="number">19</span>] == <span class="number">257493600</span> )</span><br><span class="line">s.add( <span class="number">13464540</span> * a1[<span class="number">20</span>] == <span class="number">767478780</span> )</span><br><span class="line">s.add( <span class="number">5488432</span> * a1[<span class="number">21</span>] == <span class="number">312840624</span> )</span><br><span class="line">s.add( <span class="number">14479500</span> * a1[<span class="number">22</span>] == <span class="number">1404511500</span> )</span><br><span class="line">s.add( <span class="number">6451830</span> * a1[<span class="number">23</span>] == <span class="number">316139670</span> )</span><br><span class="line">s.add( <span class="number">6252576</span> * a1[<span class="number">24</span>] == <span class="number">619005024</span> )</span><br><span class="line">s.add( <span class="number">7763364</span> * a1[<span class="number">25</span>] == <span class="number">372641472</span> )</span><br><span class="line">s.add( <span class="number">7327320</span> * a1[<span class="number">26</span>] == <span class="number">373693320</span> )</span><br><span class="line">s.add( <span class="number">8741520</span> * a1[<span class="number">27</span>] == <span class="number">498266640</span> )</span><br><span class="line">s.add( <span class="number">8871876</span> * a1[<span class="number">28</span>] == <span class="number">452465676</span> )</span><br><span class="line">s.add( <span class="number">4086720</span> * a1[<span class="number">29</span>] == <span class="number">208422720</span> )</span><br><span class="line">s.add( <span class="number">9374400</span> * a1[<span class="number">30</span>] == <span class="number">515592000</span> )</span><br><span class="line">s.add(<span class="number">5759124</span> * a1[<span class="number">31</span>] == <span class="number">719890500</span>)</span><br><span class="line"><span class="comment"># 检查是否有解</span></span><br><span class="line"><span class="keyword">if</span> s.check()!=<span class="string">"sat"</span>:</span><br><span class="line">    print( <span class="string">"unsat"</span>)</span><br><span class="line"></span><br><span class="line">m=s.model()</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> m.decls():   <span class="comment"># decls()返回model包含了所有符号的列表</span></span><br><span class="line">    print(<span class="string">"%s = %s"</span> % (d.name(),m[d]))</span><br><span class="line">print(<span class="number">515592000</span>//<span class="number">9374400</span>)</span><br></pre></td></tr></table></figure>

<p>a1[6]没有。没想到爆破。1</p>
<h2 id="day13-5-17"><a href="#day13-5-17" class="headerlink" title="day13 5.17"></a>day13 5.17</h2><h3 id="CSre"><a href="#CSre" class="headerlink" title="CSre"></a>CSre</h3><p>有壳。Eazfuscator.NET <a href="http://github.com/0xd4d/de4dot" target="_blank" rel="noopener">http://github.com/0xd4d/de4dot</a></p>
<p>什么乱七八糟的东西。</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-17_17-05-21.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-17_17-20-18.png" alt></p>
<p>dnspy真好看，class3.method_0是sha1。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> string <span class="title">smethod_0</span><span class="params">(string string_0)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">byte</span>[] bytes = Encoding.UTF8.GetBytes(string_0);</span><br><span class="line">		<span class="keyword">byte</span>[] array = SHA1.Create().ComputeHash(bytes);</span><br><span class="line">		StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		foreach (<span class="keyword">byte</span> b in array)</span><br><span class="line">		&#123;</span><br><span class="line">			stringBuilder.Append(b.ToString(<span class="string">"X2"</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> stringBuilder.ToString();</span><br></pre></td></tr></table></figure>

<p>314159</p>
<p>return</p>
<p>去掉39re</p>
<h2 id="day14-5-18"><a href="#day14-5-18" class="headerlink" title="day14 5.18"></a>day14 5.18</h2><h3 id="ACTF新生赛2020-easyre"><a href="#ACTF新生赛2020-easyre" class="headerlink" title="[ACTF新生赛2020]easyre"></a>[ACTF新生赛2020]easyre</h3><p>upx脱壳</p>
<blockquote>
<p>  LOWORD()得到一个32bit数的低16bit<br>  HIWORD()得到一个32bit数的高16bit<br>  LOBYTE()得到一个16bit数最低（最右边）那个字节<br>  HIBYTE()得到一个16bit数最高（最左边）那个字节</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__main();</span><br><span class="line">v4 = <span class="number">42</span>;</span><br><span class="line">v5 = <span class="number">70</span>;</span><br><span class="line">v6 = <span class="number">39</span>;</span><br><span class="line">v7 = <span class="number">34</span>;</span><br><span class="line">v8 = <span class="number">78</span>;</span><br><span class="line">v9 = <span class="number">44</span>;</span><br><span class="line">v10 = <span class="number">34</span>;</span><br><span class="line">v11 = <span class="number">40</span>;</span><br><span class="line">v12 = <span class="number">73</span>;</span><br><span class="line">v13 = <span class="number">63</span>;</span><br><span class="line">v14 = <span class="number">43</span>;</span><br><span class="line">v15 = <span class="number">64</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Please input:"</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v19);</span><br><span class="line"><span class="keyword">if</span> ( (_BYTE)v19 == <span class="string">'A'</span> &amp;&amp; HIBYTE(v19) == <span class="string">'C'</span> &amp;&amp; v20 == <span class="string">'T'</span> &amp;&amp; v21 == <span class="string">'F'</span> &amp;&amp; v22 == <span class="string">'&#123;'</span> &amp;&amp; v26 == <span class="string">'&#125;'</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v16 = v23;</span><br><span class="line">  v17 = v24;</span><br><span class="line">  v18 = v25;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">11</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(&amp;v4 + i) != _data_start__[*((_BYTE *)&amp;v16 + i) - <span class="number">1</span>] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"You are correct!"</span>);</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.<span class="string">data:</span><span class="number">00402000</span> __data_start__  db <span class="number">7</span>Eh                  ; DATA <span class="string">XREF:</span> _main+ECr</span><br><span class="line">.<span class="string">data:</span><span class="number">00402001</span> aZyxwvutsrqponm db <span class="string">'&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;='</span></span><br><span class="line">.<span class="string">data:</span><span class="number">00402001</span>                 db <span class="string">'&lt;;:9876543210/.-,+*)('</span>,<span class="number">27</span>h,<span class="string">'&amp;%$# !"'</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">'~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(\'&amp;%$# !"'</span></span><br><span class="line">print(data)</span><br><span class="line">v4 = [<span class="number">42</span>,<span class="number">70</span>,<span class="number">39</span>,<span class="number">34</span>,<span class="number">78</span>,<span class="number">44</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">73</span>,<span class="number">63</span>,<span class="number">43</span>,<span class="number">64</span>]</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> v4:</span><br><span class="line">    flag+=chr(data.find(chr(n))+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<p>起飞</p>
<h3 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="[FlareOn4]login"></a>[FlareOn4]login</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE Html /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>FLARE On 2017<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"flag"</span> <span class="attr">id</span>=<span class="string">"flag"</span> <span class="attr">value</span>=<span class="string">"Enter the flag"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"prompt"</span> <span class="attr">value</span>=<span class="string">"Click to check the flag"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">"prompt"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> flag = <span class="built_in">document</span>.getElementById(<span class="string">"flag"</span>).value;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> rotFlag = flag.replace(<span class="regexp">/[a-zA-Z]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode((c &lt;= <span class="string">"Z"</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.charCodeAt(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);&#125;);</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">if</span> (<span class="string">"PyvragFvqrYbtvafNerRnfl@syner-ba.pbz"</span> == rotFlag) &#123;</span></span><br><span class="line"><span class="actionscript">                    alert(<span class="string">"Correct flag!"</span>);</span></span><br><span class="line"><span class="actionscript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">                    alert(<span class="string">"Incorrect flag, rot again"</span>);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JavaScript fromCharCode() 方法将 Unicode 编码转为一个字符:</span><br><span class="line"><span class="keyword">var</span> n = <span class="built_in">String</span>.fromCharCode(<span class="number">65</span>);</span><br><span class="line">n </span><br><span class="line">输出结果:A</span><br><span class="line">charCodeAt() 方法可返回指定位置的字符的 Unicode 编码</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">    (c &lt;= "Z"? 90 : 122) &gt;= (c + 13)</span></span><br><span class="line"><span class="string">    ? c+13 : c - 13</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment">#M77 m109</span></span><br><span class="line">ef=<span class="string">'PyvragFvqrYbtvafNerRnfl@syner-ba.pbz'</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ef:</span><br><span class="line">    <span class="keyword">if</span> i&lt;<span class="string">'A'</span> <span class="keyword">or</span> i&gt;<span class="string">'z'</span> <span class="keyword">or</span> <span class="string">'Z'</span>&lt;i&lt;<span class="string">'a'</span>:</span><br><span class="line">        flag+=i</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Z'</span>&gt;=i&gt;<span class="string">'M'</span> <span class="keyword">or</span> <span class="string">'z'</span>&gt;=i&gt;<span class="string">'m'</span>:</span><br><span class="line">        flag+=chr(ord(i)<span class="number">-13</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=chr(ord(i)+<span class="number">13</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<p>一开始条件没写全。</p>
<h2 id="day15-5-19"><a href="#day15-5-19" class="headerlink" title="day15 5.19"></a>day15 5.19</h2><h3 id="BJDCTF2020-easy"><a href="#BJDCTF2020-easy" class="headerlink" title="[BJDCTF2020]easy"></a>[BJDCTF2020]easy</h3><p>没壳。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+10h] [bp-3F0h]@1</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tm</span> *<span class="title">v5</span>;</span> <span class="comment">// [sp+3FCh] [bp-4h]@1</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  time((<span class="keyword">time_t</span> *)&amp;v4);</span><br><span class="line">  v5 = localtime((<span class="keyword">const</span> <span class="keyword">time_t</span> *)&amp;v4);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Can you find me?\n"</span>);</span><br><span class="line">  system(<span class="string">"pause"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>找，感觉和时间有关。v5是当前时间tm类。</p>
<p>字符串什么的都没有，再找可疑的数据。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ques</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// edx@2</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@16</span></span><br><span class="line">  <span class="keyword">int</span> v2[<span class="number">50</span>]; <span class="comment">// [sp+20h] [bp-128h]@2</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [sp+E8h] [bp-60h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+ECh] [bp-5Ch]@1</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+F0h] [bp-58h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [sp+F4h] [bp-54h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [sp+F8h] [bp-50h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [sp+FCh] [bp-4Ch]@1</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [sp+100h] [bp-48h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [sp+104h] [bp-44h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [sp+108h] [bp-40h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [sp+10Ch] [bp-3Ch]@1</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [sp+114h] [bp-34h]@7</span></span><br><span class="line">  __int64 v14; <span class="comment">// [sp+118h] [bp-30h]@2</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// [sp+124h] [bp-24h]@2</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [sp+128h] [bp-20h]@2</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [sp+12Ch] [bp-1Ch]@1</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">2147122737</span>;</span><br><span class="line">  v4 = <span class="number">140540</span>;</span><br><span class="line">  v5 = <span class="number">-2008399303</span>;</span><br><span class="line">  v6 = <span class="number">141956</span>;</span><br><span class="line">  v7 = <span class="number">139457077</span>;</span><br><span class="line">  v8 = <span class="number">262023</span>;</span><br><span class="line">  v9 = <span class="number">-2008923597</span>;</span><br><span class="line">  v10 = <span class="number">143749</span>;</span><br><span class="line">  v11 = <span class="number">2118271985</span>;</span><br><span class="line">  v12 = <span class="number">143868</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(v2, <span class="number">0</span>, <span class="keyword">sizeof</span>(v2));</span><br><span class="line">    v16 = <span class="number">0</span>;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    v0 = *(&amp;v4 + <span class="number">2</span> * i);</span><br><span class="line">    LODWORD(v14) = *(&amp;v3 + <span class="number">2</span> * i);</span><br><span class="line">    HIDWORD(v14) = v0;</span><br><span class="line">    <span class="keyword">while</span> ( SHIDWORD(v14) &gt; <span class="number">0</span> || SHIDWORD(v14) &gt;= <span class="number">0</span> &amp;&amp; (_DWORD)v14 )</span><br><span class="line">    &#123;</span><br><span class="line">      v2[v16++] = ((SHIDWORD(v14) &gt;&gt; <span class="number">31</span>) ^ (((<span class="keyword">unsigned</span> __int8)(SHIDWORD(v14) &gt;&gt; <span class="number">31</span>) ^ (<span class="keyword">unsigned</span> __int8)v14)</span><br><span class="line">                                          - (<span class="keyword">unsigned</span> __int8)(SHIDWORD(v14) &gt;&gt; <span class="number">31</span>)) &amp; <span class="number">1</span>)</span><br><span class="line">                - (SHIDWORD(v14) &gt;&gt; <span class="number">31</span>);</span><br><span class="line">      v14 /= <span class="number">2L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">50</span>; j &gt;= <span class="number">0</span>; --j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v2[j] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v2[j] == <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">putchar</span>(<span class="number">42</span>);</span><br><span class="line">          ++v15;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">        ++v15;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !(v15 % <span class="number">5</span>) )</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>#define SHIDWORD(x)  (*((int32*)&amp;(x)+1))</p>
<p>_ques里。为什么呢</p>
<p>修改eip地址跳转</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-19_17-15-39.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-19_17-15-55.png" alt></p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-19_17-13-58.png" alt></p>
<p>HACKIT4FUN</p>
<blockquote>
<p>  wp上：函数窗口可以发现一个叫ques的未被调用的函数。</p>
</blockquote>
<p>完全看找不找得到。</p>
<h3 id="GXYCTF2019-simple-CPP"><a href="#GXYCTF2019-simple-CPP" class="headerlink" title="[GXYCTF2019]simple CPP"></a>[GXYCTF2019]simple CPP</h3><p>无壳64.</p>
<p>字符串里有，要绕过反调试</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-19_17-21-58.png" alt></p>
<p>函数有个std::_Lockit::~_Lockit(void)没看出什么</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_140001290</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">bool</span> v0; <span class="comment">// si@1</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax@1</span></span><br><span class="line">  <span class="keyword">void</span> *v2; <span class="comment">// rax@2</span></span><br><span class="line">  <span class="keyword">void</span> *v3; <span class="comment">// rbx@2</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// er10@5</span></span><br><span class="line">  __int64 v5; <span class="comment">// r11@6</span></span><br><span class="line">  <span class="keyword">void</span> *v6; <span class="comment">// r9@7</span></span><br><span class="line">  <span class="keyword">void</span> **v7; <span class="comment">// r8@9</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdi@12</span></span><br><span class="line">  __int64 v9; <span class="comment">// r15@12</span></span><br><span class="line">  __int64 v10; <span class="comment">// r12@12</span></span><br><span class="line">  __int64 v11; <span class="comment">// rbp@12</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v12; <span class="comment">// ecx@13</span></span><br><span class="line">  <span class="keyword">void</span> *v13; <span class="comment">// rdx@14</span></span><br><span class="line">  __int64 v14; <span class="comment">// rdi@15</span></span><br><span class="line">  <span class="keyword">void</span> *v15; <span class="comment">// r14@27</span></span><br><span class="line">  __int64 v16; <span class="comment">// rbp@29</span></span><br><span class="line">  __int64 v17; <span class="comment">// r13@29</span></span><br><span class="line">  <span class="keyword">void</span> *v18; <span class="comment">// rdi@29</span></span><br><span class="line">  __int64 v19; <span class="comment">// r12@32</span></span><br><span class="line">  __int64 v20; <span class="comment">// r15@32</span></span><br><span class="line">  __int64 v21; <span class="comment">// rbp@32</span></span><br><span class="line">  __int64 v22; <span class="comment">// rdx@32</span></span><br><span class="line">  __int64 v23; <span class="comment">// rbp@32</span></span><br><span class="line">  __int64 v24; <span class="comment">// rbp@34</span></span><br><span class="line">  __int64 v25; <span class="comment">// r10@34</span></span><br><span class="line">  __int64 v26; <span class="comment">// rdi@34</span></span><br><span class="line">  __int64 v27; <span class="comment">// r8@34</span></span><br><span class="line">  <span class="keyword">bool</span> v28; <span class="comment">// dl@34</span></span><br><span class="line">  __int64 v29; <span class="comment">// rax@40</span></span><br><span class="line">  <span class="keyword">void</span> *v30; <span class="comment">// rdx@40</span></span><br><span class="line">  __int64 v31; <span class="comment">// rax@42</span></span><br><span class="line">  __int64 v32; <span class="comment">// rax@44</span></span><br><span class="line">  <span class="keyword">void</span> *v33; <span class="comment">// rcx@46</span></span><br><span class="line">  __int64 v35; <span class="comment">// [sp+0h] [bp-88h]@50</span></span><br><span class="line">  __int64 v36; <span class="comment">// [sp+20h] [bp-68h]@29</span></span><br><span class="line">  <span class="keyword">void</span> *v37; <span class="comment">// [sp+28h] [bp-60h]@29</span></span><br><span class="line">  <span class="keyword">void</span> *Memory; <span class="comment">// [sp+30h] [bp-58h]@1</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v39; <span class="comment">// [sp+40h] [bp-48h]@1</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v40; <span class="comment">// [sp+48h] [bp-40h]@1</span></span><br><span class="line">  __int64 v41; <span class="comment">// [sp+50h] [bp-38h]@50</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="number">0</span>;</span><br><span class="line">  v39 = <span class="number">0</span>i64;</span><br><span class="line">  v40 = <span class="number">15</span>i64;</span><br><span class="line">  LOBYTE(Memory) = <span class="number">0</span>;</span><br><span class="line">  v1 = sub_1400019C0((__int64)<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">"I'm a first timer of Logic algebra , how about you?"</span>);</span><br><span class="line">  <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v1, sub_140001B90);</span><br><span class="line">  sub_1400019C0((__int64)<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">"Let's start our game,Please input your flag:"</span>);</span><br><span class="line">  sub_140001DE0((__int64)<span class="built_in">std</span>::<span class="built_in">cin</span>, (__int64)&amp;Memory);</span><br><span class="line">  <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::<span class="built_in">cout</span>, sub_140001B90);</span><br><span class="line">  <span class="keyword">if</span> ( v39 - <span class="number">5</span> &gt; <span class="number">0x19</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v32 = sub_1400019C0((__int64)<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">"Wrong input ,no GXY&#123;&#125; in input words"</span>);</span><br><span class="line">    <span class="built_in">std</span>::basic_ostream&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;::<span class="keyword">operator</span>&lt;&lt;(v32, sub_140001B90);</span><br><span class="line">    <span class="keyword">goto</span> LABEL_45;</span><br><span class="line">  &#125;</span><br><span class="line">  v2 = sub_1400024C8(<span class="number">0x20</span>ui64);</span><br><span class="line">  v3 = v2;</span><br><span class="line">  <span class="keyword">if</span> ( v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_QWORD *)v2 = <span class="number">0</span>i64;</span><br><span class="line">    *((_QWORD *)v2 + <span class="number">1</span>) = <span class="number">0</span>i64;</span><br><span class="line">    *((_QWORD *)v2 + <span class="number">2</span>) = <span class="number">0</span>i64;</span><br><span class="line">    *((_QWORD *)v2 + <span class="number">3</span>) = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v39 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = &amp;Memory;</span><br><span class="line">      <span class="keyword">if</span> ( v40 &gt;= <span class="number">0x10</span> )</span><br><span class="line">        v6 = Memory;</span><br><span class="line">      v7 = &amp;Dst;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int64)qword_140006060 &gt;= <span class="number">0x10</span> )</span><br><span class="line">        v7 = (<span class="keyword">void</span> **)Dst;</span><br><span class="line">      *((_BYTE *)v3 + v5) = *((_BYTE *)v6 + v5) ^ *((_BYTE *)v7 + v4++ % <span class="number">27</span>);</span><br><span class="line">      ++v5;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v4 &lt; v39 );</span><br><span class="line">  &#125;</span><br><span class="line">  v8 = <span class="number">0</span>i64;</span><br><span class="line">  v9 = <span class="number">0</span>i64;</span><br><span class="line">  v10 = <span class="number">0</span>i64;</span><br><span class="line">  v11 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v39 &gt; <span class="number">30</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_28;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v39 &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_28;</span><br><span class="line">  v13 = v3;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v14 = *(_BYTE *)v13 + v8;</span><br><span class="line">    ++v12;</span><br><span class="line">    v13 = (<span class="keyword">char</span> *)v13 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v12 == <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v11 = v14;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_24;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v12 == <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v10 = v14;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_24;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v12 == <span class="number">24</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = v14;</span><br><span class="line">LABEL_24:</span><br><span class="line">      v14 = <span class="number">0</span>i64;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_25;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v12 == <span class="number">32</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_1400019C0((__int64)<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">"ERRO,out of range"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_25:</span><br><span class="line">    v8 = v14 &lt;&lt; <span class="number">8</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v12 &lt; (<span class="keyword">signed</span> <span class="keyword">int</span>)v39 );</span><br><span class="line">  <span class="keyword">if</span> ( v11 )</span><br><span class="line">  &#123;</span><br><span class="line">    v15 = sub_1400024C8(<span class="number">0x20</span>ui64);</span><br><span class="line">    *(_QWORD *)v15 = v11;</span><br><span class="line">    *((_QWORD *)v15 + <span class="number">1</span>) = v10;</span><br><span class="line">    *((_QWORD *)v15 + <span class="number">2</span>) = v9;</span><br><span class="line">    *((_QWORD *)v15 + <span class="number">3</span>) = v8;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_28:</span><br><span class="line">  v15 = <span class="number">0</span>i64;</span><br><span class="line">LABEL_29:</span><br><span class="line">  v36 = *((_QWORD *)v15 + <span class="number">2</span>);</span><br><span class="line">  v16 = *((_QWORD *)v15 + <span class="number">1</span>);</span><br><span class="line">  v17 = *(_QWORD *)v15;</span><br><span class="line">  v18 = sub_14000223C(<span class="number">0x20</span>ui64);</span><br><span class="line">  v37 = v18;</span><br><span class="line">  <span class="keyword">if</span> ( IsDebuggerPresent() )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_1400019C0((__int64)<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">"Hi , DO not debug me !"</span>);</span><br><span class="line">    Sleep(<span class="number">0x7D0</span>u);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v19 = v16 &amp; v17;</span><br><span class="line">  *(_QWORD *)v18 = v16 &amp; v17;</span><br><span class="line">  v20 = v36 &amp; ~v17;</span><br><span class="line">  *((_QWORD *)v18 + <span class="number">1</span>) = v20;</span><br><span class="line">  v21 = ~v16;</span><br><span class="line">  v22 = v36 &amp; v21;</span><br><span class="line">  *((_QWORD *)v18 + <span class="number">2</span>) = v36 &amp; v21;</span><br><span class="line">  v23 = v17 &amp; v21;</span><br><span class="line">  *((_QWORD *)v18 + <span class="number">3</span>) = v23;</span><br><span class="line">  <span class="keyword">if</span> ( v20 != <span class="number">1176889593874</span>i64 )</span><br><span class="line">  &#123;</span><br><span class="line">    *((_QWORD *)v18 + <span class="number">1</span>) = <span class="number">0</span>i64;</span><br><span class="line">    v20 = <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  v24 = v20 | v19 | v22 | v23;</span><br><span class="line">  v25 = *((_QWORD *)v15 + <span class="number">1</span>);</span><br><span class="line">  v26 = *((_QWORD *)v15 + <span class="number">2</span>);</span><br><span class="line">  v27 = v22 &amp; *(_QWORD *)v15 | v26 &amp; (v19 | v25 &amp; ~*(_QWORD *)v15 | ~(v25 | *(_QWORD *)v15));</span><br><span class="line">  v28 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v27 == <span class="number">577031497978884115</span>i64 )</span><br><span class="line">    v28 = v24 == <span class="number">4483974544037412639</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( (v24 ^ *((_QWORD *)v15 + <span class="number">3</span>)) == <span class="number">4483974543195470111</span>i64 )</span><br><span class="line">    v0 = v28;</span><br><span class="line">  <span class="keyword">if</span> ( (v20 | v19 | v25 &amp; v26) != (~*(_QWORD *)v15 &amp; v26 | <span class="number">0xC00020130082C0C</span>i64) || v0 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_1400019C0((__int64)<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">"Wrong answer!try again"</span>);</span><br><span class="line">    j_j_free(v3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v29 = sub_1400019C0((__int64)<span class="built_in">std</span>::<span class="built_in">cout</span>, (__int64)<span class="string">"Congratulations!flag is GXY&#123;"</span>);</span><br><span class="line">    v30 = &amp;Memory;</span><br><span class="line">    <span class="keyword">if</span> ( v40 &gt;= <span class="number">0x10</span> )</span><br><span class="line">      v30 = Memory;</span><br><span class="line">    LODWORD(v31) = sub_140001FD0(v29, v30, v39);</span><br><span class="line">    sub_1400019C0(v31, (__int64)<span class="string">"&#125;"</span>);</span><br><span class="line">    j_j_free(v3);</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_45:</span><br><span class="line">  <span class="keyword">if</span> ( v40 &gt;= <span class="number">0x10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v33 = Memory;</span><br><span class="line">    <span class="keyword">if</span> ( v40 + <span class="number">1</span> &gt;= <span class="number">0x1000</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v33 = (<span class="keyword">void</span> *)*((_QWORD *)Memory - <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int64)((_BYTE *)Memory - (_BYTE *)v33 - <span class="number">8</span>) &gt; <span class="number">0x1F</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        invalid_parameter_noinfo_noreturn();</span><br><span class="line">        __debugbreak();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    j_j_free(v33);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_140002210((<span class="keyword">unsigned</span> __int64)&amp;v35 ^ v41);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v3=flag^Dst</p>
<p>v3分割后满足一系列条件</p>
<p>flag条件：</p>
<p>(v20 | v19 | v25 &amp; v26) == (~*(_QWORD *)v15 &amp; v26 | 0xC00020130082C0Ci64)</p>
<p>v0==1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">v36=v26=v15[<span class="number">2</span>]</span><br><span class="line">v17=v15[<span class="number">0</span>]</span><br><span class="line">v16=v25=v15[<span class="number">1</span>]</span><br><span class="line">v19 = v16 &amp; v17=v15[<span class="number">0</span>]&amp;v15[<span class="number">1</span>]</span><br><span class="line">v21 = ~v16=~v15[<span class="number">1</span>]</span><br><span class="line">v22 = v36 &amp; v21=v15[<span class="number">2</span>]&amp;(~v15[<span class="number">1</span>])</span><br><span class="line">v23 = v17 &amp; v21=v15[<span class="number">0</span>]&amp;(~v15[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">v20 = v15[<span class="number">2</span>] &amp; ~v15[<span class="number">0</span>]</span><br><span class="line">== <span class="number">1176889593874</span></span><br><span class="line">    </span><br><span class="line">v24 = v20 | (v15[<span class="number">1</span>] &amp; v15[<span class="number">0</span>]) | (v15[<span class="number">2</span>] &amp; (~v15[<span class="number">1</span>])) | (v15[<span class="number">0</span>]&amp;(~v15[<span class="number">1</span>]));</span><br><span class="line">==<span class="number">4483974544037412639</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">v27 =v15[<span class="number">2</span>]&amp;(~v15[<span class="number">1</span>])&amp; v15[<span class="number">0</span>] |v15[<span class="number">2</span>]&amp; ( (v15[<span class="number">0</span>]&amp;v15[<span class="number">1</span>]) | v15[<span class="number">1</span>] &amp; ~v15[<span class="number">0</span>] | ~(v15[<span class="number">1</span>] | v15[<span class="number">0</span>]) );</span><br><span class="line">==<span class="number">577031497978884115</span></span><br><span class="line">    </span><br><span class="line"><span class="number">4483974544037412639</span> ^ v15[<span class="number">3</span>] == <span class="number">4483974543195470111</span></span><br><span class="line"></span><br><span class="line">(v20 | (v15[<span class="number">0</span>]&amp;v15[<span class="number">1</span>]) | v15[<span class="number">1</span>] &amp; v15[<span class="number">2</span>]) == v15[<span class="number">0</span>] &amp; v15[<span class="number">2</span>] | <span class="number">0xC00020130082C0C</span></span><br></pre></td></tr></table></figure>

<p>给爷爬！！！！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#申明未知量</span></span><br><span class="line">v15 = [<span class="number">0</span>]*<span class="number">4</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    v15[i] = BitVec(<span class="string">'v15['</span>+str(i)+<span class="string">']'</span>,<span class="number">64</span>)</span><br><span class="line">s=Solver() <span class="comment"># 创建约束求解器</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加约束条件</span></span><br><span class="line">s.add(((v15[<span class="number">2</span>]&amp;~v15[<span class="number">1</span>])&amp;v15[<span class="number">0</span>]|v15[<span class="number">2</span>]&amp;((v15[<span class="number">1</span>]&amp;v15[<span class="number">0</span>])|v15[<span class="number">1</span>]&amp;~v15[<span class="number">0</span>]|~(v15[<span class="number">1</span>]|v15[<span class="number">0</span>])))==<span class="number">577031497978884115</span>)</span><br><span class="line">s.add(<span class="number">4483974544037412639</span> ^ v15[<span class="number">3</span>] == <span class="number">4483974543195470111</span>)</span><br><span class="line">s.add(v15[<span class="number">2</span>] &amp; ~v15[<span class="number">0</span>]== <span class="number">1176889593874</span>)</span><br><span class="line">s.add(<span class="number">1176889593874</span> | (v15[<span class="number">1</span>] &amp; v15[<span class="number">0</span>]) | (v15[<span class="number">2</span>] &amp; (~v15[<span class="number">1</span>])) | (v15[<span class="number">0</span>]&amp;(~v15[<span class="number">1</span>]))==<span class="number">4483974544037412639</span>)</span><br><span class="line">s.add((<span class="number">1176889593874</span> | (v15[<span class="number">0</span>]&amp;v15[<span class="number">1</span>]) | v15[<span class="number">1</span>] &amp; v15[<span class="number">2</span>]) == ~v15[<span class="number">0</span>] &amp; v15[<span class="number">2</span>] | <span class="number">864693332579200012</span>)</span><br><span class="line"><span class="comment"># 检查是否有解</span></span><br><span class="line"><span class="keyword">if</span> s.check()!=sat:</span><br><span class="line">    print( <span class="string">"unsat"</span>)</span><br><span class="line"></span><br><span class="line">m=s.model()</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> m.decls():   <span class="comment"># decls()返回model包含了所有符号的列表</span></span><br><span class="line">    print(<span class="string">"%s = %s"</span> % (d.name(),m[d]))</span><br></pre></td></tr></table></figure>

<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">v15[3]</span> = <span class="number">842073600</span></span><br><span class="line"><span class="attr">v15[2]</span> = <span class="number">577031497978884115</span></span><br><span class="line"><span class="attr">v15[0]</span> = <span class="number">4483973367147818765</span></span><br><span class="line"><span class="attr">v15[1]</span> = <span class="number">864693332579200012</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = &amp;Memory;</span><br><span class="line">      <span class="keyword">if</span> ( v40 &gt;= <span class="number">0x10</span> )</span><br><span class="line">        v6 = Memory;</span><br><span class="line">      v7 = &amp;Dst;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int64)qword_140006060 &gt;= <span class="number">0x10</span> )</span><br><span class="line">        v7 = (<span class="keyword">void</span> **)Dst;</span><br><span class="line">      *((_BYTE *)v3 + v5) = *((_BYTE *)v6 + v5) ^ *((_BYTE *)v7 + v4++ % <span class="number">27</span>);</span><br><span class="line">      ++v5;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v4 &lt; v39 );</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">v15=[<span class="number">0</span>]*<span class="number">4</span></span><br><span class="line">v15[<span class="number">0</span>] = <span class="number">4483973367147818765</span></span><br><span class="line">v15[<span class="number">2</span>] = <span class="number">577031497978884115</span></span><br><span class="line">v15[<span class="number">1</span>] = <span class="number">864693332579200012</span></span><br><span class="line">v15[<span class="number">3</span>] = <span class="number">842073600</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    v15[i]=hex(v15[i])</span><br><span class="line">    v15[i]=v15[i].replace(<span class="string">'L'</span>,<span class="string">''</span>)</span><br><span class="line">    v15[i]=v15[i].replace(<span class="string">'0x'</span>,<span class="string">''</span>)</span><br><span class="line"><span class="keyword">print</span> v15</span><br><span class="line">s=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v15:</span><br><span class="line">    s+=str(i)</span><br><span class="line"><span class="keyword">print</span> s</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">dst=<span class="string">"i_will_check_is_debug_or_not"</span></span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(s),<span class="number">2</span>):</span><br><span class="line">    flag+=chr(int(s[j]+s[j+<span class="number">1</span>],<span class="number">16</span>)^ord(dst[n%<span class="number">27</span>]))</span><br><span class="line">    n+=<span class="number">1</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<p>We1l_D0n╡Cx_氤梖bu`Yo|@nho。emmm有点问题。</p>
<p>看过wp后发现v15[1]错了。我淦，把v15全换成xyzw，一个一个比。</p>
<p>我淦，每个wp v15[1]好像都不一样。</p>
<p>s=”3e3a460533286f00000000000000000008020717153e3013323106”</p>
<p>We1l_D0check_is_lgebra_am_i</p>
<p>比赛给了二部分e!P0or_a</p>
<p>我逆了一下，应该是0d44335b301b2c3e80，这样会10进制244722044838787956352转的话没有第一个0。</p>
<h2 id="day16-5-20"><a href="#day16-5-20" class="headerlink" title="day16 5.20"></a>day16 5.20</h2><h3 id="xxor"><a href="#xxor" class="headerlink" title="xxor"></a>xxor</h3><p>应该在sub_400856里</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int64 <span class="title">sub_400856</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [sp+8h] [bp-68h]@1</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [sp+Ch] [bp-64h]@4</span></span><br><span class="line">  __int64 v3; <span class="comment">// [sp+10h] [bp-60h]@1</span></span><br><span class="line">  __int64 v4; <span class="comment">// [sp+18h] [bp-58h]@1</span></span><br><span class="line">  __int64 v5; <span class="comment">// [sp+20h] [bp-50h]@1</span></span><br><span class="line">  __int64 v6; <span class="comment">// [sp+28h] [bp-48h]@1</span></span><br><span class="line">  __int64 v7; <span class="comment">// [sp+30h] [bp-40h]@1</span></span><br><span class="line">  __int64 v8; <span class="comment">// [sp+40h] [bp-30h]@4</span></span><br><span class="line">  __int64 v9; <span class="comment">// [sp+48h] [bp-28h]@4</span></span><br><span class="line">  __int64 v10; <span class="comment">// [sp+50h] [bp-20h]@4</span></span><br><span class="line">  __int64 v11; <span class="comment">// [sp+58h] [bp-18h]@4</span></span><br><span class="line">  __int64 v12; <span class="comment">// [sp+60h] [bp-10h]@4</span></span><br><span class="line">  __int64 v13; <span class="comment">// [sp+68h] [bp-8h]@1</span></span><br><span class="line"></span><br><span class="line">  v13 = *MK_FP(__FS__, <span class="number">40L</span>L);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Let us play a game?"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"you have six chances to input"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Come on!"</span>);</span><br><span class="line">  v3 = <span class="number">0L</span>L;</span><br><span class="line">  v4 = <span class="number">0L</span>L;</span><br><span class="line">  v5 = <span class="number">0L</span>L;</span><br><span class="line">  v6 = <span class="number">0L</span>L;</span><br><span class="line">  v7 = <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s"</span>, <span class="number">4197072L</span>L, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)i);</span><br><span class="line">    __isoc99_scanf(<span class="number">4197083L</span>L, (<span class="keyword">char</span> *)&amp;v3 + <span class="number">4</span> * i);</span><br><span class="line">  &#125;</span><br><span class="line">  v8 = <span class="number">0L</span>L;</span><br><span class="line">  v9 = <span class="number">0L</span>L;</span><br><span class="line">  v10 = <span class="number">0L</span>L;</span><br><span class="line">  v11 = <span class="number">0L</span>L;</span><br><span class="line">  v12 = <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">4</span>; j += <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_601078 = *((_DWORD *)&amp;v3 + j);</span><br><span class="line">    dword_60107C = *((_DWORD *)&amp;v3 + j + <span class="number">1</span>);</span><br><span class="line">    sub_400686(<span class="number">6295672L</span>L, <span class="number">6295648L</span>L);</span><br><span class="line">    *((_DWORD *)&amp;v8 + j) = dword_601078;</span><br><span class="line">    *((_DWORD *)&amp;v8 + j + <span class="number">1</span>) = dword_60107C;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_400770((__int64)&amp;v8) != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"NO NO NO~ "</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Congratulation!\n"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"You seccess half\n"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Do not forget to change input to hex and combine~\n"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"ByeBye"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输入6个数字放在v3，v8还是v3，sub_400770(v8）==1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">sub_400770</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax@7</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)(a1 + <span class="number">8</span>) - *(_DWORD *)(a1 + <span class="number">12</span>) != <span class="number">2225223423L</span>L</span><br><span class="line">    || *(_DWORD *)(a1 + <span class="number">12</span>) + *(_DWORD *)(a1 + <span class="number">16</span>) != <span class="number">4201428739L</span>L</span><br><span class="line">    || *(_DWORD *)(a1 + <span class="number">8</span>) - *(_DWORD *)(a1 + <span class="number">16</span>) != <span class="number">1121399208L</span>L )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Wrong!"</span>);</span><br><span class="line">    result = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( *(_DWORD *)a1 != <span class="number">-548868226</span> || *(_DWORD *)(a1 + <span class="number">20</span>) != <span class="number">-2064448480</span> || *(_DWORD *)(a1 + <span class="number">4</span>) != <span class="number">550153460</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Wrong!"</span>);</span><br><span class="line">    result = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"good!"</span>);</span><br><span class="line">    result = <span class="number">1L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上z3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">v8 = [<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#申明未知量</span></span><br><span class="line">v8 = [<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    v8[i] = BitVec(<span class="string">'v8['</span>+str(i)+<span class="string">']'</span>,<span class="number">64</span>)</span><br><span class="line">s=Solver() <span class="comment"># 创建约束求解器</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加约束条件</span></span><br><span class="line">s.add(v8[<span class="number">2</span>]-v8[<span class="number">3</span>]==<span class="number">2225223423</span>)</span><br><span class="line">s.add(v8[<span class="number">3</span>]+v8[<span class="number">4</span>]==<span class="number">4201428739</span>)</span><br><span class="line">s.add(v8[<span class="number">2</span>]-v8[<span class="number">4</span>]==<span class="number">1121399208</span>)</span><br><span class="line">s.add(v8[<span class="number">0</span>]==<span class="number">0xDF48EF7E</span>)</span><br><span class="line">s.add(v8[<span class="number">5</span>]==<span class="number">0x84F30420</span>)</span><br><span class="line">s.add(v8[<span class="number">1</span>]== <span class="number">550153460</span>)</span><br><span class="line"><span class="comment"># 检查是否有解</span></span><br><span class="line"><span class="keyword">if</span> s.check()!=sat:</span><br><span class="line">    print( <span class="string">"unsat"</span>)</span><br><span class="line"></span><br><span class="line">m=s.model()</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> m.decls():   <span class="comment"># decls()返回model包含了所有符号的列表</span></span><br><span class="line">    print(<span class="string">"%s = %s"</span> % (d.name(),m[d]))</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">v8[4] = 2652626477</span></span><br><span class="line"><span class="string">v8[1] = 550153460</span></span><br><span class="line"><span class="string">v8[5] = 2230518816</span></span><br><span class="line"><span class="string">v8[0] = 3746099070</span></span><br><span class="line"><span class="string">v8[2] = 3774025685</span></span><br><span class="line"><span class="string">v8[3] = 1548802262</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>

<p>之后因为python整数范围原因位运算出错</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span>(disable:4996)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    __int64 a[<span class="number">6</span>] = &#123; <span class="number">3746099070</span>, <span class="number">550153460</span>, <span class="number">3774025685</span>, <span class="number">1548802262</span>, <span class="number">2652626477</span>, <span class="number">2230518816</span> &#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> a2[<span class="number">4</span>] = &#123; <span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> v3, v4;</span><br><span class="line">    <span class="keyword">int</span> v5;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">4</span>; j += <span class="number">2</span>) &#123;</span><br><span class="line">        v3 = a[j];</span><br><span class="line">        v4 = a[j + <span class="number">1</span>];</span><br><span class="line">        v5 = <span class="number">1166789954</span>*<span class="number">0x40</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0x3F</span>; ++i) &#123;</span><br><span class="line">            v4 -= (v3 + v5 + <span class="number">20</span>) ^ ((v3 &lt;&lt; <span class="number">6</span>) + a2[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">3</span>]) ^ <span class="number">0x10</span>;</span><br><span class="line">            v3 -= (v4 + v5 + <span class="number">11</span>) ^ ((v4 &lt;&lt; <span class="number">6</span>) + *a2) ^ ((v4 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">1</span>]) ^ <span class="number">0x20</span>;</span><br><span class="line">            v5 -= <span class="number">1166789954</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        a[j] = v3;</span><br><span class="line">        a[j + <span class="number">1</span>] = v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;hex&lt;&lt;a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; *((<span class="keyword">char</span>*)&amp;a[i] + <span class="number">2</span>) &lt;&lt; *((<span class="keyword">char</span>*)&amp;a[i] + <span class="number">1</span>) &lt;&lt;  * ((<span class="keyword">char</span>*)&amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//https://www.cnblogs.com/Mayfly-nymph/p/12669358.html</span></span><br></pre></td></tr></table></figure>

<h2 id="day17-5-21"><a href="#day17-5-21" class="headerlink" title="day17 5.21"></a>day17 5.21</h2><h3 id="BJDCTF2020-BJD-hamburger-competition"><a href="#BJDCTF2020-BJD-hamburger-competition" class="headerlink" title="[BJDCTF2020]BJD hamburger competition"></a>[BJDCTF2020]BJD hamburger competition</h3><p>也许世上没有老八，也去人人都是老八。</p>
<p>ida打开后搜BJD没有。</p>
<blockquote>
<p>  unity是用C#开发。C#是微软公司发布的一种由C和C++衍生出来的面向对象的编程语言、运行于.NET Framework和.NET Core(完全开源，跨平台)之上的高级程序设计语言。</p>
<p>  dnSpy 是一款针对 .NET 程序的逆向工程工具。</p>
</blockquote>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (ButtonSpawnFruit.Sha1(str) == <span class="string">"DD01903921EA24941C26A48F2CEC24E0BB0E8CC7"</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">this</span>.result = <span class="string">"BJDCTF&#123;"</span> + ButtonSpawnFruit.Md5(str) + <span class="string">"&#125;"</span>;</span><br><span class="line">	Debug.Log(<span class="keyword">this</span>.result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1001</p>
<p>b8c37e33defde51cf91e1e03e51657da</p>
<p>b8c37e33defde51cf91e</p>
<p>万万没想到是大写困扰了我。</p>
<h2 id="day18-5-22"><a href="#day18-5-22" class="headerlink" title="day18 5.22"></a>day18 5.22</h2><p><del>EPIC,永远的神</del></p>
<h3 id="usualcrypt"><a href="#usualcrypt" class="headerlink" title="usualcrypt"></a>usualcrypt</h3><p>32位</p>
<p>sub_403CF8是printf</p>
<p>sub_401080看着是base64，flag base64后传到v5</p>
<p>byte_40E0E4：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.data:<span class="number">0040E0</span>E4 byte_40E0E4     db <span class="number">7</span>Ah                  ; DATA XREF: _main+<span class="number">5</span>Cr</span><br><span class="line">.data:<span class="number">0040E0</span>E4                                         ; _main:loc_401238o</span><br><span class="line">.data:0040E0E5 aMxhz3tignxlxjh db 'MXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9',0</span><br></pre></td></tr></table></figure>

<p>MXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9</p>
<p>base64那应该改了</p>
<p>在sub_401000里</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> <span class="title">sub_401000</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> result; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// cl@2</span></span><br><span class="line"></span><br><span class="line">  result = <span class="number">6</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = byte_40E0AA[result];</span><br><span class="line">    byte_40E0AA[result] = byte_40E0A0[result];</span><br><span class="line">    byte_40E0A0[result++] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( result &lt; <span class="number">15</span> );</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> A0[<span class="number">100</span>]=<span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line">    <span class="keyword">signed</span> <span class="keyword">int</span> result; <span class="comment">// eax@1</span></span><br><span class="line">    <span class="keyword">char</span> v1; <span class="comment">// cl@2</span></span><br><span class="line">    result = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        v1 = A0[result+<span class="number">10</span>];</span><br><span class="line">        A0[result+<span class="number">10</span>] = A0[result];</span><br><span class="line">        A0[result] = v1;</span><br><span class="line">        result++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( result &lt; <span class="number">15</span> );</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;A0&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意byte_40E0A0和byte_40E0AA是挨着的。[byte_40E0AA]就是[byte_40E0A0+10]</p>
<p>ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+/</p>
<p>sub_401030里大小写转换</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v2 &lt; <span class="number">97</span> || v2 &gt; <span class="number">122</span> )                <span class="comment">// 97-122小写</span></span><br><span class="line">                                                <span class="comment">// </span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v2 &lt; <span class="number">65</span> || v2 &gt; <span class="number">90</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">        LOBYTE(result) = result + <span class="number">32</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(result) = result - <span class="number">32</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>所以flag，base64–byte_40E0AA–大小写</p>
<p>MXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">n=<span class="string">"ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line">o=<span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line">dic=dict(zip(n,o))</span><br><span class="line"><span class="comment">#print dic</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">a=<span class="string">"zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9"</span></span><br><span class="line">f=list(a)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(f)):</span><br><span class="line">    <span class="keyword">if</span> f[i]&lt;<span class="string">'a'</span> <span class="keyword">or</span> f[i]&gt;<span class="string">'z'</span>:</span><br><span class="line">        <span class="keyword">if</span> f[i]&gt;<span class="string">'A'</span> <span class="keyword">and</span> f[i]&lt;<span class="string">'Z'</span>:</span><br><span class="line">            f[i]=chr(ord(f[i])+<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f[i]=chr(ord(f[i])<span class="number">-32</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    flag+=dic[i]</span><br><span class="line"><span class="keyword">print</span> base64.b64decode(flag)</span><br></pre></td></tr></table></figure>

<p>真好flag{bAse64_2Y_a_Surprise}</p>
<p>为什么不对？？？</p>
<p>我的大小写好像有问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> f[i]&gt;<span class="string">'A'</span> <span class="keyword">and</span> f[i]&lt;<span class="string">'Z'</span>: <span class="comment">#没=</span></span><br></pre></td></tr></table></figure>

<h2 id="day19-5-23"><a href="#day19-5-23" class="headerlink" title="day19 5.23"></a>day19 5.23</h2><h3 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __<span class="function">noreturn <span class="title">start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  DWORD NumberOfBytesWritten; <span class="comment">// [sp+0h] [bp-4h]@1</span></span><br><span class="line"></span><br><span class="line">  NumberOfBytesWritten = <span class="number">0</span>;</span><br><span class="line">  hFile = GetStdHandle(<span class="number">0xFFFFFFF6</span>);</span><br><span class="line">  dword_403074 = GetStdHandle(<span class="number">0xFFFFFFF5</span>);</span><br><span class="line">  WriteFile(dword_403074, aG1v3M3T3hFl4g, <span class="number">0x13</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  sub_4010F0();</span><br><span class="line">  <span class="keyword">if</span> ( sub_401050(NumberOfBytesWritten) )</span><br><span class="line">    WriteFile(dword_403074, aG00dJ0b, <span class="number">0xA</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    WriteFile(dword_403074, aN0tT00H0tRWe_7, <span class="number">0x24</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  ExitProcess(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_4010F0把flag放到byte_403078</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> <span class="title">sub_401050</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// ST04_4@1</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [sp+4h] [bp-8h]@1</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> j; <span class="comment">// [sp+4h] [bp-8h]@4</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [sp+Bh] [bp-1h]@1</span></span><br><span class="line"></span><br><span class="line">  v0 = sub_401020(byte_403078);</span><br><span class="line">  v4 = sub_401000();</span><br><span class="line">  <span class="keyword">for</span> ( i = v0 - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_403180[i] = v4 ^ byte_403078[i];</span><br><span class="line">    v4 = byte_403078[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">0x27</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( byte_403180[j] != (<span class="keyword">unsigned</span> __int8)byte_403000[j] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v0是flag长度</p>
<p>v4：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int16 <span class="title">sub_401000</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// eax@1</span></span><br><span class="line"></span><br><span class="line">  v0 = __ROL4__(<span class="number">-2147024896</span>, <span class="number">4</span>);</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">unsigned</span> __int16)v0 &gt;&gt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ROL4没查到，但v4可以调出来，为4</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-05-23_17-03-35.png" alt></p>
<p>byte_403000里</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">.data:<span class="number">00403000</span> byte_403000     db <span class="number">0</span>Dh                 </span><br><span class="line">.data:<span class="number">00403001</span>                 db  <span class="number">26</span>h ; &amp;</span><br><span class="line">.data:<span class="number">00403002</span>                 db  <span class="number">49</span>h ; I</span><br><span class="line">.data:<span class="number">00403003</span>                 db  <span class="number">45</span>h ; E</span><br><span class="line">.data:<span class="number">00403004</span>                 db  <span class="number">2</span>Ah ; *</span><br><span class="line">.data:<span class="number">00403005</span>                 db  <span class="number">17</span>h</span><br><span class="line">.data:<span class="number">00403006</span>                 db  <span class="number">78</span>h ; x</span><br><span class="line">.data:<span class="number">00403007</span>                 db  <span class="number">44</span>h ; D</span><br><span class="line">.data:<span class="number">00403008</span>                 db  <span class="number">2B</span>h ; +</span><br><span class="line">.data:<span class="number">00403009</span>                 db  <span class="number">6</span>Ch ; l</span><br><span class="line">.data:<span class="number">0040300</span>A                 db  <span class="number">5</span>Dh ; ]</span><br><span class="line">.data:<span class="number">0040300B</span>                 db  <span class="number">5</span>Eh ; ^</span><br><span class="line">.data:<span class="number">0040300</span>C                 db  <span class="number">45</span>h ; E</span><br><span class="line">.data:<span class="number">0040300</span>D                 db  <span class="number">12</span>h</span><br><span class="line">.data:<span class="number">0040300</span>E                 db  <span class="number">2F</span>h ; /</span><br><span class="line">.data:<span class="number">0040300F</span>                 db  <span class="number">17</span>h</span><br><span class="line">.data:<span class="number">00403010</span>                 db  <span class="number">2B</span>h ; +</span><br><span class="line">.data:<span class="number">00403011</span>                 db  <span class="number">44</span>h ; D</span><br><span class="line">.data:<span class="number">00403012</span>                 db  <span class="number">6F</span>h ; o</span><br><span class="line">.data:<span class="number">00403013</span>                 db  <span class="number">6</span>Eh ; n</span><br><span class="line">.data:<span class="number">00403014</span>                 db  <span class="number">56</span>h ; V</span><br><span class="line">.data:<span class="number">00403015</span>                 db    <span class="number">9</span></span><br><span class="line">.data:<span class="number">00403016</span>                 db  <span class="number">5F</span>h ; _</span><br><span class="line">.data:<span class="number">00403017</span>                 db  <span class="number">45</span>h ; E</span><br><span class="line">.data:<span class="number">00403018</span>                 db  <span class="number">47</span>h ; G</span><br><span class="line">.data:<span class="number">00403019</span>                 db  <span class="number">73</span>h ; s</span><br><span class="line">.data:<span class="number">0040301</span>A                 db  <span class="number">26</span>h ; &amp;</span><br><span class="line">.data:<span class="number">0040301B</span>                 db  <span class="number">0</span>Ah</span><br><span class="line">.data:<span class="number">0040301</span>C                 db  <span class="number">0</span>Dh</span><br><span class="line">.data:<span class="number">0040301</span>D                 db  <span class="number">13</span>h</span><br><span class="line">.data:<span class="number">0040301</span>E                 db  <span class="number">17</span>h</span><br><span class="line">.data:<span class="number">0040301F</span>                 db  <span class="number">48</span>h ; H</span><br><span class="line">.data:<span class="number">00403020</span>                 db  <span class="number">42</span>h ; B</span><br><span class="line">.data:<span class="number">00403021</span>                 db    <span class="number">1</span></span><br><span class="line">.data:<span class="number">00403022</span>                 db  <span class="number">40</span>h ; @</span><br><span class="line">.data:<span class="number">00403023</span>                 db  <span class="number">4</span>Dh ; M</span><br><span class="line">.data:<span class="number">00403024</span>                 db  <span class="number">0</span>Ch</span><br><span class="line">.data:<span class="number">00403025</span>                 db    <span class="number">2</span></span><br><span class="line">.data:<span class="number">00403026</span>                 db  <span class="number">69</span>h ; i</span><br><span class="line">.data:<span class="number">00403027</span>                 db    <span class="number">0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">b= [<span class="number">0x0D</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x45</span>,<span class="number">0x2A</span>,<span class="number">0x17</span>,<span class="number">0x78</span>,<span class="number">0x44</span>,<span class="number">0x2B</span>,<span class="number">0x6C</span>,<span class="number">0x5D</span>,<span class="number">0x5E</span>,<span class="number">0x45</span>,<span class="number">0x12</span>,<span class="number">0x2F</span>,<span class="number">0x17</span>,<span class="number">0x2B</span>,<span class="number">0x44</span>,<span class="number">0x6F</span>,<span class="number">0x6E</span>,<span class="number">0x56</span>,<span class="number">0x09</span>,<span class="number">0x5F</span>,<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x0A</span>,<span class="number">0x0D</span>,<span class="number">0x13</span>,<span class="number">0x17</span>,<span class="number">0x48</span>,</span><br><span class="line"><span class="number">0x42</span>,<span class="number">0x01</span>,<span class="number">0x40</span>,<span class="number">0x4D</span>,<span class="number">0x0C</span>,<span class="number">0x02</span>,<span class="number">0x69</span>]</span><br><span class="line">v=<span class="number">4</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x27</span><span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">    flag+=chr(v^b[i])</span><br><span class="line">    v=v^b[i]</span><br><span class="line"><span class="keyword">print</span> flag[<span class="number">-1</span>::<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>

<h3 id="rome"><a href="#rome" class="headerlink" title="rome"></a>rome</h3><p>32位无壳</p>
<p>falg16位，变换</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( *((_BYTE *)&amp;v1 + i) &gt; <span class="string">'@'</span> &amp;&amp; *((_BYTE *)&amp;v1 + i) &lt;= <span class="string">'Z'</span> )</span><br><span class="line">                  *((_BYTE *)&amp;v1 + i) = (*((_BYTE *)&amp;v1 + i) - <span class="number">51</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">                <span class="keyword">if</span> ( *((_BYTE *)&amp;v1 + i) &gt; <span class="string">'`'</span> &amp;&amp; *((_BYTE *)&amp;v1 + i) &lt;= <span class="string">'z'</span> )</span><br><span class="line">                  *((_BYTE *)&amp;v1 + i) = (*((_BYTE *)&amp;v1 + i) - <span class="number">79</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">              &#125;</span><br></pre></td></tr></table></figure>

<p>后为</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">v15 = <span class="number">81</span>;</span><br><span class="line">v16 = <span class="number">115</span>;</span><br><span class="line">v17 = <span class="number">119</span>;</span><br><span class="line">v18 = <span class="number">51</span>;</span><br><span class="line">v19 = <span class="number">115</span>;</span><br><span class="line">v20 = <span class="number">106</span>;</span><br><span class="line">v21 = <span class="number">95</span>;</span><br><span class="line">v22 = <span class="number">108</span>;</span><br><span class="line">v23 = <span class="number">122</span>;</span><br><span class="line">v24 = <span class="number">52</span>;</span><br><span class="line">v25 = <span class="number">95</span>;</span><br><span class="line">v26 = <span class="number">85</span>;</span><br><span class="line">v27 = <span class="number">106</span>;</span><br><span class="line">v28 = <span class="number">119</span>;</span><br><span class="line">v29 = <span class="number">64</span>;</span><br><span class="line">v30 = <span class="number">108</span>;</span><br></pre></td></tr></table></figure>

<h2 id="day20-5-24"><a href="#day20-5-24" class="headerlink" title="day20 5.24"></a>day20 5.24</h2><p>gkctf的签到</p>
<h2 id="day21-5-25"><a href="#day21-5-25" class="headerlink" title="day21 5.25"></a>day21 5.25</h2><h3 id="19红帽-xx"><a href="#19红帽-xx" class="headerlink" title="[19红帽]xx"></a>[19红帽]xx</h3><p>无壳64</p>
<p>sub_1400011A0</p>
<p>code是qwertyuiopasdfghjklzxcvbnm1234567890</p>
<p>v3=len(code)=19</p>
<p>v4=sub_140001620(5) molloc(5)</p>
<p>v5 = *(_QWORD *)&amp;::Code;<br>v6 = v4<br>v7 = 0;<br>v8 = v4</p>
<p>最下面的的比较</p>
<p>v24 = (_BYTE *)v19 - (_BYTE *)&v30;</p>
<p>if ( *((_BYTE *)&amp;v30 + v25) != *((_BYTE *)&amp;v30 + v25 + v24) )</p>
<p>所以&amp;v30=&amp;v19</p>
<p>异或</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( *((_BYTE *)v19 + <span class="number">23</span>) = *((_BYTE *)v18 + <span class="number">21</span>); v20 &lt; v17; ++v21 )</span><br><span class="line">&#123;</span><br><span class="line">  v22 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( v20 / <span class="number">3</span> &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v23 = *(_BYTE *)v21;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v23 ^= *((_BYTE *)v19 + v22++);</span><br><span class="line">      *(_BYTE *)v21 = v23;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v22 &lt; v20 / <span class="number">3</span> );</span><br><span class="line">  &#125;</span><br><span class="line">++v20;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_140001AB0里是xxtea</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(v34 - <span class="number">1</span>) += ((v27 ^ v38) + (v29 ^ v18[v39])) ^ ((<span class="number">16</span> * v29 ^ (v38 &gt;&gt; <span class="number">3</span>)) + ((v29 &gt;&gt; <span class="number">5</span>) ^ <span class="number">4</span> * v38));</span><br></pre></td></tr></table></figure>

<p>和下面一样</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define MX (((<span class="name">z&gt;&gt;5</span>^y&lt;&lt;2) + (<span class="name">y&gt;&gt;3</span>^z&lt;&lt;4)) ^ ((<span class="name">sum</span>^y) + (<span class="name">key</span>[(<span class="name">p&amp;3</span>)^e] ^ z)))</span><br></pre></td></tr></table></figure>

<p>知识点里xxtea是纯数字的，后来找到了<a href="https://blog.csdn.net/cserchen/article/details/8238641" target="_blank" rel="noopener">https://blog.csdn.net/cserchen/article/details/8238641</a> python实现的字符串加解密。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">result = <span class="string">'CEBC406B7C3A95C0EF9B202091F70235231802C8E75656FA'</span></span><br><span class="line"></span><br><span class="line">data=[<span class="number">0</span>]*(len(result)/<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(result),<span class="number">2</span>):</span><br><span class="line">    data[i/<span class="number">2</span>]=int((<span class="string">'0x'</span>+result[i]+result[i+<span class="number">1</span>]),<span class="number">16</span>)</span><br><span class="line"><span class="comment">#print len(data)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(i//<span class="number">3</span>):</span><br><span class="line">        data[i] ^= data[j]</span><br><span class="line"></span><br><span class="line">h = [<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">18</span>,<span class="number">16</span>,<span class="number">19</span>,<span class="number">17</span>,<span class="number">22</span>,<span class="number">20</span>,<span class="number">23</span>,<span class="number">21</span>]</span><br><span class="line">c = [<span class="number">1</span>]*<span class="number">24</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">24</span>):</span><br><span class="line">    c[h[i]] = data[i]</span><br><span class="line">print(c)</span><br><span class="line">cc=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    <span class="comment">#确保两位</span></span><br><span class="line">    <span class="keyword">if</span> i&lt;<span class="number">16</span>:</span><br><span class="line">        cc+=<span class="string">'0'</span> </span><br><span class="line">    cc+=str(hex(i)).replace(<span class="string">'0x'</span>,<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> cc</span><br><span class="line"><span class="keyword">print</span> len(cc)</span><br><span class="line">strc=binascii.a2b_hex(cc) </span><br><span class="line">   </span><br><span class="line"><span class="comment">############################################################  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># The implementation of PHPRPC Protocol 3.0                #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># xxtea.py                                                 #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># Release 3.0.0                                            #  </span></span><br><span class="line"><span class="comment"># Copyright (c) 2005-2008 by Team-PHPRPC                   #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># WebSite:  http://www.phprpc.org/                         #  </span></span><br><span class="line"><span class="comment">#           http://www.phprpc.net/                         #  </span></span><br><span class="line"><span class="comment">#           http://www.phprpc.com/                         #  </span></span><br><span class="line"><span class="comment">#           http://sourceforge.net/projects/php-rpc/       #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># Authors:  Ma Bingyao &lt;andot@ujn.edu.cn&gt;                  #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># This file may be distributed and/or modified under the   #  </span></span><br><span class="line"><span class="comment"># terms of the GNU Lesser General Public License (LGPL)    #  </span></span><br><span class="line"><span class="comment"># version 3.0 as published by the Free Software Foundation #  </span></span><br><span class="line"><span class="comment"># and appearing in the included file LICENSE.              #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment">############################################################  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># XXTEA encryption arithmetic library.  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># Copyright (C) 2005-2008 Ma Bingyao &lt;andot@ujn.edu.cn&gt;  </span></span><br><span class="line"><span class="comment"># Version: 1.0  </span></span><br><span class="line"><span class="comment"># LastModified: Oct 5, 2008  </span></span><br><span class="line"><span class="comment"># This library is free.  You can redistribute it and/or modify it.  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> struct  </span><br><span class="line">  </span><br><span class="line">_DELTA = <span class="number">0x9E3779B9</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_long2str</span><span class="params">(v, w)</span>:</span>  </span><br><span class="line">    n = (len(v) - <span class="number">1</span>) &lt;&lt; <span class="number">2</span>  </span><br><span class="line">    <span class="keyword">if</span> w:  </span><br><span class="line">        m = v[<span class="number">-1</span>]  </span><br><span class="line">        <span class="keyword">if</span> (m &lt; n - <span class="number">3</span>) <span class="keyword">or</span> (m &gt; n): <span class="keyword">return</span> <span class="string">''</span>  </span><br><span class="line">        n = m  </span><br><span class="line">    s = struct.pack(<span class="string">'&lt;%iL'</span> % len(v), *v)  </span><br><span class="line">    <span class="keyword">return</span> s[<span class="number">0</span>:n] <span class="keyword">if</span> w <span class="keyword">else</span> s  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_str2long</span><span class="params">(s, w)</span>:</span>  </span><br><span class="line">    n = len(s)  </span><br><span class="line">    m = (<span class="number">4</span> - (n &amp; <span class="number">3</span>) &amp; <span class="number">3</span>) + n  </span><br><span class="line">    s = s.ljust(m, <span class="string">"\0"</span>)  </span><br><span class="line">    v = list(struct.unpack(<span class="string">'&lt;%iL'</span> % (m &gt;&gt; <span class="number">2</span>), s))  </span><br><span class="line">    <span class="keyword">if</span> w: v.append(n)  </span><br><span class="line">    <span class="keyword">return</span> v  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(str, key)</span>:</span>  </span><br><span class="line">    <span class="keyword">if</span> str == <span class="string">''</span>: <span class="keyword">return</span> str  </span><br><span class="line">    v = _str2long(str, <span class="literal">True</span>)  </span><br><span class="line">    k = _str2long(key.ljust(<span class="number">16</span>, <span class="string">"\0"</span>), <span class="literal">False</span>)  </span><br><span class="line">    n = len(v) - <span class="number">1</span>  </span><br><span class="line">    z = v[n]  </span><br><span class="line">    y = v[<span class="number">0</span>]  </span><br><span class="line">    sum = <span class="number">0</span>  </span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> // (n + <span class="number">1</span>)  </span><br><span class="line">    <span class="keyword">while</span> q &gt; <span class="number">0</span>:  </span><br><span class="line">        sum = (sum + _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        e = sum &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span>  </span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> xrange(n):  </span><br><span class="line">            y = v[p + <span class="number">1</span>]  </span><br><span class="line">            v[p] = (v[p] + ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (sum ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">            z = v[p]  </span><br><span class="line">        y = v[<span class="number">0</span>]  </span><br><span class="line">        v[n] = (v[n] + ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (sum ^ y) + (k[n &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        z = v[n]  </span><br><span class="line">        q -= <span class="number">1</span>  </span><br><span class="line">    <span class="keyword">return</span> _long2str(v, <span class="literal">False</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(str, key)</span>:</span>  </span><br><span class="line">    <span class="keyword">if</span> str == <span class="string">''</span>: <span class="keyword">return</span> str  </span><br><span class="line">    v = _str2long(str, <span class="literal">False</span>)  </span><br><span class="line">    k = _str2long(key.ljust(<span class="number">16</span>, <span class="string">"\0"</span>), <span class="literal">False</span>)  </span><br><span class="line">    n = len(v) - <span class="number">1</span>  </span><br><span class="line">    z = v[n]  </span><br><span class="line">    y = v[<span class="number">0</span>]  </span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> // (n + <span class="number">1</span>)  </span><br><span class="line">    sum = (q * _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">    <span class="keyword">while</span> (sum != <span class="number">0</span>):  </span><br><span class="line">        e = sum &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span>  </span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> xrange(n, <span class="number">0</span>, <span class="number">-1</span>):  </span><br><span class="line">            z = v[p - <span class="number">1</span>]  </span><br><span class="line">            v[p] = (v[p] - ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (sum ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">            y = v[p]  </span><br><span class="line">        z = v[n]  </span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (sum ^ y) + (k[<span class="number">0</span> &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        y = v[<span class="number">0</span>]  </span><br><span class="line">        sum = (sum - _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">    <span class="keyword">return</span> _long2str(v, <span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">key = <span class="string">'flag'</span></span><br><span class="line">flag = decrypt(strc, key)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<h2 id="day22-5-27"><a href="#day22-5-27" class="headerlink" title="day22 5.27"></a>day22 5.27</h2><h3 id="MRCTF2020-Transform"><a href="#MRCTF2020-Transform" class="headerlink" title="[MRCTF2020]Transform"></a>[MRCTF2020]Transform</h3><p>64无壳</p>
<p>简单的转换</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int64 <span class="title">sub_401530</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> Str[<span class="number">104</span>]; <span class="comment">// [sp+20h] [bp-70h]@1</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [sp+88h] [bp-8h]@7</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [sp+8Ch] [bp-4h]@4</span></span><br><span class="line"></span><br><span class="line">  sub_402230();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Give me your code:\n"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, Str);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str) != <span class="number">33</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Wrong!\n"</span>);</span><br><span class="line">    system(<span class="string">"pause"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_414040[i] = Str[dword_40F040[i]];</span><br><span class="line">    byte_414040[i] ^= LOBYTE(dword_40F040[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">32</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( byte_40F0E0[j] != byte_414040[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Wrong!\n"</span>);</span><br><span class="line">      system(<span class="string">"pause"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Right!Good Job!\n"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Here is your flag: %s\n"</span>);</span><br><span class="line">  system(<span class="string">"pause"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输入str，33位</p>
<p> byte_414040[i] = Str[dword_40F040[i]];</p>
<p>byte_414040[i] ^= LOBYTE(dword_40F040[i]);</p>
<p>LOBYTE()得到一个16bit数最低（最右边）那个字节,用&amp;0xff就好。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.data:<span class="number">000000000040F</span>040 dword_40F040    dd <span class="number">9</span>, <span class="number">0</span>Ah, <span class="number">0F</span>h, <span class="number">17</span>h, <span class="number">7</span>, <span class="number">18</span>h, <span class="number">0</span>Ch, <span class="number">6</span>, <span class="number">1</span>, <span class="number">10</span>h, <span class="number">3</span>, <span class="number">11</span>h, <span class="number">20</span>h</span><br><span class="line">.data:<span class="number">000000000040F</span>040                                         ; DATA XREF: sub_401530+<span class="number">79</span>o</span><br><span class="line">.data:<span class="number">000000000040F</span>040                                         ; sub_401530+B8o</span><br><span class="line">.data:<span class="number">000000000040F</span>040                 dd <span class="number">1</span>Dh, <span class="number">0B</span>h, <span class="number">1</span>Eh, <span class="number">1B</span>h, <span class="number">16</span>h, <span class="number">4</span>, <span class="number">0</span>Dh, <span class="number">13</span>h, <span class="number">14</span>h, <span class="number">15</span>h, <span class="number">2</span>, <span class="number">19</span>h</span><br><span class="line">.data:<span class="number">000000000040F</span>040                 dd <span class="number">5</span>, <span class="number">1F</span>h, <span class="number">8</span>, <span class="number">12</span>h, <span class="number">1</span>Ah, <span class="number">1</span>Ch, <span class="number">0</span>Eh, <span class="number">8</span> dup(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.data:</span>000000000040F0E0 byte_40F0E0     <span class="built_in">db</span> <span class="number">67h</span>, <span class="number">79h</span>, <span class="number">7Bh</span>, <span class="number">7Fh</span>, <span class="number">75h</span>, <span class="number">2Bh</span>, <span class="number">3Ch</span>, <span class="number">52h</span>, <span class="number">53h</span>, <span class="number">79h</span>, <span class="number">57h</span></span><br><span class="line"><span class="symbol">.data:</span>000000000040F0E0                                         <span class="comment">; DATA XREF: sub_401530+EFo</span></span><br><span class="line"><span class="symbol">.data:</span>000000000040F0E0                 <span class="built_in">db</span> <span class="number">5Eh</span>, <span class="number">5Dh</span>, <span class="number">42h</span>, <span class="number">7Bh</span>, <span class="number">2Dh</span>, <span class="number">2Ah</span>, <span class="number">66h</span>, <span class="number">42h</span>, <span class="number">7Eh</span>, <span class="number">4Ch</span>, <span class="number">57h</span></span><br><span class="line"><span class="symbol">.data:</span>000000000040F0E0                 <span class="built_in">db</span> <span class="number">79h</span>, <span class="number">41h</span>, <span class="number">6Bh</span>, <span class="number">7Eh</span>, <span class="number">65h</span>, <span class="number">3Ch</span>, <span class="number">5Ch</span>, <span class="number">45h</span>, <span class="number">6Fh</span>, <span class="number">62h</span>, <span class="number">4Dh</span></span><br><span class="line"><span class="symbol">.data:</span>000000000040F0E0                 <span class="built_in">db</span> <span class="number">3Fh</span> dup(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">'9, 0Ah, 0Fh, 17h, 7, 18h, 0Ch, 6, 1, 10h, 3, 11h, 20h,1Dh, 0Bh, 1Eh, 1Bh, 16h, 4, 0Dh, 13h, 14h, 15h, 2, 19h,5, 1Fh, 8, 12h, 1Ah, 1Ch, 0Eh, 0'</span></span><br><span class="line">eflag=<span class="string">'67h, 79h, 7Bh, 7Fh, 75h, 2Bh, 3Ch, 52h, 53h, 79h, 57h,5Eh, 5Dh, 42h, 7Bh, 2Dh, 2Ah, 66h, 42h, 7Eh, 4Ch, 57h,79h, 41h, 6Bh, 7Eh, 65h, 3Ch, 5Ch, 45h, 6Fh, 62h, 4Dh'</span></span><br><span class="line">flag=[<span class="number">0</span>]*<span class="number">33</span></span><br><span class="line"></span><br><span class="line">base=a.split(<span class="string">','</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(base)):</span><br><span class="line">    base[i]=int((<span class="string">'0x'</span>+base[i]).replace(<span class="string">'h'</span>,<span class="string">''</span>).replace(<span class="string">' '</span>,<span class="string">''</span>),<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> len(base)</span><br><span class="line"></span><br><span class="line">ef=eflag.split(<span class="string">','</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(ef)):</span><br><span class="line">    ef[i]=int((<span class="string">'0x'</span>+ef[i]).replace(<span class="string">'h'</span>,<span class="string">''</span>).replace(<span class="string">' '</span>,<span class="string">''</span>),<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> len(ef)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">33</span>):</span><br><span class="line">    flag[base[i]]=ef[i]^base[i]</span><br><span class="line">s=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    s+=chr(i)</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure>

<h3 id="HDCTF2019-Maze"><a href="#HDCTF2019-Maze" class="headerlink" title="[HDCTF2019]Maze"></a>[HDCTF2019]Maze</h3><p>Maze迷宫，junk是废物垃圾，感觉是要找东西。</p>
<p>有壳</p>
<p>迷宫是</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="strong">*****</span><span class="strong">**+**</span><span class="strong">*****</span><span class="strong">** **</span><span class="strong">****    **</span><span class="strong">**   **</span><span class="strong">*****</span> <span class="strong">**F**</span><span class="strong">****    **</span><span class="strong">*****</span><span class="strong">*****</span>**</span><br></pre></td></tr></table></figure>

<p>后面写了7，所以要吗7要么10</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">maze=<span class="string">'*******+********* ******    ****   ******* **F******    **************'</span></span><br><span class="line"><span class="keyword">print</span> len(maze)</span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">f=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> maze:</span><br><span class="line">    a+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i==<span class="string">' '</span>:</span><br><span class="line">        f+=<span class="string">'='</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f+=i</span><br><span class="line">    <span class="keyword">if</span> a%<span class="number">10</span>==<span class="number">0</span>:</span><br><span class="line">        f+=<span class="string">'\n'</span></span><br><span class="line"><span class="keyword">print</span> f</span><br></pre></td></tr></table></figure>

<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">70</span><br><span class="line">******<span class="strong">*+*</span><span class="strong">*</span></span><br><span class="line"><span class="strong">*</span>*****<span class="strong">*=*</span><span class="strong">*</span></span><br><span class="line"><span class="strong">*</span>**<span class="strong">*====*</span><span class="strong">*</span></span><br><span class="line"><span class="strong">*</span><span class="strong">*===*</span>***<span class="strong">*</span></span><br><span class="line"><span class="strong">*</span><span class="strong">*=*</span><span class="strong">*F*</span>**<span class="strong">*</span></span><br><span class="line"><span class="strong">*</span><span class="strong">*====*</span>**<span class="strong">*</span></span><br><span class="line"><span class="strong">*</span>********<span class="strong">*</span></span><br></pre></td></tr></table></figure>

<p>下下左左左下左左下下右右右上</p>
<p>emmmm，flag{ssaaasaassdddw}</p>
<p>main函数奇怪数据强制转换</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0040102C</span>                 <span class="selector-tag">jnz</span>     <span class="selector-tag">short</span> <span class="selector-tag">near</span> <span class="selector-tag">ptr</span> <span class="selector-tag">byte_40102F</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0040102C</span> ; <span class="selector-tag">---------------------------------------------------------------------------</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0040102E</span>                 <span class="selector-tag">db</span> 0<span class="selector-tag">E8h</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:0040102F</span> <span class="selector-tag">byte_40102F</span>     <span class="selector-tag">db</span> 58<span class="selector-tag">h</span>                  ; <span class="selector-tag">CODE</span> <span class="selector-tag">XREF</span>: <span class="selector-class">.text</span><span class="selector-pseudo">:0040102C</span><span class="selector-tag">j</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:00401030</span>                 <span class="selector-tag">dd</span> 0<span class="selector-tag">EC45C7h</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:00401034</span>                 <span class="selector-tag">db</span> 2 <span class="selector-tag">dup</span>(0)</span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:00401036</span> ; <span class="selector-tag">---------------------------------------------------------------------------</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:00401036</span>                 <span class="selector-tag">add</span>     <span class="selector-tag">bl</span>, <span class="selector-tag">ch</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:00401038</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:00401038</span> <span class="selector-tag">loc_401038</span>:                             ; <span class="selector-tag">CODE</span> <span class="selector-tag">XREF</span>: <span class="selector-class">.text</span><span class="selector-pseudo">:loc_4010B4</span><span class="selector-tag">j</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>  花指令是，由<a href="https://baike.baidu.com/item/设计者/514381" target="_blank" rel="noopener">设计者</a>特别构思，希望使<a href="https://baike.baidu.com/item/反汇编/10858476" target="_blank" rel="noopener">反汇编</a>的时候出错，让破解者无法清楚正确地<a href="https://baike.baidu.com/item/反汇编程序" target="_blank" rel="noopener">反汇编程序</a>的内容，迷失方向。经典的是，目标位置是另一条指令的中间，这样在反汇编的时候便会出现混乱。花指令有可能利用各种指令：<a href="https://baike.baidu.com/item/jmp/2149772" target="_blank" rel="noopener">jmp</a>, call, ret的一些<a href="https://baike.baidu.com/item/堆栈/1682032" target="_blank" rel="noopener">堆栈</a>技巧，位置运算，等等。</p>
</blockquote>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( <span class="built_in">i</span> = <span class="number">0</span>; <span class="built_in">i</span> &lt;= <span class="number">13</span>; ++<span class="built_in">i</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">switch</span> ( v5[<span class="built_in">i</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'w'</span>:</span><br><span class="line">      ++dword_40807C;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'s'</span>:</span><br><span class="line">      --dword_40807C;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'a'</span>:</span><br><span class="line">      --dword_408078;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'d'</span>:</span><br><span class="line">      ++dword_408078;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    default:</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>od nop</p>
<p>保存文件。</p>
<p>洗衣服啊啊啊。</p>
<h2 id="day23-5-29"><a href="#day23-5-29" class="headerlink" title="day23 5.29"></a>day23 5.29</h2><h3 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h3><p>有个output</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">stream = fopen(<span class="string">"flag"</span>, <span class="string">"r"</span>)<span class="comment">;</span></span><br><span class="line">fread(<span class="name">ptr</span>, <span class="number">1</span>uLL, <span class="number">0</span>x14uLL, stream)<span class="comment">;</span></span><br><span class="line">fclose(<span class="name">stream</span>)<span class="comment">;</span></span><br><span class="line">for ( <span class="name">i</span> = <span class="number">1</span><span class="comment">; i &lt;= 19; ++i )</span></span><br><span class="line">&#123;</span><br><span class="line">  if ( <span class="name">i</span> &amp; <span class="number">1</span> )</span><br><span class="line">    printf(<span class="string">"%ld\n"</span>, (<span class="name">unsigned</span> int)(<span class="name">ptr</span>[i] &lt;&lt; i))<span class="comment">;</span></span><br><span class="line">  else</span><br><span class="line">    printf(<span class="string">"%ld\n"</span>, (<span class="name">unsigned</span> int)(<span class="name">i</span> * ptr[i]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag19位</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">'''222</span></span><br><span class="line"><span class="string">198</span></span><br><span class="line"><span class="string">232</span></span><br><span class="line"><span class="string">816</span></span><br><span class="line"><span class="string">200</span></span><br><span class="line"><span class="string">1536</span></span><br><span class="line"><span class="string">300</span></span><br><span class="line"><span class="string">6144</span></span><br><span class="line"><span class="string">984</span></span><br><span class="line"><span class="string">51200</span></span><br><span class="line"><span class="string">570</span></span><br><span class="line"><span class="string">92160</span></span><br><span class="line"><span class="string">1200</span></span><br><span class="line"><span class="string">565248</span></span><br><span class="line"><span class="string">756</span></span><br><span class="line"><span class="string">1474560</span></span><br><span class="line"><span class="string">800</span></span><br><span class="line"><span class="string">6291456</span></span><br><span class="line"><span class="string">1782</span></span><br><span class="line"><span class="string">65536000</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">b=a.split(<span class="string">'\n'</span>)</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">print</span> b[i]</span><br><span class="line">    <span class="keyword">if</span> i&amp;<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"aa"</span>,int(b[i],<span class="number">10</span>)&gt;&gt;i)</span><br><span class="line">        flag+=chr(int(b[i],<span class="number">10</span>)&gt;&gt;i)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"bb"</span>,int(b[i],<span class="number">10</span>)//i)</span><br><span class="line">        flag+=chr(int(b[i],<span class="number">10</span>)//i)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<p>观察一下数据，随便填一个数。</p>
<h3 id="安洵杯-2019-crackMe"><a href="#安洵杯-2019-crackMe" class="headerlink" title="[安洵杯 2019]crackMe"></a>[安洵杯 2019]crackMe</h3><blockquote>
<p>   Hook 技术又叫做钩子函数，在系统没有调用该函数之前，钩子程序就先捕获该消息，钩子函数先得到控制权，这时钩子函数既可以加工处理（改变）该函数的执行行为，还可以强制结束消息的传递。</p>
</blockquote>
<p>比较</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ( !<span class="keyword">j_strcmp(Str1, </span>Str2) )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">v0</span> = printf(<span class="string">"right\n"</span>)<span class="comment">;</span></span><br><span class="line">  <span class="keyword">sub_4111A4(&amp;v3 </span>== &amp;v3, <span class="built_in">v0</span>)<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>找到str、str1、str2</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Str             db 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span><br><span class="line">Str2            db '1UTAOIkpyOSWGv/mOYFY4R!!'</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; ; i += <span class="number">2</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v1 = j_strlen(Str2);</span><br><span class="line">  <span class="keyword">if</span> ( i &gt;= v1 )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  v4 = Str2[i];</span><br><span class="line">  Str2[i] = Str2[i + <span class="number">1</span>];</span><br><span class="line">  Str2[i + <span class="number">1</span>] = v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>str2奇偶交换</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Str1 = (<span class="keyword">char</span> *)sub_41126C(byte_41A180);</span><br></pre></td></tr></table></figure>

<p>sub_41126C应该是base64。</p>
<p>我想着是flag base64后奇偶交换变成str2。然而并不是。再看看。</p>
<p>搜hooked</p>
<p>首先Str大小写转换</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">&#123;</span><br><span class="line">  v4 = j_strlen(Str);</span><br><span class="line">  <span class="keyword">if</span> ( i &gt;= v4 )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  v10 = Str[i] &gt;= <span class="number">97</span>;</span><br><span class="line">  v9 = Str[i] &lt;= <span class="number">122</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v9 &amp; v10 )</span><br><span class="line">  &#123;</span><br><span class="line">    Str[i] -= <span class="number">32</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v10 = Str[i] &gt;= <span class="number">65</span>;</span><br><span class="line">    v9 = Str[i] &lt;= <span class="number">90</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v9 &amp; v10 )</span><br><span class="line">      Str[i] += <span class="number">32</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后AddVectoredExceptionHandler，这是什么</p>
<blockquote>
<p>  向量化异常处理（Vectored Exception Handling）<br>  向量化异常处理(VEH)是结构化异常处理的一个扩展，它在Windows XP中被引入。</p>
<p>  你可以使用AddVectoredExceptionHandler()函数添加一个向量化异常处理器，VEH的缺点是它只能用在WinXP及其以后的版本，因此需要在运行时检查AddVectoredExceptionHandler()函数是否存在。</p>
<p>  要移除先前安装的异常处理器，可以使用RemoveVectoredExceptionHandler()函数。</p>
<p>  VEH允许查看或处理应用程序中所有的异常。为了保持后向兼容，当程序中的某些部分发生SEH异常时，系统依次调用已安装的VEH处理器，直到它找到有用的SEH处理器。</p>
<p>  VEH的一个优点是能够链接异常处理器(chain exception handlers)，因此如果有人在你之前安装了向量化异常处理器，你仍然能截获这些异常。</p>
<p>  当你需要像调试器一样监事所有的异常时，使用VEH是很合适的。问题是你需要决定哪个异常需要处理，哪个异常需要跳过。 In program’s code, some exceptions may be intentionally guarded by <strong>try{}</strong>except(){} construction, and handling such exceptions in VEH and not passing it to frame-based SEH handler, you may introduce bugs into application logics.</p>
<p>  VEH目前没有被CrashRpt所使用。SetUnhandledExceptionFilter()更加适用，因为它是top-level SEH处理器。如果没有人处理异常，top-level SEH处理器就会被调用，并且你不用决定是否要处理这个异常。</p>
</blockquote>
<p>翻译的。</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v6 = (<span class="name">int</span>)AddVectoredExceptionHandler(<span class="number">0</span>, (<span class="name">PVECTORED_EXCEPTION_HANDLER</span>)Handler)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>Handler进去提示where_are_you_now后一个</p>
<p>sub_411172</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( v8 &lt; <span class="number">0x20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v13[v8] = *(&amp;v9 + v8) ^ sub_4114E0(dword_417A78[v8] ^ *(&amp;v12 + v8) ^ *(&amp;v11 + v8) ^ *(&amp;v10 + v8));</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4</span> * v8) = v13[v8];</span><br><span class="line">    v4 = v8++ + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>看了wp后知道sm4，。。。我好像学了</p>
<p>key就是where_are_you_now？</p>
<p>那个base64最后有一个return (a1 + 24) % 64;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">key=<span class="string">"where_are_u_now?"</span></span><br><span class="line">key= binascii.b2a_hex(key)</span><br><span class="line"><span class="keyword">print</span> key</span><br><span class="line">b64 = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">a=<span class="string">"1UTAOIkpyOSWGv/mOYFY4R!!"</span></span><br><span class="line">ba64=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(b64)):</span><br><span class="line">    x=b64[(i+<span class="number">24</span>)%<span class="number">64</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'a'</span>&lt;=x&lt;=<span class="string">'z'</span>:</span><br><span class="line">        ba64+=x.upper()</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">'A'</span>&lt;=x&lt;=<span class="string">'Z'</span>:</span><br><span class="line">        ba64+=x.lower()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ba64+=x</span><br><span class="line"><span class="keyword">print</span> ba64</span><br><span class="line"></span><br><span class="line">b=list(a)</span><br><span class="line">cflag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(b)<span class="number">-2</span>,<span class="number">2</span>):</span><br><span class="line">    cflag+=b64[ba64.find(b[i+<span class="number">1</span>])]</span><br><span class="line">    cflag+=b64[ba64.find(b[i])]</span><br><span class="line">cflag+=<span class="string">'=='</span></span><br><span class="line"><span class="keyword">print</span> cflag</span><br><span class="line"></span><br><span class="line">cc= base64.b64decode(cflag)</span><br><span class="line">c=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cc:</span><br><span class="line">    <span class="keyword">if</span> ord(i)&lt;=<span class="number">0xf</span>:</span><br><span class="line">        c+=<span class="string">'0'</span></span><br><span class="line">    c+=str(hex(ord(i))).replace(<span class="string">"0x"</span>,<span class="string">''</span>)</span><br><span class="line"><span class="keyword">print</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">0x59d095290df2400614f48d276906874e</span></span><br><span class="line">key=<span class="number">0x77686572655f6172655f755f6e6f773f</span></span><br><span class="line">          </span><br><span class="line">flag = decrypt(c, key)</span><br><span class="line">flag=hex(flag)[<span class="number">2</span>:].replace(<span class="string">'L'</span>, <span class="string">''</span>)</span><br><span class="line"><span class="keyword">print</span> binascii.a2b_hex(str(flag))</span><br></pre></td></tr></table></figure>

<p>写的我吐了。各种格式啊什么东西的</p>
<p>其中<a href="https://github.com/yang3yen/pysm4" target="_blank" rel="noopener">pysm4</a>,要看看他的使用</p>
<h2 id="day24-5-30"><a href="#day24-5-30" class="headerlink" title="day24 5.30"></a>day24 5.30</h2><h3 id="eqution"><a href="#eqution" class="headerlink" title="eqution"></a>eqution</h3><p>看源代码解JSfuck</p>
<p>本来想<a href="http://ctf.ssleye.com/jsfuck.html解密的，但它的代码是部分部分加密的，一个一个找眼都瞎啦。去找代码。本来想搞个python爬虫，结果burpsuit用不了。" target="_blank" rel="noopener">http://ctf.ssleye.com/jsfuck.html解密的，但它的代码是部分部分加密的，一个一个找眼都瞎啦。去找代码。本来想搞个python爬虫，结果burpsuit用不了。</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deEquation</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; i++) &#123;</span><br><span class="line">  str = str.replace(<span class="regexp">/l\[(\D*?)](\+l|-l|==)/g</span>, (m, a, b) =&gt; <span class="string">'l['</span> + <span class="built_in">eval</span>(a) + <span class="string">']'</span> + b);</span><br><span class="line">  &#125;</span><br><span class="line">  str = str.replace(<span class="regexp">/==(\D*?)&amp;&amp;/g</span>, (m, a) =&gt; <span class="string">'=='</span> + <span class="built_in">eval</span>(a) + <span class="string">'&amp;&amp;'</span>);</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line">s=<span class="string">"l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+[]]==+(+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]==+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]==-+(!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]==+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[+!+[]+[!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]==+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(+!+[]+[+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]==+(!+[]+!+[]+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]]+l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[+[]]]==-+(+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+[]]-l[!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+!+[]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]]])&amp;&amp;l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]+l[+[]]+l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]==-+(+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])&amp;&amp;l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]==-+(+!+[]+[+!+[]+[!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]+l[+!+[]+[+!+[]]]+l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+[+[]]])&amp;&amp;l[+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]-l[+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]]+l[+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[+[]+[!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])&amp;&amp;l[+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+[]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[+!+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(!+[]+!+[]+!+[]+!+[]+!+[]+[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]])&amp;&amp;l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+!+[]]]-l[!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[+[]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]+l[!+[]+!+[]+[+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]==-+(+!+[]+[!+[]+!+[]])&amp;&amp;l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+[+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]]]-l[+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]]]-l[!+[]+!+[]+!+[]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]-l[!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]]]+l[+!+[]]-l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+[+!+[]]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[+!+[]+[+[]]]-l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+[!+[]+!+[]]]+l[!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]+l[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+l[+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]-l[!+[]+!+[]+!+[]+[+!+[]]]==+(!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+[+!+[]])"</span>;</span><br><span class="line">ss=deEquation(s);</span><br><span class="line"><span class="built_in">document</span>.write(ss);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="day25-5-31"><a href="#day25-5-31" class="headerlink" title="day25 5.31"></a>day25 5.31</h2><h3 id="WUSTCTF2020-level2"><a href="#WUSTCTF2020-level2" class="headerlink" title="[WUSTCTF2020]level2"></a>[WUSTCTF2020]level2</h3><p>有壳，命令行upx -d脱壳，不知道为什么图形界面不行。</p>
<p>wctf2020{Just_upx_-d}</p>
<p>好，这题目，好。</p>
<h3 id="FlareOn6-Overlong"><a href="#FlareOn6-Overlong" class="headerlink" title="[FlareOn6]Overlong"></a>[FlareOn6]Overlong</h3><p>无壳。找东西。</p>
<p>提示i nerver broke the encoding.</p>
<p>unk_402008有奇怪的数据，可能是flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v4 = sub_401160((<span class="keyword">int</span>)Text, (<span class="keyword">int</span>)&amp;qiguai, <span class="number">28u</span>);</span><br></pre></td></tr></table></figure>

<p>28位。</p>
<p>text128位。</p>
<p>a3是28。</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">for</span> ( i = <span class="number">0</span><span class="comment">; ; ++i )</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">if</span> ( i &lt; <span class="built_in">a3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">a2</span> += <span class="keyword">sub_401000(a1, </span><span class="built_in">a2</span>)<span class="comment">;</span></span><br><span class="line">    <span class="built_in">v3</span> = *(_BYTE *)<span class="built_in">a1</span>++<span class="comment">;</span></span><br><span class="line">    <span class="meta">if</span> ( <span class="built_in">v3</span> )</span><br><span class="line">      continue<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">break;</span></span><br><span class="line"><span class="keyword">&#125;</span></span><br></pre></td></tr></table></figure>

<p>结合提示，去改a3.</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text</span>:<span class="number">004011</span><span class="built_in">C9</span>                 <span class="keyword">push </span>   <span class="number">1</span>Ch</span><br></pre></td></tr></table></figure>

<p>改成qiguai的长度，20b6-2008+1=af</p>
<p>在od改1c为af时改了很多次，发现如果要改成两位数字或一位数字+一位字母可以，而两位字母不可以，加0后如果：</p>
<p>push 0aa</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>CC11C9     <span class="number">68</span> AA000000    PUSH <span class="number">0</span>AA</span><br></pre></td></tr></table></figure>

<p>push 0a1a</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>CC11D3     <span class="number">68</span> <span class="number">1</span>A0A0000    PUSH <span class="number">0</span>A1A</span><br></pre></td></tr></table></figure>

<p>push 0ffffffaf</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>CC1205     <span class="number">6</span>A AF          PUSH <span class="number">-51</span></span><br></pre></td></tr></table></figure>

<h2 id="day26-6-1-6-2"><a href="#day26-6-1-6-2" class="headerlink" title="day26 6.1+6.2"></a>day26 6.1+6.2</h2><h3 id="GWCTF-2019-re3"><a href="#GWCTF-2019-re3" class="headerlink" title="[GWCTF 2019]re3"></a>[GWCTF 2019]re3</h3><p>correct引用下面有奇怪的数据。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __<span class="function">noreturn <span class="title">sub_402126</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [sp+8h] [bp-48h]@4</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [sp+20h] [bp-30h]@1</span></span><br><span class="line">  __int64 v2; <span class="comment">// [sp+48h] [bp-8h]@1</span></span><br><span class="line"></span><br><span class="line">  v2 = *MK_FP(__FS__, <span class="number">40L</span>L);</span><br><span class="line">  __isoc99_scanf(<span class="number">4204480L</span>L, &amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="built_in">strlen</span>(&amp;s) != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Wrong!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  mprotect((<span class="keyword">void</span> *)<span class="number">0x400000</span>, <span class="number">0xF000</span>uLL, <span class="number">7</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">223</span>; ++i )</span><br><span class="line">    *((_BYTE *)sub_402219 + i) ^= <span class="number">0x99</span>u;</span><br><span class="line">  sub_40207B(<span class="number">6304112L</span>L, <span class="number">61440L</span>L);</span><br><span class="line">  sub_402219(&amp;s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag32位</p>
<blockquote>
<p>   在Linux中，mprotect()函数可以用来修改一段指定内存区域的保护属性。<br>  函数原型如下：</p>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line">&gt;   <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mmap.h&gt;</span></span></span><br><span class="line">&gt;   <span class="function"><span class="keyword">int</span> <span class="title">mprotect</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *start, <span class="keyword">size_t</span> len, <span class="keyword">int</span> prot)</span></span>;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>  mprotect()函数把自start开始的、长度为len的内存区的保护属性修改为prot指定的值。</p>
<p>  prot可以取以下几个值，并且可以用“|”将几个属性合起来使用：</p>
<p>  1）PROT_READ：表示内存段内的内容可写；</p>
<p>  2）PROT_WRITE：表示内存段内的内容可读；</p>
<p>  3）PROT_EXEC：表示内存段中的内容可执行；</p>
<p>  4）PROT_NONE：表示内存段中的内容根本没法访问。</p>
</blockquote>
<p>这里7是和chmod一样可读可写可执行。</p>
<p>sub_402219还原idc脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;idc.idc&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> addr = <span class="number">0x402219</span>;</span><br><span class="line">    <span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">224</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        PatchByte(addr+i,Byte(addr+i)^<span class="number">0x99</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>auto声明变量</p>
<p>PatchByte(long addr, long val)设置虚拟地址addr处的一个字节值。</p>
<p>c强制转换，p生成函数。</p>
<p>主函数先进入sub_40207B。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">sub_40207B</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v2; <span class="comment">// [rsp+10h] [rbp-50h]</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+20h] [rbp-40h]</span></span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+30h] [rbp-30h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+40h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sub_401CF9(&amp;unk_603120, <span class="number">64L</span>L, &amp;v2);</span><br><span class="line">  sub_401CF9(&amp;unk_603100, <span class="number">20L</span>L, &amp;v3);</span><br><span class="line">  sub_401CF9(&amp;unk_6030C0, <span class="number">53L</span>L, &amp;v4);</span><br><span class="line">  sub_401CF9(&amp;dword_4025C0, <span class="number">256L</span>L, &amp;v5);</span><br><span class="line">  sub_401CF9(&amp;v2, <span class="number">64L</span>L, a1);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>__readfsqword从相对于 FS 段开头的偏移量指定的位置读取内存。</p>
<p>sub_401CF9是md5， 从 v6 = 0x67452301v7 = 0xEFCDAB89;v8 = 0x98BADCFE; v9 = 0x10325476;可以看出来。其中起到作用的是</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sub_401CF9(&amp;unk_603120, <span class="number">64L</span>L, &amp;v2);</span><br><span class="line">sub_401CF9(&amp;v2, <span class="number">64L</span>L, a1);</span><br></pre></td></tr></table></figure>

<p>unk_603120是base64表，a1是unk_603170地址，结果就是base64表两次md5返回unk_603170。</p>
<p>base64表两次md5不行，可能改了什么，用od结果为cb8d493521b47a4cc1ae7e62229266ce。</p>
<p><a href="https://blog.csdn.net/feng_2016/article/details/106358117?fps=1&locationNum=2" target="_blank" rel="noopener">看过feng_2016的wp发现sub_40207B中4个md5的关系</a></p>
<blockquote>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="keyword">import</span> hashlib</span><br><span class="line">&gt;   s1 = <span class="string">b'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">&gt;   s2 = <span class="string">b'\x00\x00\x00\x00\x96\x30\x07\x77\x2C\x61\x0E\xEE\xBA\x51\x09\x99\x19\xC4\x6D\x07'</span></span><br><span class="line">&gt;   s3 = <span class="string">b'\x03\x05\x07\x0B\x0D\x11\x13\x17\x1D\x1F\x25\x29\x2B\x2F\x35\x3B\x3D\x43\x47\x49\x4F\x53\x59\x61\x65\x67\x6B\x6D\x71\x7F\x83\x89\x8B\x95\x97\x9D\xA3\xA7\xAD\xB3\xB5\xBF\xC1\xC5\xC7\xD3\xDF\xE3\xE5\xE9\xEF\xF1\xFB'</span></span><br><span class="line">&gt;   s4 = <span class="string">b'\x78\xA4\x6A\xD7\x56\xB7\xC7\xE8\xDB\x70\x20\x24\xEE\xCE\xBD\xC1\xAF\x0F\x7C\xF5\x2A\xC6\x87\x47\x13\x46\x30\xA8\x01\x95\x46\xFD\xD8\x98\x80\x69\xAF\xF7\x44\x8B\xB1\x5B\xFF\xFF\xBE\xD7\x5C\x89\x22\x11\x90\x6B\x93\x71\x98\xFD\x8E\x43\x79\xA6\x21\x08\xB4\x49\x62\x25\x1E\xF6\x40\xB3\x40\xC0\x51\x5A\x5E\x26\xAA\xC7\xB6\xE9\x5D\x10\x2F\xD6\x53\x14\x44\x02\x81\xE6\xA1\xD8\xC8\xFB\xD3\xE7\xE6\xCD\xE1\x21\xD6\x07\x37\xC3\x87\x0D\xD5\xF4\xED\x14\x5A\x45\x05\xE9\xE3\xA9\xF8\xA3\xEF\xFC\xD9\x02\x6F\x67\x8A\x4C\x2A\x8D\x42\x39\xFA\xFF\x81\xF6\x71\x87\x22\x61\x9D\x6D\x0C\x38\xE5\xFD\x44\xEA\xBE\xA4\xA9\xCF\xDE\x4B\x60\x4B\xBB\xF6\x70\xBC\xBF\xBE\xC6\x7E\x9B\x28\xFA\x27\xA1\xEA\x85\x30\xEF\xD4\x05\x1D\x88\x04\x39\xD0\xD4\xD9\xE5\x99\xDB\xE6\xF8\x7C\xA2\x1F\x65\x56\xAC\xC4\x44\x22\x29\xF4\x97\xFF\x2A\x43\xA7\x23\x94\xAB\x39\xA0\x93\xFC\xC3\x59\x5B\x65\x92\xCC\x0C\x8F\x7D\xF4\xEF\xFF\xD1\x5D\x84\x85\x4F\x7E\xA8\x6F\xE0\xE6\x2C\xFE\x14\x43\x01\xA3\xA1\x11\x08\x4E\x82\x7E\x53\xF7\x35\xF2\x3A\xBD\xBB\xD2\xD7\x2A\x91\xD3\x86\xEB'</span></span><br><span class="line">&gt;   s =<span class="string">''</span></span><br><span class="line">&gt;   a = [s1,s2,s3,s4]</span><br><span class="line">&gt;   <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">&gt;       md5 = hashlib.md5()</span><br><span class="line">&gt;       md5.update(i)</span><br><span class="line">&gt;       s += md5.hexdigest()</span><br><span class="line">&gt;   <span class="comment">#以上步骤得到s，下面是我把它提取出来转化为二进制了</span></span><br><span class="line">&gt;   s = <span class="string">b'\x78\x45\xf7\xea\xde\x89\x33\x8a\xda\xbf\xef\x89\xbd\x6e\x9a\x5b\xe8\x4f\xed\xef\x50\x67\xcf\x85\xf5\xe4\x7f\x4f\x4b\x59\x47\xa3\xc8\x38\xba\xe0\x2e\x07\xae\x0c\x27\x6d\xfb\x2e\x53\x30\x04\xc8\x7a\xc5\xfb\xac\x91\x1f\x3b\x36\x78\x41\xf8\xdc\xec\xc9\xdb\x46'</span></span><br><span class="line">&gt;   md5 = hashlib.md5()</span><br><span class="line">&gt;   md5.update(s)</span><br><span class="line">&gt;   print(md5.hexdigest()</span><br><span class="line">&gt;   <span class="comment">#得到cb8d493521b47a4cc1ae7e62229266ce</span></span><br><span class="line">&gt;   ————————————————</span><br><span class="line">&gt;   版权声明：本文为CSDN博主「feng_2016」的原创文章，遵循CC <span class="number">4.0</span> BY-SA版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">&gt;   原文链接：https://blog.csdn.net/feng_2016/article/details/<span class="number">106358117</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>接下来就是sub_402219</p>
<p>看到</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A0</span> <span class="comment">; char byte_4023A0[256]</span></span><br><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A0</span> <span class="keyword">byte_4023A0 </span>    db <span class="number">63</span>h                  <span class="comment">; DATA XREF: sub_4007C6+17A↑r</span></span><br><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A0</span>                                         <span class="comment">; sub_4007C6+18D↑r ...</span></span><br><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A1</span>                 db  <span class="number">7</span>Ch <span class="comment">; |</span></span><br><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A2</span>                 db  <span class="number">77</span>h <span class="comment">; w</span></span><br><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A3</span>                 db  <span class="number">7</span>Bh <span class="comment">; &#123;</span></span><br><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A4</span>                 db <span class="number">0</span>F2h</span><br><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A5</span>                 db  <span class="number">6</span>Bh <span class="comment">; k</span></span><br><span class="line"><span class="symbol">.rodata:</span><span class="number">00000000004023</span><span class="built_in">A6</span>                 db  <span class="number">6</span>Fh <span class="comment">; o</span></span><br></pre></td></tr></table></figure>

<p>是AES的s盒。</p>
<p>看看aes加密后和谁比，解密flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key=<span class="string">'CB8D493521B47A4CC1AE7E62229266CE'</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line">c=<span class="string">'BC0AADC0147C5ECCE0B140BC9C51D52B46B2B9434DE5324BAD7FB4B39CDB4B5B'</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">print(aes.decrypt(c))</span><br></pre></td></tr></table></figure>

<h2 id="day27-6-3"><a href="#day27-6-3" class="headerlink" title="day27 6.3"></a>day27 6.3</h2><h3 id="GUET-CTF2019-number-game"><a href="#GUET-CTF2019-number-game" class="headerlink" title="[GUET-CTF2019]number_game"></a>[GUET-CTF2019]number_game</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__int64 v3; <span class="comment">// ST08_8</span></span><br><span class="line">__int64 v5; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">__int16 v6; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">__int64 v7; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">__int16 v8; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line"><span class="keyword">char</span> v9; <span class="comment">// [rsp+2Ah] [rbp-16h]</span></span><br><span class="line"><span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">v5 = <span class="number">0L</span>L;</span><br><span class="line">v6 = <span class="number">0</span>;</span><br><span class="line">v7 = <span class="number">0L</span>L;</span><br><span class="line">v8 = <span class="number">0</span>;</span><br><span class="line">v9 = <span class="number">0</span>;</span><br><span class="line">__isoc99_scanf(<span class="string">"%s"</span>, &amp;v5, a3);</span><br><span class="line"><span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_4006D6(&amp;v5) )</span><br><span class="line">&#123;</span><br><span class="line">  v3 = sub_400758(&amp;v5, <span class="number">0L</span>L, <span class="number">10L</span>L);</span><br><span class="line">  sub_400807(v3, &amp;v7);</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  sub_400881(&amp;v7);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)sub_400917() )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"TQL!"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"flag&#123;"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s"</span>, &amp;v5);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"&#125;"</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>main函数里判断</p>
<ul>
<li>首先对输入sub_4006D6</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="built_in">strlen</span>(a1) == <span class="number">10</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a1[i] &gt; <span class="number">52</span> || a1[i] &lt;= <span class="number">47</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Wrong!"</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Wrong!"</span>);</span><br><span class="line">  result = <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>

<p>输入v5 10位且47&lt;v5[i]&lt;=52，那就是01234</p>
<ul>
<li>接下来sub_400758</li>
</ul>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">v6 = <span class="built_in">a3</span><span class="comment">;</span></span><br><span class="line">v7 = *(_BYTE *)(<span class="built_in">a2</span> + <span class="built_in">a1</span>)<span class="comment">;</span></span><br><span class="line">if ( v7 == <span class="string">' '</span> <span class="title">||</span> v7 == <span class="string">'\n'</span> <span class="title">||</span> <span class="built_in">a2</span> &gt;= <span class="built_in">a3</span> )</span><br><span class="line">  return <span class="number">0</span>LL<span class="comment">;</span></span><br><span class="line">v4 = malloc(<span class="number">0x18</span>uLL)<span class="comment">;</span></span><br><span class="line">v5 = v4<span class="comment">;</span></span><br><span class="line">*(_BYTE *)v4 = v7<span class="comment">;</span></span><br><span class="line">v4[<span class="number">1</span>] = <span class="keyword">sub_400758(a1, </span><span class="number">2</span> * <span class="built_in">a2</span> + <span class="number">1</span>, v6)<span class="comment">;</span></span><br><span class="line">v5[<span class="number">2</span>] = <span class="keyword">sub_400758(a1, </span><span class="number">2</span> * (<span class="built_in">a2</span> + <span class="number">1</span>), v6)<span class="comment">;</span></span><br><span class="line">return v5<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>v3赋值</p>
<ul>
<li>sub_400807</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_400807</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = a1;</span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_400807(*(_QWORD *)(a1 + <span class="number">8</span>), a2);</span><br><span class="line">    *(_BYTE *)(a2 + dword_601080++) = *(_BYTE *)a1;</span><br><span class="line">    result = sub_400807(*(_QWORD *)(a1 + <span class="number">16</span>), a2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v7 dword_601080赋值v3[3]、[2]、[1]、[0]（int 64）</p>
<ul>
<li>sub_400881((char *)&amp;v7);</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_400881</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  byte_601062 = *a1;</span><br><span class="line">  byte_601067 = a1[<span class="number">1</span>];</span><br><span class="line">  byte_601069 = a1[<span class="number">2</span>];</span><br><span class="line">  byte_60106B = a1[<span class="number">3</span>];</span><br><span class="line">  byte_60106E = a1[<span class="number">4</span>];</span><br><span class="line">  byte_60106F = a1[<span class="number">5</span>];</span><br><span class="line">  byte_601071 = a1[<span class="number">6</span>];</span><br><span class="line">  byte_601072 = a1[<span class="number">7</span>];</span><br><span class="line">  byte_601076 = a1[<span class="number">8</span>];</span><br><span class="line">  result = (<span class="keyword">unsigned</span> __int8)a1[<span class="number">9</span>];</span><br><span class="line">  byte_601077 = a1[<span class="number">9</span>];</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将v7分别赋值</p>
<ul>
<li>sub_400917判断</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int64 <span class="title">sub_400917</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> k; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">4</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( k = j + <span class="number">1</span>; k &lt;= <span class="number">4</span>; ++k )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( *((_BYTE *)&amp;unk_601060 + <span class="number">5</span> * i + j) == *((_BYTE *)&amp;unk_601060 + <span class="number">5</span> * i + k) )</span><br><span class="line">          v1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( *((_BYTE *)&amp;unk_601060 + <span class="number">5</span> * j + i) == *((_BYTE *)&amp;unk_601060 + <span class="number">5</span> * k + i) )</span><br><span class="line">          v1 = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数独解出来v7=0,4,2,1,4,2,1,4,3,0</p>
<p>linux ida远程调试，我行你也行。（注意版本）</p>
<h2 id="day28-6-5"><a href="#day28-6-5" class="headerlink" title="day28 6.5"></a>day28 6.5</h2><h3 id="2019红帽杯-childRE"><a href="#2019红帽杯-childRE" class="headerlink" title="[2019红帽杯]childRE"></a>[2019红帽杯]childRE</h3><p>31位</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sub_140001080(<span class="string">"%s"</span>, &amp;v13);</span><br><span class="line">v0 = <span class="number">-1</span>i64;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ++v0;</span><br><span class="line"><span class="keyword">while</span> ( *((_BYTE *)&amp;v13 + v0) );</span><br><span class="line"><span class="keyword">if</span> ( v0 != <span class="number">31</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    Sleep(<span class="number">0x3E8</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.rdata:<span class="number">0000000140003438</span> a55565653255552 db '<span class="number">55565653255552</span><span class="number">22556556555524</span><span class="number">34663346536635</span><span class="number">44426565555525</span><span class="number">555222</span>',<span class="number">0</span></span><br><span class="line">.rdata:<span class="number">0000000140003477</span>                 align <span class="number">8</span></span><br><span class="line">.rdata:<span class="number">0000000140003478</span> a46200860044218 db '(_@<span class="number">4620</span>!08!6_0*<span class="number">0442</span>!@186%%0@3=66!!974*<span class="number">3234</span>=&amp;0^3&amp;1@=&amp;<span class="number">0908</span>!6_0*&amp;',<span class="number">0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  v11 = outputString[v10];</span><br><span class="line">  v12 = v11 % <span class="number">23</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a1234567890Qwer[v12] != *(_BYTE *)(v10 + <span class="number">0x140003478</span>i64) )</span><br><span class="line">    _exit(v9);</span><br><span class="line">  <span class="keyword">if</span> ( a1234567890Qwer[v11 / <span class="number">23</span>] != *(_BYTE *)(v10 + <span class="number">0x140003438</span>i64) )</span><br><span class="line">    _exit(v9 * v9);</span><br><span class="line">  ++v9;</span><br><span class="line">  ++v10;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v9 &lt; <span class="number">62</span> );</span><br></pre></td></tr></table></figure>

<p>相当于</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a<span class="comment">[o<span class="comment">[i]</span>%23]</span>=str78<span class="comment">[i]</span></span><br><span class="line">a<span class="comment">[o<span class="comment">[i]</span>/23]</span> =str38<span class="comment">[i]</span></span><br><span class="line">0&lt;i&lt;62</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">a[o[i]%23]=str78[i]</span></span><br><span class="line"><span class="string">a[o[i]/23] =str38[i]</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">o=<span class="string">""</span></span><br><span class="line">str38=<span class="string">"55565653255552225565565555243466334653663544426565555525555222"</span></span><br><span class="line">str78=<span class="string">"(_@4620!08!6_0*0442!@186%%0@3=66!!974*3234=&amp;0^3&amp;1@=&amp;0908!6_0*&amp;"</span></span><br><span class="line">a=<span class="string">"1234567890-=!@#$%^&amp;*()_+qwertyuiop[]QWERTYUIOP&#123;&#125;asdfghjkl;"</span>+chr(<span class="number">0x27</span>)+<span class="string">"A"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">62</span>):</span><br><span class="line">    m=a.find(str78[i]) </span><br><span class="line">    n =a.find(str38[i])</span><br><span class="line">    o+=chr(n*<span class="number">23</span>+m)</span><br><span class="line">print(o) </span><br><span class="line"><span class="comment">#private: char * __thiscall R0Pxx::My_Aut0_PWN(unsigned char *)</span></span><br></pre></td></tr></table></figure>

<p>看UnDecorateSymbolName，看了百度看不懂，<a href="https://www.cnblogs.com/wfwenchao/articles/4140388.html" target="_blank" rel="noopener">C++ 符号修饰和函数签名</a></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnDecorateSymbolName(<span class="name">v2</span>, outputString, <span class="number">0</span>x100u, <span class="number">0</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>  UnDecorateSymbolName <a href="https://baike.baidu.com/item/函数/18686609" target="_blank" rel="noopener">函数</a>反修饰指定已修饰的 C++ 符号名。</p>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="function">DWORD WINAPI <span class="title">UnDecorateSymbolName</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">&gt;     _In_ PCTSTR DecoratedName,</span></span></span><br><span class="line"><span class="function"><span class="params">&gt;     _Out_ PTSTR UnDecoratedName,</span></span></span><br><span class="line"><span class="function"><span class="params">&gt;     _In_ DWORD UndecoratedLength,</span></span></span><br><span class="line"><span class="function"><span class="params">&gt;     _In_ DWORD Flags</span></span></span><br><span class="line"><span class="function"><span class="params">&gt;   )</span></span>;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>  DecoratedName [输入]<br>  已修饰的 C++ 符号名。此名称能以始终为问号 (?) 的首字符鉴别。<br>  UnDecoratedName [输出]<br>  指向字符串缓冲区的指针，该缓冲区接收未修饰的名字。<br>  UndecoratedLength [输入]<br>  UnDecoratedName 缓冲区的大小，为字符数。<br>  Flags [输入]<br>  用于反修饰已修饰名称的方式的选项。此参数能为零或更多个下列值</p>
</blockquote>
<p>现在要v2的值，<a href="https://www.cnblogs.com/findumars/p/5143949.html" target="_blank" rel="noopener">C++编译时函数名修饰约定规则（很具体），MFC提供的宏，extern “C”的作用</a></p>
<p>?My_Aut0_PWN@R0Pxx@@AAEPADPAE</p>
<p>用x64dbg调试</p>
<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-06-05_21-47-36.png" alt></p>
<p>写脚本把字符串转一下得到flag，再md5.</p>
<p>看别人的wp中UnDecorateSymbolName可以这样，其中注意是char* My_Aut0_PWN不是char My_Aut0_PWN</p>
<p><a href="https://www.cnblogs.com/jentleTao/p/12796542.html" target="_blank" rel="noopener">wp</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ROPxx</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ROPxx() &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span> a;</span><br><span class="line">        My_Aut0_PWN(&amp;a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">char</span>* <span class="title">My_Aut0_PWN</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s"</span>, __FUNCDNAME__);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> ROPxx();</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="//yoursite.com/2020/05/12/re的刷题/Snipaste_2020-06-05_17-04-13.png" alt></p>
<h2 id="day29-6-6"><a href="#day29-6-6" class="headerlink" title="day29 6.6"></a>day29 6.6</h2><h3 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h3><p>ida编码格式改utf-8，一开始英文乱码。</p>
<p>sub_401020输出</p>
<p>sub_401050输入</p>
<p>byte_4212C0输入，27位</p>
<p>比较函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v1 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> __int8)v1 ^ (<span class="keyword">unsigned</span> __int8)byte_4212C0[v1]) != byte_41EA08[v1] )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">  ++v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v1 &lt; <span class="number">0x1B</span> );</span><br><span class="line"><span class="built_in">printf</span>((<span class="keyword">int</span>)<span class="string">"Right!\n"</span>);</span><br></pre></td></tr></table></figure>

<p>((unsigned int8)v1 ^ (unsigned int8)byte_4212C0[v1]) != byte_41EA08[v1]</p>
<p>byte_41EA08是</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.rdata</span>:<span class="number">0041</span>EA08 byte_41EA08     db <span class="string">'M'</span>                  </span><br><span class="line"><span class="selector-class">.rdata</span>:<span class="number">0041</span>EA09 aSawbFxzJTqjNBp db <span class="string">'SAWB~FXZ:J:`tQJ"N@ bpdd&#125;8g'</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">"MSAWB~FXZ:J:`tQJ\"N@ bpdd&#125;8g"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">27</span>):</span><br><span class="line">    flag+=chr(ord(s[i])^i)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<h3 id="findKey"><a href="#findKey" class="headerlink" title="findKey"></a>findKey</h3><p>全p一下，flag字符串位置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __usercall __<span class="function">noreturn <span class="title">sub_401A37</span><span class="params">(<span class="keyword">int</span> a1@&lt;ebp&gt;)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SetWindowTextA(*(HWND *)(a1 + <span class="number">8</span>), <span class="string">"flag&#123;&#125;"</span>);</span><br><span class="line">  MessageBoxA(*(HWND *)(a1 + <span class="number">8</span>), <span class="string">"Are you kidding me?"</span>, <span class="string">"^_^"</span>, <span class="number">0</span>);</span><br><span class="line">  ExitProcess(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看一下sub_401A37的调用，。。。无。有点问题。</p>
<p>看了wp才知道问题所在，两个push，nop一个，p一下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00401918</span>                 push    offset byte_428C54</span><br><span class="line">.text:<span class="number">0040191</span>D</span><br><span class="line">.text:<span class="number">0040191</span>D loc_40191D:                             ; CODE XREF: .text:<span class="number">0040193</span>D↓j</span><br><span class="line">.text:<span class="number">0040191</span>D                 push    offset byte_428C54</span><br></pre></td></tr></table></figure>

<ul>
<li>1</li>
</ul>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strcpy(<span class="name">&amp;v21</span>, <span class="string">"0kk`d1a`55k222k2a776jbfgd`06cjjb"</span>)<span class="comment">;</span></span><br><span class="line">strcpy(<span class="name">v17</span>, <span class="string">"SS"</span>)<span class="comment">;</span></span><br><span class="line">sub_401005(<span class="name">v17</span>, (<span class="name">int</span>)<span class="symbol">&amp;v21</span>, v9)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sub_401005--异或</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_401590</span><span class="params">(LPCSTR lpString, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+54h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v5 = lstrlenA(lpString);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(i + a2) ^= lpString[i % v5];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v21=<span class="string">"0kk`d1a`55k222k2a776jbfgd`06cjjb"</span></span><br><span class="line">r=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v21:</span><br><span class="line">    r += chr(ord(i)^ord(<span class="string">'S'</span>))</span><br><span class="line"><span class="keyword">print</span> r</span><br><span class="line"><span class="comment">#c8837b23ff8aaa8a2dde915473ce0991</span></span><br></pre></td></tr></table></figure>

<ul>
<li>2</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_strcmpi((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;String1, &amp;v21)</span><br></pre></td></tr></table></figure>

<p>v21是c8837b23ff8aaa8a2dde915473ce0991，找string1是什么</p>
<p>发现string1结构CryptCreateHash。在附件找到0x8003u是md5</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CryptCreateHash(phProv, <span class="number">0x8003</span>u, <span class="number">0</span>, <span class="number">0</span>, &amp;phHash)</span><br></pre></td></tr></table></figure>

<p>解密123321</p>
<ul>
<li>3</li>
</ul>
<p>最后有一个</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memcpy</span>(&amp;v16, &amp;unk_423030, <span class="number">0x32</span>u);</span><br><span class="line">v10 = <span class="built_in">strlen</span>(&amp;v16);</span><br><span class="line">sub_401005(&amp;v25, (<span class="keyword">int</span>)&amp;v16, v10);</span><br></pre></td></tr></table></figure>

<p>v25是string1未加密的，就是123321</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">0x57</span> ,<span class="number">0x5E</span> ,<span class="number">0x52</span> ,<span class="number">0x54</span>,<span class="number">0x49</span> ,<span class="number">0x5F</span>,<span class="number">1</span>,<span class="number">0x6D</span> ,<span class="number">0x69</span>,<span class="number">0x46</span> ,<span class="number">2</span>,<span class="number">0x6E</span>,<span class="number">0x5F</span>,<span class="number">2</span>,<span class="number">0x6C</span> ,<span class="number">0x57</span> ,<span class="number">0x5B</span>,<span class="number">0x54</span> ,<span class="number">0x4C</span>]</span><br><span class="line">b=<span class="string">"123321"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    flag+=chr(ord(b[i%<span class="number">6</span>])^a[i])</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<h2 id="day30-6-9"><a href="#day30-6-9" class="headerlink" title="day30 6.9"></a>day30 6.9</h2><p>打了学校的awd，专注拿flag，没有搅屎，以至于后期flag少了很多。还是没什么经验。</p>
<h3 id="WUSTCTF2020-level3"><a href="#WUSTCTF2020-level3" class="headerlink" title="[WUSTCTF2020]level3"></a>[WUSTCTF2020]level3</h3><p>看字符串是变换的base64</p>
<p>这是加密后的flag</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD</span>==</span><br></pre></td></tr></table></figure>

<p>进入base64_encode查看</p>
<p>base64_table是正常的</p>
<p>emmm，再找找。肯定对base64_table做了变换，x一下找到</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int64 <span class="title">O_OLookAtYou</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v0; <span class="comment">// ST03_1</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+2h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = base64_table[i];</span><br><span class="line">    base64_table[i] = base64_table[<span class="number">19</span> - i];</span><br><span class="line">    result = <span class="number">19</span> - i;</span><br><span class="line">    base64_table[result] = v0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>换位置。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> base64_table[<span class="number">100</span>]=<span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line">    <span class="keyword">char</span> v0; <span class="comment">// ST03_1</span></span><br><span class="line">    <span class="keyword">int</span> result; <span class="comment">// rax</span></span><br><span class="line">    <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+2h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        v0 = base64_table[i];</span><br><span class="line">        base64_table[i] = base64_table[<span class="number">19</span> - i];</span><br><span class="line">        result = <span class="number">19</span> - i;</span><br><span class="line">        base64_table[result] = v0;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;base64_table&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">eflag=<span class="string">"d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD=="</span></span><br><span class="line">be64=<span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line">base64=<span class="string">"TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> eflag:</span><br><span class="line">    <span class="keyword">if</span> i ==<span class="string">"="</span>:</span><br><span class="line">        flag+=<span class="string">"="</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=be64[base64.find(i)]</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="keyword">print</span> base64.b64decode(flag)</span><br><span class="line"><span class="comment">#d2N0ZjIwMjB7QmFzZTY0X2lzX3RoZV9zdGFydF9vZl9yZXZlcnNlfQ==</span></span><br></pre></td></tr></table></figure>

<p>不知道为什么python报错’str’ object has no attribute ‘b64decode’</p>
<h2 id="day31-6-23"><a href="#day31-6-23" class="headerlink" title="day31 6.23"></a>day31 6.23</h2><p>放假了，emm。好久没刷题了</p>
<h3 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h3><p>打开看就很奇怪，字符串一堆让人眼花缭乱。</p>
<p>其中runtime_staticbytes是包含ascii表，看引用runtime_intstring。emm</p>
<p>看main函数里unk_4D3C58找到flag</p>
<h2 id="day32-7-1"><a href="#day32-7-1" class="headerlink" title="day32 7.1"></a>day32 7.1</h2><h3 id="FlareOn5-Minesweeper-Championship-Registration"><a href="#FlareOn5-Minesweeper-Championship-Registration" class="headerlink" title="[FlareOn5]Minesweeper Championship Registration"></a>[FlareOn5]Minesweeper Championship Registration</h3><p>扫雷锦标赛注册，emm</p>
<blockquote>
<p>  Welcome to the Fifth Annual Flare-On Challenge! The Minesweeper World Championship is coming soon and we found the registration app. You weren’t <em>officially</em> invited but if you can figure out what the code is you can probably get in anyway. Good luck!</p>
<p>  Hint:本题解出相应字符串后请用flag{}包裹，形如：flag{123456@flare-on.com}</p>
</blockquote>
<p>java的逆向，百度一下下一个jd-gui，官网打不开，去github</p>
<h3 id="网鼎杯-2020-青龙组-singal"><a href="#网鼎杯-2020-青龙组-singal" class="headerlink" title="[网鼎杯 2020 青龙组]singal"></a>[网鼎杯 2020 青龙组]singal</h3><p>无壳32位，输入字符串</p>
<p><code>read</code>函数限定15位</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+18h] [ebp-1D4h]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  qmemcpy(&amp;v4, &amp;unk_403040, <span class="number">0x1C8</span>u);</span><br><span class="line">  vm_operad(&amp;v4, <span class="number">114</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"good,The answer format is:flag &#123;&#125;"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主要就是<code>vm_operad</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">vm_operad</span><span class="params">(<span class="keyword">int</span> *a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v3[<span class="number">100</span>]; <span class="comment">// [esp+13h] [ebp-E5h]</span></span><br><span class="line">  <span class="keyword">char</span> v4[<span class="number">100</span>]; <span class="comment">// [esp+77h] [ebp-81h]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+DBh] [ebp-1Dh]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+DCh] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+E0h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+E4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+E8h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [esp+ECh] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = v10;</span><br><span class="line">    <span class="keyword">if</span> ( v10 &gt;= a2 )</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">switch</span> ( a1[v10] )                          <span class="comment">// v10 是a1坐标</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        v4[v7] = v5;                            <span class="comment">// v7 是v4坐标</span></span><br><span class="line">        ++v10;</span><br><span class="line">        ++v7;</span><br><span class="line">        ++v9;</span><br><span class="line">        <span class="keyword">break</span>;                                  <span class="comment">// v9 是v3坐标，v3是输入</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        v5 = a1[v10 + <span class="number">1</span>] + v3[v9];</span><br><span class="line">        v10 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        v5 = v3[v9] - LOBYTE(a1[v10 + <span class="number">1</span>]);</span><br><span class="line">        v10 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        v5 = a1[v10 + <span class="number">1</span>] ^ v3[v9];</span><br><span class="line">        v10 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        v5 = a1[v10 + <span class="number">1</span>] * v3[v9];</span><br><span class="line">        v10 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        ++v10;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">if</span> ( v4[v8] != a1[v10 + <span class="number">1</span>] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">"what a shame..."</span>);</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ++v8;</span><br><span class="line">        v10 += <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        v3[v6] = v5;</span><br><span class="line">        ++v10;</span><br><span class="line">        ++v6;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">        read(v3);</span><br><span class="line">        ++v10;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">        v5 = v3[v9] - <span class="number">1</span>;</span><br><span class="line">        ++v10;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">        v5 = v3[v9] + <span class="number">1</span>;</span><br><span class="line">        ++v10;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>unk_403040</code>第一个数就是10，执行了<code>read</code></p>
<p>我淦，我的保存呢，只有未完成的了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span><span class="params">(flag)</span>:</span></span><br><span class="line">	<span class="keyword">global</span> n</span><br><span class="line">	<span class="keyword">if</span> flag==<span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">'rflag['</span>+str(n)+<span class="string">']'</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">a=<span class="string">'''</span></span><br><span class="line"><span class="string">0A 00 00 00 04 00 00 00  10 00 00 00 08 00 00 00</span></span><br><span class="line"><span class="string">03 00 00 00 05 00 00 00  01 00 00 00 04 00 00 00</span></span><br><span class="line"><span class="string">20 00 00 00 08 00 00 00  05 00 00 00 03 00 00 00</span></span><br><span class="line"><span class="string">01 00 00 00 03 00 00 00  02 00 00 00 08 00 00 00</span></span><br><span class="line"><span class="string">0B 00 00 00 01 00 00 00  0C 00 00 00 08 00 00 00</span></span><br><span class="line"><span class="string">04 00 00 00 04 00 00 00  01 00 00 00 05 00 00 00</span></span><br><span class="line"><span class="string">03 00 00 00 08 00 00 00  03 00 00 00 21 00 00 00</span></span><br><span class="line"><span class="string">01 00 00 00 0B 00 00 00  08 00 00 00 0B 00 00 00</span></span><br><span class="line"><span class="string">01 00 00 00 04 00 00 00  09 00 00 00 08 00 00 00</span></span><br><span class="line"><span class="string">03 00 00 00 20 00 00 00  01 00 00 00 02 00 00 00</span></span><br><span class="line"><span class="string">51 00 00 00 08 00 00 00  04 00 00 00 24 00 00 00</span></span><br><span class="line"><span class="string">01 00 00 00 0C 00 00 00  08 00 00 00 0B 00 00 00</span></span><br><span class="line"><span class="string">01 00 00 00 05 00 00 00  02 00 00 00 08 00 00 00</span></span><br><span class="line"><span class="string">02 00 00 00 25 00 00 00  01 00 00 00 02 00 00 00</span></span><br><span class="line"><span class="string">36 00 00 00 08 00 00 00  04 00 00 00 41 00 00 00</span></span><br><span class="line"><span class="string">01 00 00 00 02 00 00 00  20 00 00 00 08 00 00 00</span></span><br><span class="line"><span class="string">05 00 00 00 01 00 00 00  01 00 00 00 05 00 00 00</span></span><br><span class="line"><span class="string">03 00 00 00 08 00 00 00  02 00 00 00 25 00 00 00</span></span><br><span class="line"><span class="string">01 00 00 00 04 00 00 00  09 00 00 00 08 00 00 00</span></span><br><span class="line"><span class="string">03 00 00 00 20 00 00 00  01 00 00 00 02 00 00 00</span></span><br><span class="line"><span class="string">41 00 00 00 08 00 00 00  0C 00 00 00 01 00 00 00</span></span><br><span class="line"><span class="string">07 00 00 00 22 00 00 00  07 00 00 00 3F 00 00 00</span></span><br><span class="line"><span class="string">07 00 00 00 34 00 00 00  07 00 00 00 32 00 00 00</span></span><br><span class="line"><span class="string">07 00 00 00 72 00 00 00  07 00 00 00 33 00 00 00</span></span><br><span class="line"><span class="string">07 00 00 00 18 00 00 00  07 00 00 00 A7 FF FF FF</span></span><br><span class="line"><span class="string">07 00 00 00 31 00 00 00  07 00 00 00 F1 FF FF FF</span></span><br><span class="line"><span class="string">07 00 00 00 28 00 00 00  07 00 00 00 84 FF FF FF</span></span><br><span class="line"><span class="string">07 00 00 00 C1 FF FF FF  07 00 00 00 1E 00 00 00</span></span><br><span class="line"><span class="string">07 00 00 00 7A 00 00 00  00 00 00 00 00 00 00 00</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">listcz= a.replace(<span class="string">'00'</span>,<span class="string">''</span>).replace(<span class="string">'\n'</span>,<span class="string">' '</span>).split()</span><br><span class="line"><span class="keyword">print</span> listcz</span><br><span class="line">enflag=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(listcz)):</span><br><span class="line">	<span class="keyword">if</span> listcz[i]==<span class="string">'07'</span>:</span><br><span class="line">		enflag.append(listcz[i+<span class="number">1</span>])</span><br><span class="line"><span class="keyword">print</span> enflag</span><br><span class="line"><span class="keyword">print</span> len(enflag)</span><br><span class="line"><span class="keyword">print</span> tf(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">cz=[<span class="string">'04'</span>, <span class="string">'10'</span>, <span class="string">'08'</span>, <span class="string">'03'</span>, <span class="string">'05'</span>, <span class="string">'01'</span>, <span class="string">'04'</span>, <span class="string">'20'</span>, <span class="string">'08'</span>, <span class="string">'05'</span>, <span class="string">'03'</span>, <span class="string">'01'</span>, <span class="string">'03'</span>, <span class="string">'02'</span>, <span class="string">'08'</span>, <span class="string">'0B'</span>, <span class="string">'01'</span>, <span class="string">'0C'</span>, <span class="string">'08'</span>, <span class="string">'04'</span>, <span class="string">'04'</span>, <span class="string">'01'</span>, <span class="string">'05'</span>, <span class="string">'03'</span>, <span class="string">'08'</span>, <span class="string">'03'</span>, <span class="string">'21'</span>, <span class="string">'01'</span>, <span class="string">'0B'</span>, <span class="string">'08'</span>, <span class="string">'0B'</span>, <span class="string">'01'</span>, <span class="string">'04'</span>, <span class="string">'09'</span>, <span class="string">'08'</span>, <span class="string">'03'</span>, <span class="string">'20'</span>, <span class="string">'01'</span>, <span class="string">'02'</span>, <span class="string">'51'</span>, <span class="string">'08'</span>, <span class="string">'04'</span>, <span class="string">'24'</span>, <span class="string">'01'</span>, <span class="string">'0C'</span>, <span class="string">'08'</span>, <span class="string">'0B'</span>, <span class="string">'01'</span>, <span class="string">'05'</span>, <span class="string">'02'</span>, <span class="string">'08'</span>, <span class="string">'02'</span>, <span class="string">'25'</span>, <span class="string">'01'</span>, <span class="string">'02'</span>, <span class="string">'36'</span>, <span class="string">'08'</span>, <span class="string">'04'</span>, <span class="string">'41'</span>, <span class="string">'01'</span>, <span class="string">'02'</span>, <span class="string">'20'</span>, <span class="string">'08'</span>, <span class="string">'05'</span>, <span class="string">'01'</span>, <span class="string">'01'</span>, <span class="string">'05'</span>, <span class="string">'03'</span>, <span class="string">'08'</span>, <span class="string">'02'</span>, <span class="string">'25'</span>, <span class="string">'01'</span>, <span class="string">'04'</span>, <span class="string">'09'</span>, <span class="string">'08'</span>, <span class="string">'03'</span>, <span class="string">'20'</span>, <span class="string">'01'</span>, <span class="string">'02'</span>, <span class="string">'41'</span>, <span class="string">'08'</span>, <span class="string">'0C'</span>, <span class="string">'01'</span>]</span><br><span class="line">rflag = [<span class="number">0</span>]*<span class="number">15</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">for i in range(15):</span></span><br><span class="line"><span class="string">    rflag[i] = BitVec('rflag['+str(i)+']',64)</span></span><br><span class="line"><span class="string">s=Solver() </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">str1=<span class="string">'s.add('</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">print</span> len(cz)</span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i==<span class="number">0</span>:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">print</span> i</span><br><span class="line">	<span class="keyword">if</span> cz[i]==<span class="string">'04'</span>:</span><br><span class="line">		str1+=tf(flag)+<span class="string">'^'</span>+<span class="string">'0x'</span>+cz[i+<span class="number">1</span>]</span><br><span class="line">		flag=<span class="number">1</span></span><br><span class="line">		i+=<span class="number">2</span></span><br><span class="line">	<span class="keyword">elif</span> cz[i]==<span class="string">'02'</span>:</span><br><span class="line">		str1+=tf(flag)+<span class="string">'+'</span>+<span class="string">'0x'</span>+cz[i+<span class="number">1</span>]</span><br><span class="line">		flag=<span class="number">1</span></span><br><span class="line">		i+=<span class="number">2</span></span><br><span class="line">	<span class="keyword">elif</span> cz[i]==<span class="string">'03'</span>:</span><br><span class="line">		str1+=tf(flag)+<span class="string">'+'</span>+<span class="string">'0x'</span>+cz[i+<span class="number">1</span>]</span><br><span class="line">		flag=<span class="number">1</span></span><br><span class="line">		i+=<span class="number">2</span></span><br><span class="line">	<span class="keyword">elif</span> cz[i]==<span class="string">'05'</span>:</span><br><span class="line">		str1+=tf(flag)+<span class="string">'*'</span>+<span class="string">'0x'</span>+cz[i+<span class="number">1</span>]</span><br><span class="line">		flag=<span class="number">1</span></span><br><span class="line">		i+=<span class="number">2</span></span><br><span class="line">	<span class="keyword">elif</span> cz[i]==<span class="string">'0c'</span>:</span><br><span class="line">		str1+=tf(flag)+<span class="string">'+'</span>+cz[i+<span class="number">1</span>]</span><br><span class="line">		flag=<span class="number">1</span></span><br><span class="line">		i+=<span class="number">2</span></span><br><span class="line">	<span class="keyword">elif</span> cz[i]==<span class="string">'0B'</span>:</span><br><span class="line">		str1+=tf(flag)+<span class="string">'-'</span>+cz[i+<span class="number">1</span>]</span><br><span class="line">		flag=<span class="number">1</span></span><br><span class="line">		i+=<span class="number">2</span></span><br><span class="line">	<span class="keyword">elif</span> cz[i]==<span class="string">'08'</span>:</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">elif</span> cz[i]==<span class="string">'01'</span>:</span><br><span class="line">		<span class="keyword">print</span> n</span><br><span class="line">		str1+=<span class="string">')'</span></span><br><span class="line">		<span class="keyword">print</span> str1 </span><br><span class="line">		<span class="comment">#eval(str)</span></span><br><span class="line">		n+=<span class="number">1</span></span><br><span class="line">		flag=<span class="number">0</span></span><br><span class="line">		str1=str1[:<span class="number">6</span>]</span><br></pre></td></tr></table></figure>

<p><a href="https://yq.aliyun.com/articles/230560?spm=5176.10695662.1996646101.searchclickresult.196e62ebqoa0dS" target="_blank" rel="noopener">angr</a></p>
<p><a href="https://blog.csdn.net/Breeze_CAT/article/details/106139253" target="_blank" rel="noopener">https://blog.csdn.net/Breeze_CAT/article/details/106139253</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">p = angr.Project(<span class="string">'./signal.exe'</span>)   <span class="comment">#指定angr跑的程序</span></span><br><span class="line">state = p.factory.entry_state()    <span class="comment">#新建一个SimState的对象，得到一个初始化到二进制入口函数的SimState对象。</span></span><br><span class="line">simgr = p.factory.simgr(state)   <span class="comment">#创建simulation manager，angr的主要入口</span></span><br><span class="line"></span><br><span class="line">simgr.explore(find=<span class="number">0x004017A5</span> ,avoid=<span class="number">0x004016E6</span>)  <span class="comment">#争取跑到输出成功的地址，避免跑到输出wrong的地址</span></span><br><span class="line">flag = simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>)[:<span class="number">15</span>]     <span class="comment">#得到flag</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="day33-7-2"><a href="#day33-7-2" class="headerlink" title="day33 7.2"></a>day33 7.2</h2><h3 id="MRCTF2020-PixelShooter"><a href="#MRCTF2020-PixelShooter" class="headerlink" title="[MRCTF2020]PixelShooter"></a>[MRCTF2020]PixelShooter</h3><p>像素射手</p>
<p>安卓逆向</p>
<table>
<thead>
<tr>
<th>内容入口</th>
<th>含义解释</th>
</tr>
</thead>
<tbody><tr>
<td>AndroidManifest.xml</td>
<td>二进制xml文件，提供设备运行应用程序所需的各种信息</td>
</tr>
<tr>
<td>classes.dex</td>
<td>以dex格式编译的应用程序代码</td>
</tr>
<tr>
<td>resources.arsc</td>
<td>包含预编译应用程序资源的二进制XML文件</td>
</tr>
<tr>
<td>res/</td>
<td>此文件夹中包含未编译到resources.arsc文件中的资源</td>
</tr>
<tr>
<td>assets/</td>
<td>此文件夹包含应用程序的原始资源，由AssetManager提供对这些资产文件的访问</td>
</tr>
<tr>
<td>META-INF/</td>
<td>它包含MANIFEST.MF文件，该文件存储有关JAR内容的元数据。APK签名也存储在此文件夹中</td>
</tr>
<tr>
<td>lib/</td>
<td>此文件夹包含已编译的代码，例如本地代码库</td>
</tr>
</tbody></table>
<p>进去打飞机。</p>
<p>unity召唤dnspy，找到Assembly-CSharp，gameover</p>
<h3 id="RoarCTF2019-polyre"><a href="#RoarCTF2019-polyre" class="headerlink" title="[RoarCTF2019]polyre"></a>[RoarCTF2019]polyre</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@lalala re]# ./attachment</span><br><span class="line">Input:flag</span><br><span class="line">Wrong!</span><br></pre></td></tr></table></figure>

<p>ida里看一下，wdf</p>
<p>看wp知道是控制流平坦化，angr环境配半天，docker国内镜像没有，慢的一p</p>
<h2 id="day34-7-3"><a href="#day34-7-3" class="headerlink" title="day34 7.3"></a>day34 7.3</h2><h3 id="GKCTF2020-Chelly’s-identity"><a href="#GKCTF2020-Chelly’s-identity" class="headerlink" title="[GKCTF2020]Chelly’s identity"></a>[GKCTF2020]Chelly’s identity</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hi.Are you know <span class="keyword">of</span> chelly?</span><br><span class="line">Can you speak chelly's identity?</span><br><span class="line"><span class="keyword">if</span> you can, I will give you flag.</span><br><span class="line">Give your answer:</span><br><span class="line">my wife</span><br><span class="line">bad long!</span><br><span class="line">请按任意键继续. . .</span><br></pre></td></tr></table></figure>

<p>题目错了</p>
<p>flag是16位，可以通过ida看出来或手动试试</p>
<ul>
<li>对输入(v43)动手脚</li>
</ul>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for <span class="comment">( i = 0; ; ++i )</span></span><br><span class="line">&#123;</span><br><span class="line">  v<span class="number">17</span> = sub_<span class="number">631771</span><span class="comment">(&amp;v43)</span>;</span><br><span class="line">  <span class="keyword">if</span> <span class="comment">( v17 == sub_6311D6(&amp;v42)</span> )</span><br><span class="line">    break;</span><br><span class="line">  v<span class="number">40</span> = *<span class="comment">(char *)</span>sub_<span class="number">631528</span><span class="comment">(i)</span>;</span><br><span class="line">  sub_<span class="number">6315</span>D<span class="number">2</span><span class="comment">(&amp;v40)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>sub_631771</code> 和 <code>sub_6311D6</code> 最后都调用了 <code>sub_6314DD</code></p>
<p>先看判断<code>sub_411852</code></p>
<p><code>sub_4112F8</code>应该是开辟空间的</p>
<h2 id="day35-7-8"><a href="#day35-7-8" class="headerlink" title="day35 7.8"></a>day35 7.8</h2><h3 id="challenge1"><a href="#challenge1" class="headerlink" title="challenge1"></a>challenge1</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">v6 = <span class="string">"x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q"</span>;</span><br><span class="line">  WriteFile(hFile, <span class="string">"Enter password:\r\n"</span>, <span class="number">0x12</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  ReadFile(v7, &amp;Buffer, <span class="number">0x80</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  v5 = sub_401260((<span class="keyword">int</span>)&amp;Buffer, NumberOfBytesWritten - <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(v5, v6) )</span><br><span class="line">    WriteFile(hFile, <span class="string">"Correct!\r\n"</span>, <span class="number">0xB</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    WriteFile(hFile, <span class="string">"Wrong password\r\n"</span>, <span class="number">0x11</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p><code>sub_401260</code>很明显是一个base64，换表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">eflag=<span class="string">"x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q"</span></span><br><span class="line">be64=<span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line">base64=<span class="string">"ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> eflag:</span><br><span class="line">    <span class="keyword">if</span> i ==<span class="string">"="</span>:</span><br><span class="line">        flag+=<span class="string">"="</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=be64[base64.find(i)]</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line">flag= base64.b64decode(flag)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<h3 id="Zer0pts2020-easy-strcmp"><a href="#Zer0pts2020-easy-strcmp" class="headerlink" title="[Zer0pts2020]easy strcmp"></a>[Zer0pts2020]easy strcmp</h3><p>main函数很简单，就是输入strcmp zer0pts{*******<em>CENSORED*******\</em>}</p>
<p>找到对输入操作的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_6EA</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; *(_BYTE *)(i + a1); ++i )</span><br><span class="line">    ;</span><br><span class="line">  v4 = (i &gt;&gt; <span class="number">3</span>) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v4; ++j )</span><br><span class="line">    *(_QWORD *)(<span class="number">8</span> * j + a1) -= qword_201060[j];</span><br><span class="line">  <span class="keyword">return</span> qword_201090(a1, a2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qword_201060    dq <span class="number">0</span>, <span class="number">410</span>A4335494A0942h, <span class="number">0</span>B0EF2F50BE619F0h, <span class="number">4</span>F0A3A064A35282Bh</span><br></pre></td></tr></table></figure>

<p>第一个for循环获得输入位数，第二个for循环将输入分为8位一组减去一个数，所以zer0pts{-0还是zer0pts{。</p>
<p>写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">enflag=<span class="string">"********CENSORED********"</span></span><br><span class="line">num=[<span class="number">0x410A4335494A0942</span>, <span class="number">0x0B0EF2F50BE619F0</span>, <span class="number">0x4F0A3A064A35282B</span>]</span><br><span class="line"><span class="keyword">print</span> len(enflag)</span><br><span class="line"></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">	<span class="keyword">print</span> i</span><br><span class="line">	<span class="keyword">print</span> enflag[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>][::<span class="number">-1</span>]</span><br><span class="line">	t = binascii.b2a_hex(enflag[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>][::<span class="number">-1</span>])</span><br><span class="line">	a=hex(num[i]+int(t,<span class="number">16</span>))</span><br><span class="line">	flag+= binascii.a2b_hex(str(a).replace(<span class="string">'0x'</span>,<span class="string">''</span>).replace(<span class="string">'L'</span>,<span class="string">''</span>))[::<span class="number">-1</span>]</span><br><span class="line">	</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>

<p>一开始没有考虑大小端问题，中间CENSORED出错了。</p>
<h2 id="day36-7-13"><a href="#day36-7-13" class="headerlink" title="day36 7.13"></a>day36 7.13</h2><h3 id="安洵杯-2019-game"><a href="#安洵杯-2019-game" class="headerlink" title="[安洵杯 2019]game"></a>[安洵杯 2019]game</h3><p>控制流平坦化，恶心</p>
<h3 id="ACTF新生赛2020-Universe-final-answer"><a href="#ACTF新生赛2020-Universe-final-answer" class="headerlink" title="[ACTF新生赛2020]Universe_final_answer"></a>[ACTF新生赛2020]Universe_final_answer</h3><p>判断语句</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( sub_860(&amp;v5) )</span><br><span class="line">&#123;</span><br><span class="line">  sub_C50(&amp;v5, &amp;v4);</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, <span class="string">"Judgement pass! flag is actf&#123;%s_%s&#125;\n"</span>, &amp;v5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数<code>sub_860</code>一大堆判断</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="number">-85</span> * v9 + <span class="number">58</span> * v8 + <span class="number">97</span> * v6 + v7 + <span class="number">-45</span> * v5 + <span class="number">84</span> * v4 + <span class="number">95</span> * v2 - <span class="number">20</span> * v1 + <span class="number">12</span> * v3 == <span class="number">12613</span> )</span><br><span class="line">&#123;</span><br><span class="line">  v11 = a1[<span class="number">9</span>];</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">30</span> * v11 + <span class="number">-70</span> * v9 + <span class="number">-122</span> * v6 + <span class="number">-81</span> * v7 + <span class="number">-66</span> * v5 + <span class="number">-115</span> * v4 + <span class="number">-41</span> * v3 + <span class="number">-86</span> * v1 - <span class="number">15</span> * v2 - <span class="number">30</span> * v8 == <span class="number">-54400</span></span><br><span class="line">    &amp;&amp; <span class="number">-103</span> * v11 + <span class="number">120</span> * v8 + <span class="number">108</span> * v7 + <span class="number">48</span> * v4 + <span class="number">-89</span> * v3 + <span class="number">78</span> * v1 - <span class="number">41</span> * v2 + <span class="number">31</span> * v5 - (v6 &lt;&lt; <span class="number">6</span>) - <span class="number">120</span> * v9 == <span class="number">-10283</span></span><br><span class="line">    &amp;&amp; <span class="number">71</span> * v6 + (v7 &lt;&lt; <span class="number">7</span>) + <span class="number">99</span> * v5 + <span class="number">-111</span> * v3 + <span class="number">85</span> * v1 + <span class="number">79</span> * v2 - <span class="number">30</span> * v4 - <span class="number">119</span> * v8 + <span class="number">48</span> * v9 - <span class="number">16</span> * v11 == <span class="number">22855</span></span><br><span class="line">    &amp;&amp; <span class="number">5</span> * v11 + <span class="number">23</span> * v9 + <span class="number">122</span> * v8 + <span class="number">-19</span> * v6 + <span class="number">99</span> * v7 + <span class="number">-117</span> * v5 + <span class="number">-69</span> * v3 + <span class="number">22</span> * v1 - <span class="number">98</span> * v2 + <span class="number">10</span> * v4 == <span class="number">-2944</span></span><br><span class="line">    &amp;&amp; <span class="number">-54</span> * v11 + <span class="number">-23</span> * v8 + <span class="number">-82</span> * v3 + <span class="number">-85</span> * v2 + <span class="number">124</span> * v1 - <span class="number">11</span> * v4 - <span class="number">8</span> * v5 - <span class="number">60</span> * v7 + <span class="number">95</span> * v6 + <span class="number">100</span> * v9 == <span class="number">-2222</span></span><br><span class="line">    &amp;&amp; <span class="number">-83</span> * v11 + <span class="number">-111</span> * v7 + <span class="number">-57</span> * v2 + <span class="number">41</span> * v1 + <span class="number">73</span> * v3 - <span class="number">18</span> * v4 + <span class="number">26</span> * v5 + <span class="number">16</span> * v6 + <span class="number">77</span> * v8 - <span class="number">63</span> * v9 == <span class="number">-13258</span></span><br><span class="line">    &amp;&amp; <span class="number">81</span> * v11 + <span class="number">-48</span> * v9 + <span class="number">66</span> * v8 + <span class="number">-104</span> * v6 + <span class="number">-121</span> * v7 + <span class="number">95</span> * v5 + <span class="number">85</span> * v4 + <span class="number">60</span> * v3 + <span class="number">-85</span> * v2 + <span class="number">80</span> * v1 == <span class="number">-1559</span></span><br><span class="line">    &amp;&amp; <span class="number">101</span> * v11 + <span class="number">-85</span> * v9 + <span class="number">7</span> * v6 + <span class="number">117</span> * v7 + <span class="number">-83</span> * v5 + <span class="number">-101</span> * v4 + <span class="number">90</span> * v3 + <span class="number">-28</span> * v1 + <span class="number">18</span> * v2 - v8 == <span class="number">6308</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">99</span> * v11 + <span class="number">-28</span> * v9 + <span class="number">5</span> * v8 + <span class="number">93</span> * v6 + <span class="number">-18</span> * v7 + <span class="number">-127</span> * v5 + <span class="number">6</span> * v4 + <span class="number">-9</span> * v3 + <span class="number">-93</span> * v1 + <span class="number">58</span> * v2 == <span class="number">-1697</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>z3求一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#申明未知量</span></span><br><span class="line">v1 = BitVec(<span class="string">'v1'</span>,<span class="number">10</span>)</span><br><span class="line">v2 = BitVec(<span class="string">'v2'</span>,<span class="number">10</span>)</span><br><span class="line">v3 = BitVec(<span class="string">'v3'</span>,<span class="number">10</span>)</span><br><span class="line">v4 = BitVec(<span class="string">'v4'</span>,<span class="number">10</span>)</span><br><span class="line">v5 = BitVec(<span class="string">'v5'</span>,<span class="number">10</span>)</span><br><span class="line">v6 = BitVec(<span class="string">'v6'</span>,<span class="number">10</span>)</span><br><span class="line">v7 = BitVec(<span class="string">'v7'</span>,<span class="number">10</span>)</span><br><span class="line">v8 = BitVec(<span class="string">'v8'</span>,<span class="number">10</span>)</span><br><span class="line">v9 = BitVec(<span class="string">'v9'</span>,<span class="number">10</span>)</span><br><span class="line">v11 = BitVec(<span class="string">'v11'</span>,<span class="number">10</span>)</span><br><span class="line">s=Solver() <span class="comment"># 创建约束求解器</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加约束条件</span></span><br><span class="line">s.add( <span class="number">-85</span> * v9 + <span class="number">58</span> * v8 + <span class="number">97</span> * v6 + v7 + <span class="number">-45</span> * v5 + <span class="number">84</span> * v4 + <span class="number">95</span> * v2 - <span class="number">20</span> * v1 + <span class="number">12</span> * v3 == <span class="number">12613</span> )</span><br><span class="line">s.add( <span class="number">30</span> * v11 + <span class="number">-70</span> * v9 + <span class="number">-122</span> * v6 + <span class="number">-81</span> * v7 + <span class="number">-66</span> * v5 + <span class="number">-115</span> * v4 + <span class="number">-41</span> * v3 + <span class="number">-86</span> * v1 - <span class="number">15</span> * v2 - <span class="number">30</span> * v8 == <span class="number">-54400</span> )</span><br><span class="line">s.add( <span class="number">-103</span> * v11 + <span class="number">120</span> * v8 + <span class="number">108</span> * v7 + <span class="number">48</span> * v4 + <span class="number">-89</span> * v3 + <span class="number">78</span> * v1 - <span class="number">41</span> * v2 + <span class="number">31</span> * v5 - (v6 &lt;&lt; <span class="number">6</span>) - <span class="number">120</span> * v9 == <span class="number">-10283</span> )</span><br><span class="line">s.add( <span class="number">71</span> * v6 + (v7 &lt;&lt; <span class="number">7</span>) + <span class="number">99</span> * v5 + <span class="number">-111</span> * v3 + <span class="number">85</span> * v1 + <span class="number">79</span> * v2 - <span class="number">30</span> * v4 - <span class="number">119</span> * v8 + <span class="number">48</span> * v9 - <span class="number">16</span> * v11 == <span class="number">22855</span> )</span><br><span class="line">s.add( <span class="number">5</span> * v11 + <span class="number">23</span> * v9 + <span class="number">122</span> * v8 + <span class="number">-19</span> * v6 + <span class="number">99</span> * v7 + <span class="number">-117</span> * v5 + <span class="number">-69</span> * v3 + <span class="number">22</span> * v1 - <span class="number">98</span> * v2 + <span class="number">10</span> * v4 == <span class="number">-2944</span> )</span><br><span class="line">s.add( <span class="number">-54</span> * v11 + <span class="number">-23</span> * v8 + <span class="number">-82</span> * v3 + <span class="number">-85</span> * v2 + <span class="number">124</span> * v1 - <span class="number">11</span> * v4 - <span class="number">8</span> * v5 - <span class="number">60</span> * v7 + <span class="number">95</span> * v6 + <span class="number">100</span> * v9 == <span class="number">-2222</span> )</span><br><span class="line">s.add( <span class="number">-83</span> * v11 + <span class="number">-111</span> * v7 + <span class="number">-57</span> * v2 + <span class="number">41</span> * v1 + <span class="number">73</span> * v3 - <span class="number">18</span> * v4 + <span class="number">26</span> * v5 + <span class="number">16</span> * v6 + <span class="number">77</span> * v8 - <span class="number">63</span> * v9 == <span class="number">-13258</span> )</span><br><span class="line">s.add( <span class="number">81</span> * v11 + <span class="number">-48</span> * v9 + <span class="number">66</span> * v8 + <span class="number">-104</span> * v6 + <span class="number">-121</span> * v7 + <span class="number">95</span> * v5 + <span class="number">85</span> * v4 + <span class="number">60</span> * v3 + <span class="number">-85</span> * v2 + <span class="number">80</span> * v1 == <span class="number">-1559</span> )</span><br><span class="line">s.add( <span class="number">101</span> * v11 + <span class="number">-85</span> * v9 + <span class="number">7</span> * v6 + <span class="number">117</span> * v7 + <span class="number">-83</span> * v5 + <span class="number">-101</span> * v4 + <span class="number">90</span> * v3 + <span class="number">-28</span> * v1 + <span class="number">18</span> * v2 - v8 == <span class="number">6308</span> )</span><br><span class="line">s.add( <span class="number">99</span> * v11 + <span class="number">-28</span> * v9 + <span class="number">5</span> * v8 + <span class="number">93</span> * v6 + <span class="number">-18</span> * v7 + <span class="number">-127</span> * v5 + <span class="number">6</span> * v4 + <span class="number">-9</span> * v3 + <span class="number">-93</span> * v1 + <span class="number">58</span> * v2 == <span class="number">-1697</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否有解</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> s.check()</span><br><span class="line"></span><br><span class="line">m=s.model()</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> m.decls():   <span class="comment"># decls()返回model包含了所有符号的列表</span></span><br><span class="line">    print(<span class="string">"%s = %s"</span> % (d.name(),m[d]))</span><br></pre></td></tr></table></figure>

<p>注意位置，这是一半：F0uRT_y7w@</p>
<p>淦，里面还有6、7位置</p>
<p>第二部分就是9异或字符串</p>
<p>再将数字变为字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f1=<span class="string">'F0uRTy_7w@'</span></span><br><span class="line">f2=<span class="number">9</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f1:</span><br><span class="line">	f2^=ord(i)</span><br><span class="line"><span class="keyword">print</span> f1+<span class="string">'_'</span>+str(f2)</span><br></pre></td></tr></table></figure>

<h2 id="day37-7-31"><a href="#day37-7-31" class="headerlink" title="day37 7.31"></a>day37 7.31</h2><h3 id="ACTF新生赛2020-Oruga"><a href="#ACTF新生赛2020-Oruga" class="headerlink" title="[ACTF新生赛2020]Oruga"></a>[ACTF新生赛2020]Oruga</h3><p>tell me the flag</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"Tell me the flag:"</span>, <span class="number">0L</span>L);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line"><span class="built_in">strcpy</span>(s2, <span class="string">"actf&#123;"</span>);</span><br><span class="line">LODWORD(v4) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v4 &lt;= <span class="number">4</span> )</span><br><span class="line">&#123;</span><br><span class="line">  *((_BYTE *)&amp;v4 + (<span class="keyword">signed</span> <span class="keyword">int</span>)v4 + <span class="number">4</span>) = s[(<span class="keyword">signed</span> <span class="keyword">int</span>)v4];</span><br><span class="line">  LODWORD(v4) = v4 + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">v8 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v4 + <span class="number">4</span>, s2) )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)sub_78A(s, s2) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"That's True Flag!"</span>, v6);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"don't stop trying..."</span>, v7);</span><br><span class="line">  result = <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Format false!"</span>, s2, v5);</span><br><span class="line">  result = <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中<code>if ( !strcmp((const char *)&amp;v4 + 4, s2) )</code>就是判断flag格式是否为<code>actf{</code>，然后进入<code>sub_78A</code> 。</p>
<p>看到</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">if</span> ( *(_BYTE *)(<span class="built_in">v3</span> + <span class="built_in">a1</span>) != <span class="string">'W'</span> <span class="title">||</span> <span class="built_in">v4</span> == -<span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="meta">if</span> ( *(_BYTE *)(<span class="built_in">v3</span> + <span class="built_in">a1</span>) != <span class="string">'E'</span> <span class="title">||</span> <span class="built_in">v4</span> == <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="meta">if</span> ( *(_BYTE *)(<span class="built_in">v3</span> + <span class="built_in">a1</span>) != <span class="string">'M'</span> <span class="title">||</span> <span class="built_in">v4</span> == <span class="number">16</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="meta">if</span> ( *(_BYTE *)(<span class="built_in">v3</span> + <span class="built_in">a1</span>) != <span class="string">'J'</span> <span class="title">||</span> <span class="built_in">v4</span> == -<span class="number">1</span> )</span><br><span class="line">            return <span class="number">0</span>LL<span class="comment">;</span></span><br><span class="line">          <span class="built_in">v4</span> = -<span class="number">1</span><span class="comment">;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">v4</span> = <span class="number">16</span><span class="comment">;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="meta">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">v4</span> = <span class="number">1</span><span class="comment">;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">v4</span> = -<span class="number">16</span><span class="comment">;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这样子就感觉是个迷宫，W上，E右，M下，J左。把byte_201020数据提取，一行16个。奇怪的是一组判断</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( !byte_201020[v2] )</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">if</span> ( v4 == <span class="number">-1</span> &amp;&amp; !(v2 &amp; <span class="number">0xF</span>) )</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">     <span class="keyword">if</span> ( v4 == <span class="number">1</span> &amp;&amp; v2 % <span class="number">16</span> == <span class="number">15</span> )</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">     <span class="keyword">if</span> ( v4 == <span class="number">16</span> &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v2 - <span class="number">240</span>) &lt;= <span class="number">15</span> )</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">     <span class="keyword">if</span> ( v4 == <span class="number">-16</span> &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v2 + <span class="number">15</span>) &lt;= <span class="number">30</span> )</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">     v2 += v4;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>前4个if应该是判断出界，后面v2+=v4就是当byte_201020[v2]==0时可以继续走。</p>
<p>走到21h结束</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">23</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">23</span> <span class="number">23</span> <span class="number">23</span> <span class="number">23</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">23</span> <span class="number">23</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">4</span>F <span class="number">4</span>F <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">4</span>F <span class="number">4</span>F <span class="number">00</span> <span class="number">50</span> <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">4</span>C <span class="number">00</span> <span class="number">4</span>F <span class="number">4</span>F <span class="number">00</span> <span class="number">4</span>F <span class="number">4</span>F <span class="number">00</span> <span class="number">50</span> <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">4</span>C <span class="number">00</span> <span class="number">4</span>F <span class="number">4</span>F <span class="number">00</span> <span class="number">4</span>F <span class="number">4</span>F <span class="number">00</span> <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">4</span>C <span class="number">4</span>C <span class="number">00</span> <span class="number">4</span>F <span class="number">4</span>F <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">4</span>F <span class="number">4</span>F <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">23</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">23</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">4</span>D <span class="number">4</span>D <span class="number">4</span>D <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">23</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">4</span>D <span class="number">4</span>D <span class="number">4</span>D <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">45</span> <span class="number">45</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">30</span> <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">45</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">45</span> <span class="number">45</span></span><br><span class="line"><span class="number">54</span> <span class="number">54</span> <span class="number">54</span> <span class="number">49</span> <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">45</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">54</span> <span class="number">00</span> <span class="number">49</span> <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">45</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">54</span> <span class="number">00</span> <span class="number">49</span> <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">4</span>D <span class="number">00</span> <span class="number">4</span>D <span class="number">21</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">45</span> <span class="number">45</span></span><br></pre></td></tr></table></figure>

<p>flag{MEWEMEWJMEWJM}</p>
<h2 id="day38-8-1"><a href="#day38-8-1" class="headerlink" title="day38 8.1"></a>day38 8.1</h2><h3 id="FlareOn5-Ultimate-Minesweeper"><a href="#FlareOn5-Ultimate-Minesweeper" class="headerlink" title="[FlareOn5]Ultimate Minesweeper"></a>[FlareOn5]Ultimate Minesweeper</h3><blockquote>
<p>  You hacked your way into the Minesweeper Championship, good job. Now its time to compete. Here is the Ultimate Minesweeper binary. Beat it, win the championship, and we’ll move you on to greater challenges.</p>
<p>  Hint:本题解出相应字符串后请用flag{}包裹，形如：flag{123456@flare-on.com}</p>
</blockquote>
<p>900个格子，897个雷，好玩。这是net程序，用dnspy打开，这个题目应该是让我们去修改雷个数或什么东西。</p>
<p><code>getkey</code>里有个数组很像flag</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">string</span> <span class="title">GetKey</span>(<span class="params">List&lt;<span class="keyword">uint</span>&gt; revealedCells</span>)</span></span><br><span class="line"><span class="function"></span>		&#123;</span><br><span class="line">			revealedCells.Sort();</span><br><span class="line">			Random random = <span class="keyword">new</span> Random(Convert.ToInt32(revealedCells[<span class="number">0</span>] &lt;&lt; <span class="number">20</span> | revealedCells[<span class="number">1</span>] &lt;&lt; <span class="number">10</span> | revealedCells[<span class="number">2</span>]));</span><br><span class="line">			<span class="keyword">byte</span>[] array = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">32</span>];</span><br><span class="line">			<span class="keyword">byte</span>[] array2 = <span class="keyword">new</span> <span class="keyword">byte</span>[]</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="number">245</span>,</span><br><span class="line">				<span class="number">75</span>,</span><br><span class="line">				<span class="number">65</span>,</span><br><span class="line">				<span class="number">142</span>,</span><br><span class="line">				<span class="number">68</span>,</span><br><span class="line">				<span class="number">71</span>,</span><br><span class="line">				<span class="number">100</span>,</span><br><span class="line">				<span class="number">185</span>,</span><br><span class="line">				<span class="number">74</span>,</span><br><span class="line">				<span class="number">127</span>,</span><br><span class="line">				<span class="number">62</span>,</span><br><span class="line">				<span class="number">130</span>,</span><br><span class="line">				<span class="number">231</span>,</span><br><span class="line">				<span class="number">129</span>,</span><br><span class="line">				<span class="number">254</span>,</span><br><span class="line">				<span class="number">243</span>,</span><br><span class="line">				<span class="number">28</span>,</span><br><span class="line">				<span class="number">58</span>,</span><br><span class="line">				<span class="number">103</span>,</span><br><span class="line">				<span class="number">179</span>,</span><br><span class="line">				<span class="number">60</span>,</span><br><span class="line">				<span class="number">91</span>,</span><br><span class="line">				<span class="number">195</span>,</span><br><span class="line">				<span class="number">215</span>,</span><br><span class="line">				<span class="number">102</span>,</span><br><span class="line">				<span class="number">145</span>,</span><br><span class="line">				<span class="number">154</span>,</span><br><span class="line">				<span class="number">27</span>,</span><br><span class="line">				<span class="number">57</span>,</span><br><span class="line">				<span class="number">231</span>,</span><br><span class="line">				<span class="number">241</span>,</span><br><span class="line">				<span class="number">86</span></span><br><span class="line">			&#125;;</span><br><span class="line">			random.NextBytes(array);</span><br><span class="line">			<span class="keyword">uint</span> num = <span class="number">0U</span>;</span><br><span class="line">			<span class="keyword">while</span> ((<span class="keyword">ulong</span>)num &lt; (<span class="keyword">ulong</span>)((<span class="keyword">long</span>)array2.Length))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">byte</span>[] array3 = array2;</span><br><span class="line">				<span class="keyword">uint</span> num2 = num;</span><br><span class="line">				array3[(<span class="keyword">int</span>)num2] = (array3[(<span class="keyword">int</span>)num2] ^ array[(<span class="keyword">int</span>)num]);</span><br><span class="line">				num += <span class="number">1U</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> Encoding.ASCII.GetString(array2);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>但<code>random.NextBytes(array);</code>有随机数，放弃。</p>
<p><code>AllocateMemory</code>是生成雷区</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">AllocateMemory</span>(<span class="params">MineField mf</span>)</span></span><br><span class="line"><span class="function"></span>		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">uint</span> num = <span class="number">0U</span>; num &lt; MainForm.VALLOC_NODE_LIMIT; num += <span class="number">1U</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">uint</span> num2 = <span class="number">0U</span>; num2 &lt; MainForm.VALLOC_NODE_LIMIT; num2 += <span class="number">1U</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">					<span class="keyword">uint</span> r = num + <span class="number">1U</span>;</span><br><span class="line">					<span class="keyword">uint</span> c = num2 + <span class="number">1U</span>;</span><br><span class="line">					<span class="keyword">if</span> (<span class="keyword">this</span>.VALLOC_TYPES.Contains(<span class="keyword">this</span>.DeriveVallocType(r, c)))</span><br><span class="line">					&#123;</span><br><span class="line">						flag = <span class="literal">false</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					mf.GarbageCollect[(<span class="keyword">int</span>)num2, (<span class="keyword">int</span>)num] = flag;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>将<code>if (this.VALLOC_TYPES.Contains(this.DeriveVallocType(r, c)))</code>改成<code>if ((r == 1U &amp;&amp; c == 1U) || (r == 1U &amp;&amp; c == 2U) || (r == 1U &amp;&amp; c == 3U))</code>后安全区改为（1.1）（1.2）（1.3）但最后输出flag错误，这是因为<code>random.NextBytes(array);</code>随机数用到了安全坐标。</p>
<p>再看<code>getkey</code>的引用</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SquareRevealedCallback</span>(<span class="params"><span class="keyword">uint</span> column, <span class="keyword">uint</span> row</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.MineField.BombRevealed)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">this</span>.stopwatch.Stop();</span><br><span class="line">		Application.DoEvents();</span><br><span class="line">		Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">		<span class="keyword">new</span> FailurePopup().ShowDialog();</span><br><span class="line">		Application.Exit();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">this</span>.RevealedCells.Add(row * MainForm.VALLOC_NODE_LIMIT + column);</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.MineField.TotalUnrevealedEmptySquares == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">this</span>.stopwatch.Stop();</span><br><span class="line">		Application.DoEvents();</span><br><span class="line">		Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">		<span class="keyword">new</span> SuccessPopup(<span class="keyword">this</span>.GetKey(<span class="keyword">this</span>.RevealedCells)).ShowDialog();</span><br><span class="line">		Application.Exit();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很明显两个判断，第一个是雷。先改程序，把第一个<code>Thread.Sleep(1000);new FailurePopup().ShowDialog();Application.Exit();</code>删了就可以找三个点。</p>
<p>但是这样还是很麻烦，需要一个一个点，根据<a href="https://www.cnblogs.com/harmonica11/p/12917262.html" target="_blank" rel="noopener">Harmonica_11</a>可以在AllocateMemory添加</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Console</span>.Write(r);</span><br><span class="line"><span class="built_in">Console</span>.Write(c);<span class="comment">//断点下在这</span></span><br></pre></td></tr></table></figure>

<h3 id="安洵杯-2019-game-1"><a href="#安洵杯-2019-game-1" class="headerlink" title="[安洵杯 2019]game"></a>[安洵杯 2019]game</h3><p>emm，再搞一次</p>
<p>主要函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( v7 == <span class="number">-2071121728</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = blank_num((<span class="keyword">int</span> (*)[<span class="number">9</span>])sudoku);</span><br><span class="line">        v5 = (<span class="keyword">signed</span> <span class="keyword">int</span> *)mem_alloc(v4);</span><br><span class="line">        trace((__int64)sudoku, v5, v4);</span><br><span class="line">        check((<span class="keyword">int</span> (*)[<span class="number">9</span>])sudoku);</span><br><span class="line">        check1(&amp;v8);</span><br><span class="line">        check3(&amp;v8);</span><br><span class="line">        v9 = <span class="number">0</span>;</span><br><span class="line">        v7 = <span class="number">-303742386</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v7 != <span class="number">-1804515313</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v3 = <span class="number">-2071121728</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v10 )</span><br><span class="line">        v3 = <span class="number">664169471</span>;</span><br><span class="line">      v7 = v3;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v7 == <span class="number">-303742386</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v7 == <span class="number">664169471</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"error"</span>);</span><br><span class="line">      check((<span class="keyword">int</span> (*)[<span class="number">9</span>])sudoku);</span><br><span class="line">      v9 = <span class="number">0</span>;</span><br><span class="line">      v7 = <span class="number">-303742386</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>进入<code>blank_num</code>，理清流程</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">v6 = <span class="number">0</span>;</span><br><span class="line">v8 = <span class="number">0</span>;</span><br><span class="line">v5 = <span class="number">1046773218</span>;</span><br><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( v5 == <span class="number">-1892951115</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    v5 = <span class="number">-1048142948</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">-1585203536</span> )                    <span class="comment">// 退出</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">switch</span> ( v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">-1237447983</span>:</span><br><span class="line">      v5 = <span class="number">1058605341</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">-1048142948</span>:</span><br><span class="line">      v2 = <span class="number">-1237447983</span>;                       <span class="comment">// 2.</span></span><br><span class="line">                                              <span class="comment">// v7&gt;9 ++v8 回到1</span></span><br><span class="line">      <span class="keyword">if</span> ( v7 &lt; <span class="number">9</span> )                           <span class="comment">// v7&lt;9 进入3</span></span><br><span class="line">        v2 = <span class="number">1501457574</span>;</span><br><span class="line">      v5 = v2;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">-1026222996</span>:</span><br><span class="line">      ++v7;</span><br><span class="line">      v5 = <span class="number">-1048142948</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">-516195663</span>:</span><br><span class="line">      ++v6;</span><br><span class="line">      v5 = <span class="number">710936108</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">710936108</span>:</span><br><span class="line">      v5 = <span class="number">-1026222996</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1046773218</span>:                          <span class="comment">// 1.</span></span><br><span class="line">      v1 = <span class="number">-1585203536</span>;                       <span class="comment">// v8&gt;9 退出</span></span><br><span class="line">      <span class="keyword">if</span> ( v8 &lt; <span class="number">9</span> )                           <span class="comment">// v8&lt;9 设v7=0，进入2</span></span><br><span class="line">        v1 = <span class="number">-1892951115</span>;</span><br><span class="line">      v5 = v1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1058605341</span>:</span><br><span class="line">      ++v8;</span><br><span class="line">      v5 = <span class="number">1046773218</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1501457574</span>:                          <span class="comment">// 3.</span></span><br><span class="line">      v3 = <span class="number">710936108</span>;                         <span class="comment">// sudoku[9*v8+v7]!=0 ++v7 回到2</span></span><br><span class="line">      <span class="keyword">if</span> ( !(*a1)[<span class="number">9</span> * v8 + v7] )              <span class="comment">// sudoku[9*v8+v7] =0 ++v6 ++v7 回到2</span></span><br><span class="line">        v3 = <span class="number">-516195663</span>;</span><br><span class="line">      v5 = v3;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> v6;</span><br></pre></td></tr></table></figure>

<p>其实到最后就是<code>if ( !(*a1)[9 * v8 + v7] )</code>然后返回了数独数组中0的个数，动调后发现返回值为40。</p>
<p><code>trace((__int64)sudoku, v5, v4);</code> 和 <code>check((int (*)[9])sudoku);</code> 感觉没用，一来它们的返回值没有用，二没有改变sudoku，pass。（这个不清楚）</p>
<p> <code>check1</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">while</span> ( v10 == <span class="number">-2084833488</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                  v8 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">                  v9 = <span class="number">-67245798</span>;</span><br><span class="line">                  <span class="keyword">if</span> ( v12 &lt; v8 )               <span class="comment">// v12&lt;flag长度</span></span><br><span class="line">                    v9 = <span class="number">1974939745</span>;</span><br><span class="line">                  v10 = v9;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ( v10 != <span class="number">-1988665894</span> )</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">                v12 = <span class="number">0</span>;</span><br><span class="line">                v10 = <span class="number">-2084833488</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> ( v10 != <span class="number">-1393133668</span> )</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              v5 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">              v6 = <span class="number">-1988665894</span>;                 <span class="comment">// v12&gt;flag长度 v12=0 进入4</span></span><br><span class="line">              <span class="keyword">if</span> ( v12 &lt; v5 )</span><br><span class="line">                v6 = <span class="number">-1018472136</span>;</span><br><span class="line">              v10 = v6;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v10 != <span class="number">-1018472136</span> )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            v7 = a1[v12];</span><br><span class="line">            a1[v12] = a1[v12 + <span class="number">1</span>];</span><br><span class="line">            a1[v12 + <span class="number">1</span>] = v7;</span><br><span class="line">            v10 = <span class="number">-146751883</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( v10 != <span class="number">-831482631</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++v12;</span><br><span class="line">          v10 = <span class="number">-2084833488</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( v10 != <span class="number">-291294424</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        ++v11;</span><br><span class="line">        ++v12;</span><br><span class="line">        v10 = <span class="number">1519002972</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v10 != <span class="number">-146751883</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v12 += <span class="number">2</span>;</span><br><span class="line">      v10 = <span class="number">-1393133668</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    result = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v10 + <span class="number">67245798</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v10 == <span class="number">-67245798</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">75381312</span>:                            <span class="comment">// 2.</span></span><br><span class="line">        v4 = a1[v12];                           <span class="comment">// flag[v11] [v12]互换 (前后部分)</span></span><br><span class="line">        a1[v12] = a1[v11];</span><br><span class="line">        a1[v11] = v4;</span><br><span class="line">        v10 = <span class="number">-291294424</span>;                       <span class="comment">// ++v11 ++v12 回1</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1519002972</span>:                          <span class="comment">// 1.</span></span><br><span class="line">        v2 = <span class="built_in">strlen</span>(a1);                        <span class="comment">// v2=flag长度</span></span><br><span class="line">        v3 = <span class="number">1555725255</span>;                        <span class="comment">// v11&gt;flag长度一半 v12=0 进入3</span></span><br><span class="line">        <span class="keyword">if</span> ( v11 &lt; v2 &gt;&gt; <span class="number">1</span> )                    <span class="comment">// v11&lt;flag长度一半 进入2</span></span><br><span class="line">          v3 = <span class="number">75381312</span>;</span><br><span class="line">        v10 = v3;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1555725255</span>:                          <span class="comment">// 3.</span></span><br><span class="line">        v12 = <span class="number">0</span>;                                <span class="comment">// flag[v12][v12+1]互换，v12+=2...... 当全部换完后进入4 v12=0</span></span><br><span class="line">        v10 = <span class="number">-1393133668</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1974939745</span>:                          <span class="comment">// 4.</span></span><br><span class="line">        a1[v12] = (a1[v12] &amp; <span class="number">0xF3</span> | ~a1[v12] &amp; <span class="number">0xC</span>) - <span class="number">20</span>;</span><br><span class="line">        v10 = <span class="number">-831482631</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>所以check1将flag先前后互换、两位互换，最后a1[v12] = (a1[v12] &amp; 0xF3 | ~a1[v12] &amp; 0xC) - 20;</p>
<p><code>check3</code> </p>
<p>没什么用，只有里面<code>check2</code>有用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line">s = a1;</span><br><span class="line">v13 = <span class="number">0</span>;</span><br><span class="line">v12 = <span class="number">1</span>;</span><br><span class="line">v15 = <span class="number">0</span>;</span><br><span class="line">v11 = <span class="number">-2671583</span>;</span><br><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )                                   <span class="comment">// 1.</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )                               <span class="comment">// 3.</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">while</span> ( <span class="number">1</span> )                       <span class="comment">// 4.</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                  &#123;</span><br><span class="line">                    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                    &#123;</span><br><span class="line">                      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                      &#123;</span><br><span class="line">                        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                        &#123;</span><br><span class="line">                          <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                          &#123;</span><br><span class="line">                            <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">                            &#123;</span><br><span class="line">                              <span class="keyword">while</span> ( v11 == <span class="number">-2119125118</span> )</span><br><span class="line">                              &#123;</span><br><span class="line">                                ++v15;</span><br><span class="line">                                v11 = <span class="number">-94879051</span>;</span><br><span class="line">                              &#125;</span><br><span class="line">                              <span class="keyword">if</span> ( v11 != <span class="number">-1998111552</span> )</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                              v6 = <span class="number">396170963</span>;</span><br><span class="line">                              <span class="keyword">if</span> ( v15 &lt; <span class="number">9</span> )</span><br><span class="line">                                v6 = <span class="number">-512482015</span>;</span><br><span class="line">                              v11 = v6;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">if</span> ( v11 != <span class="number">-1695072055</span> )</span><br><span class="line">                              <span class="keyword">break</span>;</span><br><span class="line">                            ++v15;</span><br><span class="line">                            v11 = <span class="number">-1998111552</span>;</span><br><span class="line">                          &#125;</span><br><span class="line">                          <span class="keyword">if</span> ( v11 != <span class="number">-1658909923</span> )</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                          v8 = <span class="number">-1129833658</span>;</span><br><span class="line">                          <span class="keyword">if</span> ( D0g3[<span class="number">9</span> * v15 + v14] != sudoku[<span class="number">9</span> * v15 + v14] )</span><br><span class="line">                            v8 = <span class="number">-528396247</span>;</span><br><span class="line">                          v11 = v8;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> ( v11 != <span class="number">-1613667829</span> )</span><br><span class="line">                          <span class="keyword">break</span>;</span><br><span class="line">                        v11 = <span class="number">-2119125118</span>;</span><br><span class="line">                      &#125;</span><br><span class="line">                      <span class="keyword">if</span> ( v11 != <span class="number">-1369143226</span> )</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                      v14 = <span class="number">0</span>;</span><br><span class="line">                      v11 = <span class="number">-740861019</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> ( v11 != <span class="number">-1244045086</span> )</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                    D0g3[<span class="number">9</span> * v15 + v14] = v16[v13++];</span><br><span class="line">                    v11 = <span class="number">1611237474</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">if</span> ( v11 != <span class="number">-1129833658</span> )</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                  v11 = <span class="number">-90011013</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ( v11 != <span class="number">-740861019</span> )</span><br><span class="line">                  <span class="keyword">break</span>;                      <span class="comment">// 4.</span></span><br><span class="line">                v4 = <span class="number">-1613667829</span>;             <span class="comment">// v14&gt;9 ++v15 回3.</span></span><br><span class="line">                <span class="keyword">if</span> ( v14 &lt; <span class="number">9</span> )                <span class="comment">// v14&lt;9 进入5</span></span><br><span class="line">                  v4 = <span class="number">705300330</span>;</span><br><span class="line">                v11 = v4;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> ( v11 != <span class="number">-528396247</span> )</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              v12 = <span class="number">0</span>;</span><br><span class="line">              v11 = <span class="number">1954800504</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v11 != <span class="number">-512482015</span> )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            v14 = <span class="number">0</span>;</span><br><span class="line">            v11 = <span class="number">564268595</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( v11 != <span class="number">-334121999</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v15 = <span class="number">0</span>;</span><br><span class="line">          v11 = <span class="number">-1998111552</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( v11 != <span class="number">-94879051</span> )</span><br><span class="line">          <span class="keyword">break</span>;                              <span class="comment">// 3.</span></span><br><span class="line">        v3 = <span class="number">-334121999</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v15 &lt; <span class="number">9</span> )                        <span class="comment">// v15&lt;9 v14=0 进入4</span></span><br><span class="line">          v3 = <span class="number">-1369143226</span>;</span><br><span class="line">        v11 = v3;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v11 != <span class="number">-90011013</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      ++v14;</span><br><span class="line">      v11 = <span class="number">564268595</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v11 != <span class="number">-2671583</span> )</span><br><span class="line">      <span class="keyword">break</span>;                                  <span class="comment">// 1.</span></span><br><span class="line">    v1 = <span class="built_in">strlen</span>(s);</span><br><span class="line">    v2 = <span class="number">2101131376</span>;                          <span class="comment">// v15&gt;flag v15=0 打印回车 进入3.</span></span><br><span class="line">    <span class="keyword">if</span> ( v15 &lt; v1 )                           <span class="comment">// v15&lt;flag 进入2.</span></span><br><span class="line">      v2 = <span class="number">441246003</span>;</span><br><span class="line">    v11 = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v11 == <span class="number">396170963</span> )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">switch</span> ( v11 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">430996436</span>:</span><br><span class="line">      ++v15;</span><br><span class="line">      v11 = <span class="number">-2671583</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">441246003</span>:                           <span class="comment">// 2.</span></span><br><span class="line">      v16[v15] = s[v15] - <span class="number">232084296</span> + <span class="number">232084248</span>;<span class="comment">// v16[v15]=s[v15]-48</span></span><br><span class="line">      v11 = <span class="number">430996436</span>;                        <span class="comment">// ++v15 回1.</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">564268595</span>:</span><br><span class="line">      v7 = <span class="number">1954800504</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v14 &lt; <span class="number">9</span> )</span><br><span class="line">        v7 = <span class="number">-1658909923</span>;</span><br><span class="line">      v11 = v7;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">705300330</span>:                           <span class="comment">// 5.</span></span><br><span class="line">      v5 = <span class="number">1611237474</span>;                        <span class="comment">// D0g3[9 * v15 + v14]!=0 进入6</span></span><br><span class="line">      <span class="keyword">if</span> ( !D0g3[<span class="number">9</span> * v15 + v14] )             <span class="comment">// D0g3[9 * v15 + v14]=0 D0g3[9 * v15 + v14] = v16[v13++]; 进入6</span></span><br><span class="line">        v5 = <span class="number">-1244045086</span>;</span><br><span class="line">      v11 = v5;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1611237474</span>:                          <span class="comment">// 6.</span></span><br><span class="line">      v11 = <span class="number">2119231421</span>;                       <span class="comment">// ++v14 回4</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1908623879</span>:</span><br><span class="line">      v11 = <span class="number">-1695072055</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1954800504</span>:</span><br><span class="line">      v9 = <span class="number">1908623879</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !v12 )</span><br><span class="line">        v9 = <span class="number">2014359934</span>;</span><br><span class="line">      v11 = v9;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2014359934</span>:</span><br><span class="line">      v11 = <span class="number">396170963</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2101131376</span>:</span><br><span class="line">      v15 = <span class="number">0</span>;</span><br><span class="line">      v11 = <span class="number">-94879051</span>;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2119231421</span>:</span><br><span class="line">      ++v14;</span><br><span class="line">      v11 = <span class="number">-740861019</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>流程：dog3=flag-48==sudoku</p>
<p>现在需要知道前后的sudoku，动调。不知道为什么dd变db了</p>
<p><a href="https://imgchr.com/i/a8I9KO" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/08/01/a8I9KO.png" alt="a8I9KO.png"></a></p>
<p><img src="https://s1.ax1x.com/2020/08/01/a85vP1.png" alt="a85vP1.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sudoku = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">dog3   = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>]</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">81</span>):</span><br><span class="line">    <span class="keyword">if</span> dog3[i] == <span class="number">0</span>:</span><br><span class="line">        num = ord(str(sudoku[i])) + <span class="number">20</span></span><br><span class="line">        flag.append( num&amp;<span class="number">0xf3</span> | ~num&amp;<span class="number">0xc</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">40</span>,<span class="number">2</span>):</span><br><span class="line">    (flag[i], flag[i+<span class="number">1</span>]) = (flag[i+<span class="number">1</span>], flag[i])</span><br><span class="line">	</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">    (flag[i],flag[i+<span class="number">20</span>]) = (flag[i+<span class="number">20</span>], flag[i])</span><br><span class="line">	</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">print</span> chr(flag[i]),</span><br></pre></td></tr></table></figure>

<h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><p><a href="https://baike.baidu.com/item/NET" target="_blank" rel="noopener">NET</a>语言的全称应该是ASP.NET，是<a href="https://baike.baidu.com/item/微软/124767" target="_blank" rel="noopener">微软</a>新推出的一种<a href="https://baike.baidu.com/item/编程/139828" target="_blank" rel="noopener">编程</a>框架理论或者说是一种编程标准，它可以通过微软出品的Visual Studio 开发工具进行项目开发，应用于网站类的开发一般使用C#语言进行编写，应用程序类一般使用VB进行编写。</p>
<p>unity是用C#开发，被编译到了 Assembly-CSharp.dll</p>
<p><em>C#</em>是微软公司发布的一种由C和C++衍生出来的面向对象的编程语言、运行于.NET Framework和.NET Core(完全开源，跨平台)之上的高级程序设计语言。</p>
<p>dnSpy 是一款针对 .NET 程序的逆向工程工具。</p>
<h3 id="lo、hiword"><a href="#lo、hiword" class="headerlink" title="lo、hiword"></a>lo、hiword</h3><p>LOWORD()得到一个32bit数的低16bit<br>HIWORD()得到一个32bit数的高16bit<br>LOBYTE()得到一个16bit数最低（最右边）那个字节<br>HIBYTE()得到一个16bit数最高（最左边）那个字节</p>
<h3 id="IDA逆向常用宏定义"><a href="#IDA逆向常用宏定义" class="headerlink" title="IDA逆向常用宏定义"></a>IDA逆向常用宏定义</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   This file contains definitions used by the Hex-Rays decompiler output.</span></span><br><span class="line"><span class="comment">   It has type definitions and convenience macros to make the</span></span><br><span class="line"><span class="comment">   output more readable.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   Copyright (c) 2007-2011 Hex-Rays</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(__GNUC__)</span></span><br><span class="line">  <span class="keyword">typedef</span>          <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> __int64 long long</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> __int32 int</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> __int16 short</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> __int8  char</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> MAKELL(num) num ## LL</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> FMT_64 <span class="meta-string">"ll"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">elif</span> defined(_MSC_VER)</span></span><br><span class="line">  <span class="keyword">typedef</span>          __int64 ll;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="keyword">unsigned</span> __int64 ull;</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> MAKELL(num) num ## i64</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> FMT_64 <span class="meta-string">"I64"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">elif</span> defined (__BORLANDC__)</span></span><br><span class="line">  <span class="keyword">typedef</span>          __int64 ll;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="keyword">unsigned</span> __int64 ull;</span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> MAKELL(num) num ## i64</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> FMT_64 <span class="meta-string">"L"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">error</span> <span class="meta-string">"unknown compiler"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uint;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> uchar;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> ushort;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> ulong;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span>          <span class="keyword">char</span>   int8;</span><br><span class="line"><span class="keyword">typedef</span>   <span class="keyword">signed</span> <span class="keyword">char</span>   sint8;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span>   uint8;</span><br><span class="line"><span class="keyword">typedef</span>          <span class="keyword">short</span>  int16;</span><br><span class="line"><span class="keyword">typedef</span>   <span class="keyword">signed</span> <span class="keyword">short</span>  sint16;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">short</span>  uint16;</span><br><span class="line"><span class="keyword">typedef</span>          <span class="keyword">int</span>    int32;</span><br><span class="line"><span class="keyword">typedef</span>   <span class="keyword">signed</span> <span class="keyword">int</span>    sint32;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span>    uint32;</span><br><span class="line"><span class="keyword">typedef</span> ll              int64;</span><br><span class="line"><span class="keyword">typedef</span> ll              sint64;</span><br><span class="line"><span class="keyword">typedef</span> ull             uint64;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Partially defined types:</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _BYTE  uint8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _WORD  uint16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _DWORD uint32</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _QWORD uint64</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined(_MSC_VER)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _LONGLONG __int128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _WINDOWS_</span></span><br><span class="line"><span class="keyword">typedef</span> int8 BYTE;</span><br><span class="line"><span class="keyword">typedef</span> int16 WORD;</span><br><span class="line"><span class="keyword">typedef</span> int32 DWORD;</span><br><span class="line"><span class="keyword">typedef</span> int32 LONG;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="keyword">typedef</span> int64 QWORD;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> <span class="keyword">bool</span>;       <span class="comment">// we want to use bool in our C programs</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Some convenience macros to make partial accesses nicer</span></span><br><span class="line"><span class="comment">// first unsigned macros:</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LOBYTE(x)   (*((_BYTE*)&amp;(x)))   <span class="comment">// low byte</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LOWORD(x)   (*((_WORD*)&amp;(x)))   <span class="comment">// low word</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LODWORD(x)  (*((_DWORD*)&amp;(x)))  <span class="comment">// low dword</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HIBYTE(x)   (*((_BYTE*)&amp;(x)+1))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HIWORD(x)   (*((_WORD*)&amp;(x)+1))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HIDWORD(x)  (*((_DWORD*)&amp;(x)+1))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTEn(x, n)   (*((_BYTE*)&amp;(x)+n))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORDn(x, n)   (*((_WORD*)&amp;(x)+n))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE1(x)   BYTEn(x,  1)         <span class="comment">// byte 1 (counting from 0)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE2(x)   BYTEn(x,  2)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE3(x)   BYTEn(x,  3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE4(x)   BYTEn(x,  4)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE5(x)   BYTEn(x,  5)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE6(x)   BYTEn(x,  6)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE7(x)   BYTEn(x,  7)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE8(x)   BYTEn(x,  8)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE9(x)   BYTEn(x,  9)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE10(x)  BYTEn(x, 10)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE11(x)  BYTEn(x, 11)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE12(x)  BYTEn(x, 12)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE13(x)  BYTEn(x, 13)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE14(x)  BYTEn(x, 14)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BYTE15(x)  BYTEn(x, 15)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORD1(x)   WORDn(x,  1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORD2(x)   WORDn(x,  2)         <span class="comment">// third word of the object, unsigned</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORD3(x)   WORDn(x,  3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORD4(x)   WORDn(x,  4)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORD5(x)   WORDn(x,  5)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORD6(x)   WORDn(x,  6)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORD7(x)   WORDn(x,  7)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// now signed macros (the same but with sign extension)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SLOBYTE(x)   (*((int8*)&amp;(x)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SLOWORD(x)   (*((int16*)&amp;(x)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SLODWORD(x)  (*((int32*)&amp;(x)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHIBYTE(x)   (*((int8*)&amp;(x)+1))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHIWORD(x)   (*((int16*)&amp;(x)+1))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHIDWORD(x)  (*((int32*)&amp;(x)+1))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTEn(x, n)   (*((int8*)&amp;(x)+n))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SWORDn(x, n)   (*((int16*)&amp;(x)+n))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE1(x)   SBYTEn(x,  1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE2(x)   SBYTEn(x,  2)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE3(x)   SBYTEn(x,  3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE4(x)   SBYTEn(x,  4)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE5(x)   SBYTEn(x,  5)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE6(x)   SBYTEn(x,  6)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE7(x)   SBYTEn(x,  7)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE8(x)   SBYTEn(x,  8)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE9(x)   SBYTEn(x,  9)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE10(x)  SBYTEn(x, 10)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE11(x)  SBYTEn(x, 11)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE12(x)  SBYTEn(x, 12)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE13(x)  SBYTEn(x, 13)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE14(x)  SBYTEn(x, 14)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SBYTE15(x)  SBYTEn(x, 15)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SWORD1(x)   SWORDn(x,  1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SWORD2(x)   SWORDn(x,  2)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SWORD3(x)   SWORDn(x,  3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SWORD4(x)   SWORDn(x,  4)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SWORD5(x)   SWORDn(x,  5)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SWORD6(x)   SWORDn(x,  6)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SWORD7(x)   SWORDn(x,  7)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Helper functions to represent some assembly instructions.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Fill memory block with an integer value</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">memset32</span><span class="params">(<span class="keyword">void</span> *ptr, uint32 value, <span class="keyword">int</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  uint32 *p = (uint32 *)ptr;</span><br><span class="line">  <span class="keyword">for</span> ( <span class="keyword">int</span> i=<span class="number">0</span>; i &lt; count; i++ )</span><br><span class="line">    *p++ = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate a reference to pair of operands</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;  <span class="title">int16</span> __<span class="title">PAIR__</span>( <span class="title">int8</span>  <span class="title">high</span>, <span class="title">T</span> <span class="title">low</span>) &#123;</span> <span class="keyword">return</span> ((( int16)high) &lt;&lt; <span class="keyword">sizeof</span>(high)*<span class="number">8</span>) | uint8(low); &#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;  <span class="title">int32</span> __<span class="title">PAIR__</span>( <span class="title">int16</span> <span class="title">high</span>, <span class="title">T</span> <span class="title">low</span>) &#123;</span> <span class="keyword">return</span> ((( int32)high) &lt;&lt; <span class="keyword">sizeof</span>(high)*<span class="number">8</span>) | uint16(low); &#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;  <span class="title">int64</span> __<span class="title">PAIR__</span>( <span class="title">int32</span> <span class="title">high</span>, <span class="title">T</span> <span class="title">low</span>) &#123;</span> <span class="keyword">return</span> ((( int64)high) &lt;&lt; <span class="keyword">sizeof</span>(high)*<span class="number">8</span>) | uint32(low); &#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">uint16</span> __<span class="title">PAIR__</span>(<span class="title">uint8</span>  <span class="title">high</span>, <span class="title">T</span> <span class="title">low</span>) &#123;</span> <span class="keyword">return</span> (((uint16)high) &lt;&lt; <span class="keyword">sizeof</span>(high)*<span class="number">8</span>) | uint8(low); &#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">uint32</span> __<span class="title">PAIR__</span>(<span class="title">uint16</span> <span class="title">high</span>, <span class="title">T</span> <span class="title">low</span>) &#123;</span> <span class="keyword">return</span> (((uint32)high) &lt;&lt; <span class="keyword">sizeof</span>(high)*<span class="number">8</span>) | uint16(low); &#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">uint64</span> __<span class="title">PAIR__</span>(<span class="title">uint32</span> <span class="title">high</span>, <span class="title">T</span> <span class="title">low</span>) &#123;</span> <span class="keyword">return</span> (((uint64)high) &lt;&lt; <span class="keyword">sizeof</span>(high)*<span class="number">8</span>) | uint32(low); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// rotate left</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">T</span> __<span class="title">ROL__</span>(<span class="title">T</span> <span class="title">value</span>, <span class="title">uint</span> <span class="title">count</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">const</span> uint nbits = <span class="keyword">sizeof</span>(T) * <span class="number">8</span>;</span><br><span class="line">  count %= nbits;</span><br><span class="line"></span><br><span class="line">  T high = value &gt;&gt; (nbits - count);</span><br><span class="line">  value &lt;&lt;= count;</span><br><span class="line">  value |= high;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// rotate right</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">T</span> __<span class="title">ROR__</span>(<span class="title">T</span> <span class="title">value</span>, <span class="title">uint</span> <span class="title">count</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">const</span> uint nbits = <span class="keyword">sizeof</span>(T) * <span class="number">8</span>;</span><br><span class="line">  count %= nbits;</span><br><span class="line"></span><br><span class="line">  T low = value &lt;&lt; (nbits - count);</span><br><span class="line">  value &gt;&gt;= count;</span><br><span class="line">  value |= low;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// carry flag of left shift</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">int8</span> __<span class="title">MKCSHL__</span>(<span class="title">T</span> <span class="title">value</span>, <span class="title">uint</span> <span class="title">count</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">const</span> uint nbits = <span class="keyword">sizeof</span>(T) * <span class="number">8</span>;</span><br><span class="line">  count %= nbits;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (value &gt;&gt; (nbits-count)) &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// carry flag of right shift</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">int8</span> __<span class="title">MKCSHR__</span>(<span class="title">T</span> <span class="title">value</span>, <span class="title">uint</span> <span class="title">count</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">return</span> (value &gt;&gt; (count<span class="number">-1</span>)) &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// sign flag</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">int8</span> __<span class="title">SETS__</span>(<span class="title">T</span> <span class="title">x</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="keyword">sizeof</span>(T) == <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">return</span> int8(x) &lt; <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="keyword">sizeof</span>(T) == <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> int16(x) &lt; <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="keyword">sizeof</span>(T) == <span class="number">4</span> )</span><br><span class="line">    <span class="keyword">return</span> int32(x) &lt; <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> int64(x) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// overflow flag of subtraction (x-y)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="title">class</span> <span class="title">U</span>&gt; <span class="title">int8</span> __<span class="title">OFSUB__</span>(<span class="title">T</span> <span class="title">x</span>, <span class="title">U</span> <span class="title">y</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="keyword">sizeof</span>(T) &lt; <span class="keyword">sizeof</span>(U) )</span><br><span class="line">  &#123;</span><br><span class="line">    U x2 = x;</span><br><span class="line">    int8 sx = __SETS__(x2);</span><br><span class="line">    <span class="keyword">return</span> (sx ^ __SETS__(y)) &amp; (sx ^ __SETS__(x2-y));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    T y2 = y;</span><br><span class="line">    int8 sx = __SETS__(x);</span><br><span class="line">    <span class="keyword">return</span> (sx ^ __SETS__(y2)) &amp; (sx ^ __SETS__(x-y2));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// overflow flag of addition (x+y)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="title">class</span> <span class="title">U</span>&gt; <span class="title">int8</span> __<span class="title">OFADD__</span>(<span class="title">T</span> <span class="title">x</span>, <span class="title">U</span> <span class="title">y</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="keyword">sizeof</span>(T) &lt; <span class="keyword">sizeof</span>(U) )</span><br><span class="line">  &#123;</span><br><span class="line">    U x2 = x;</span><br><span class="line">    int8 sx = __SETS__(x2);</span><br><span class="line">    <span class="keyword">return</span> ((<span class="number">1</span> ^ sx) ^ __SETS__(y)) &amp; (sx ^ __SETS__(x2+y));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    T y2 = y;</span><br><span class="line">    int8 sx = __SETS__(x);</span><br><span class="line">    <span class="keyword">return</span> ((<span class="number">1</span> ^ sx) ^ __SETS__(y2)) &amp; (sx ^ __SETS__(x+y2));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// carry flag of subtraction (x-y)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="title">class</span> <span class="title">U</span>&gt; <span class="title">int8</span> __<span class="title">CFSUB__</span>(<span class="title">T</span> <span class="title">x</span>, <span class="title">U</span> <span class="title">y</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">int</span> size = <span class="keyword">sizeof</span>(T) &gt; <span class="keyword">sizeof</span>(U) ? <span class="keyword">sizeof</span>(T) : <span class="keyword">sizeof</span>(U);</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">return</span> uint8(x) &lt; uint8(y);</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> uint16(x) &lt; uint16(y);</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">4</span> )</span><br><span class="line">    <span class="keyword">return</span> uint32(x) &lt; uint32(y);</span><br><span class="line">  <span class="keyword">return</span> uint64(x) &lt; uint64(y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// carry flag of addition (x+y)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="title">class</span> <span class="title">U</span>&gt; <span class="title">int8</span> __<span class="title">CFADD__</span>(<span class="title">T</span> <span class="title">x</span>, <span class="title">U</span> <span class="title">y</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">int</span> size = <span class="keyword">sizeof</span>(T) &gt; <span class="keyword">sizeof</span>(U) ? <span class="keyword">sizeof</span>(T) : <span class="keyword">sizeof</span>(U);</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">return</span> uint8(x) &gt; uint8(x+y);</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> uint16(x) &gt; uint16(x+y);</span><br><span class="line">  <span class="keyword">if</span> ( size == <span class="number">4</span> )</span><br><span class="line">    <span class="keyword">return</span> uint32(x) &gt; uint32(x+y);</span><br><span class="line">  <span class="keyword">return</span> uint64(x) &gt; uint64(x+y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="comment">// The following definition is not quite correct because it always returns</span></span><br><span class="line"><span class="comment">// uint64. The above C++ functions are good, though.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __PAIR__(high, low) (((uint64)(high)&lt;&lt;sizeof(high)*8) | low)</span></span><br><span class="line"><span class="comment">// For C, we just provide macros, they are not quite correct.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __ROL__(x, y) __rotl__(x, y)      <span class="comment">// Rotate left</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __ROR__(x, y) __rotr__(x, y)      <span class="comment">// Rotate right</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __CFSHL__(x, y) invalid_operation <span class="comment">// Generate carry flag for (x&lt;&lt;y)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __CFSHR__(x, y) invalid_operation <span class="comment">// Generate carry flag for (x&gt;&gt;y)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __CFADD__(x, y) invalid_operation <span class="comment">// Generate carry flag for (x+y)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __CFSUB__(x, y) invalid_operation <span class="comment">// Generate carry flag for (x-y)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __OFADD__(x, y) invalid_operation <span class="comment">// Generate overflow flag for (x+y)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __OFSUB__(x, y) invalid_operation <span class="comment">// Generate overflow flag for (x-y)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// No definition for rcl/rcr because the carry flag is unknown</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __RCL__(x, y)    invalid_operation <span class="comment">// Rotate left thru carry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __RCR__(x, y)    invalid_operation <span class="comment">// Rotate right thru carry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __MKCRCL__(x, y) invalid_operation <span class="comment">// Generate carry flag for a RCL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __MKCRCR__(x, y) invalid_operation <span class="comment">// Generate carry flag for a RCR</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __SETP__(x, y)   invalid_operation <span class="comment">// Generate parity flag for (x-y)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// In the decompilation listing there are some objects declarared as _UNKNOWN</span></span><br><span class="line"><span class="comment">// because we could not determine their types. Since the C compiler does not</span></span><br><span class="line"><span class="comment">// accept void item declarations, we replace them by anything of our choice,</span></span><br><span class="line"><span class="comment">// for example a char:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _UNKNOWN char</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _MSC_VER</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> snprintf _snprintf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> vsnprintf _vsnprintf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h3 id="Tea-XTea-XXTea"><a href="#Tea-XTea-XXTea" class="headerlink" title="Tea/XTea/XXTea"></a>Tea/XTea/XXTea</h3><h4 id="Tea"><a href="#Tea" class="headerlink" title="Tea"></a>Tea</h4><p>在<a href="https://zh.wikipedia.org/wiki/密码学" target="_blank" rel="noopener">密码学</a>中，<strong>微型加密算法</strong>（Tiny Encryption Algorithm，TEA）是一种易于描述和<a href="https://zh.wikipedia.org/w/index.php?title=执行&action=edit&redlink=1" target="_blank" rel="noopener">执行</a>的<a href="https://zh.wikipedia.org/wiki/塊密碼" target="_blank" rel="noopener">块密码</a>，通常只需要很少的代码就可实现。其设计者是<a href="https://zh.wikipedia.org/wiki/剑桥大学" target="_blank" rel="noopener">剑桥大学计算机实验室</a>的<a href="https://zh.wikipedia.org/w/index.php?title=大卫·惠勒&action=edit&redlink=1" target="_blank" rel="noopener">大卫 · 惠勒</a>与<a href="https://zh.wikipedia.org/w/index.php?title=罗杰·尼达姆&action=edit&redlink=1" target="_blank" rel="noopener">罗杰 · 尼达姆</a>。</p>
<p>参考代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span> <span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);  </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span> <span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;                                   </span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密前原始数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    encrypt(v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"解密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="XTea"><a href="#XTea" class="headerlink" title="XTea"></a>XTea</h4><p>XTEA是TEA的升级版，增加了更多的密钥表，移位和异或操作等等，设计者是Roger Needham, David Wheeler</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encipher</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> num_rounds, <span class="keyword">uint32_t</span> v[<span class="number">2</span>], <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, delta=<span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decipher</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> num_rounds, <span class="keyword">uint32_t</span> v[<span class="number">2</span>], <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], delta=<span class="number">0x9E3779B9</span>, sum=delta*num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="keyword">const</span> k[<span class="number">4</span>]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> r=<span class="number">32</span>;<span class="comment">//num_rounds建议取值为32</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密前原始数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    encipher(r, v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    decipher(r, v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"解密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="XXTea"><a href="#XXTea" class="headerlink" title="XXTea"></a>XXTea</h4><p>XXTEA，又称Corrected Block TEA，是XTEA的升级版，设计者是Roger Needham, David Wheeler</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">btea</span><span class="params">(<span class="keyword">uint32_t</span> *v, <span class="keyword">int</span> n, <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="keyword">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v[<span class="number">2</span>]= &#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="keyword">const</span> k[<span class="number">4</span>]= &#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> n= <span class="number">2</span>; <span class="comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密前原始数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    btea(v, n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    btea(v, -n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"解密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">############################################################  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># The implementation of PHPRPC Protocol 3.0                #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># xxtea.py                                                 #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># Release 3.0.0                                            #  </span></span><br><span class="line"><span class="comment"># Copyright (c) 2005-2008 by Team-PHPRPC                   #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># WebSite:  http://www.phprpc.org/                         #  </span></span><br><span class="line"><span class="comment">#           http://www.phprpc.net/                         #  </span></span><br><span class="line"><span class="comment">#           http://www.phprpc.com/                         #  </span></span><br><span class="line"><span class="comment">#           http://sourceforge.net/projects/php-rpc/       #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># Authors:  Ma Bingyao &lt;andot@ujn.edu.cn&gt;                  #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment"># This file may be distributed and/or modified under the   #  </span></span><br><span class="line"><span class="comment"># terms of the GNU Lesser General Public License (LGPL)    #  </span></span><br><span class="line"><span class="comment"># version 3.0 as published by the Free Software Foundation #  </span></span><br><span class="line"><span class="comment"># and appearing in the included file LICENSE.              #  </span></span><br><span class="line"><span class="comment">#                                                          #  </span></span><br><span class="line"><span class="comment">############################################################  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># XXTEA encryption arithmetic library.  </span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># Copyright (C) 2005-2008 Ma Bingyao &lt;andot@ujn.edu.cn&gt;  </span></span><br><span class="line"><span class="comment"># Version: 1.0  </span></span><br><span class="line"><span class="comment"># LastModified: Oct 5, 2008  </span></span><br><span class="line"><span class="comment"># This library is free.  You can redistribute it and/or modify it.  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> struct  </span><br><span class="line">  </span><br><span class="line">_DELTA = <span class="number">0x9E3779B9</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_long2str</span><span class="params">(v, w)</span>:</span>  </span><br><span class="line">    n = (len(v) - <span class="number">1</span>) &lt;&lt; <span class="number">2</span>  </span><br><span class="line">    <span class="keyword">if</span> w:  </span><br><span class="line">        m = v[<span class="number">-1</span>]  </span><br><span class="line">        <span class="keyword">if</span> (m &lt; n - <span class="number">3</span>) <span class="keyword">or</span> (m &gt; n): <span class="keyword">return</span> <span class="string">''</span>  </span><br><span class="line">        n = m  </span><br><span class="line">    s = struct.pack(<span class="string">'&lt;%iL'</span> % len(v), *v)  </span><br><span class="line">    <span class="keyword">return</span> s[<span class="number">0</span>:n] <span class="keyword">if</span> w <span class="keyword">else</span> s  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_str2long</span><span class="params">(s, w)</span>:</span>  </span><br><span class="line">    n = len(s)  </span><br><span class="line">    m = (<span class="number">4</span> - (n &amp; <span class="number">3</span>) &amp; <span class="number">3</span>) + n  </span><br><span class="line">    s = s.ljust(m, <span class="string">"\0"</span>)  </span><br><span class="line">    v = list(struct.unpack(<span class="string">'&lt;%iL'</span> % (m &gt;&gt; <span class="number">2</span>), s))  </span><br><span class="line">    <span class="keyword">if</span> w: v.append(n)  </span><br><span class="line">    <span class="keyword">return</span> v  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(str, key)</span>:</span>  </span><br><span class="line">    <span class="keyword">if</span> str == <span class="string">''</span>: <span class="keyword">return</span> str  </span><br><span class="line">    v = _str2long(str, <span class="literal">True</span>)  </span><br><span class="line">    k = _str2long(key.ljust(<span class="number">16</span>, <span class="string">"\0"</span>), <span class="literal">False</span>)  </span><br><span class="line">    n = len(v) - <span class="number">1</span>  </span><br><span class="line">    z = v[n]  </span><br><span class="line">    y = v[<span class="number">0</span>]  </span><br><span class="line">    sum = <span class="number">0</span>  </span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> // (n + <span class="number">1</span>)  </span><br><span class="line">    <span class="keyword">while</span> q &gt; <span class="number">0</span>:  </span><br><span class="line">        sum = (sum + _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        e = sum &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span>  </span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> xrange(n):  </span><br><span class="line">            y = v[p + <span class="number">1</span>]  </span><br><span class="line">            v[p] = (v[p] + ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (sum ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">            z = v[p]  </span><br><span class="line">        y = v[<span class="number">0</span>]  </span><br><span class="line">        v[n] = (v[n] + ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (sum ^ y) + (k[n &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        z = v[n]  </span><br><span class="line">        q -= <span class="number">1</span>  </span><br><span class="line">    <span class="keyword">return</span> _long2str(v, <span class="literal">False</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(str, key)</span>:</span>  </span><br><span class="line">    <span class="keyword">if</span> str == <span class="string">''</span>: <span class="keyword">return</span> str  </span><br><span class="line">    v = _str2long(str, <span class="literal">False</span>)  </span><br><span class="line">    k = _str2long(key.ljust(<span class="number">16</span>, <span class="string">"\0"</span>), <span class="literal">False</span>)  </span><br><span class="line">    n = len(v) - <span class="number">1</span>  </span><br><span class="line">    z = v[n]  </span><br><span class="line">    y = v[<span class="number">0</span>]  </span><br><span class="line">    q = <span class="number">6</span> + <span class="number">52</span> // (n + <span class="number">1</span>)  </span><br><span class="line">    sum = (q * _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">    <span class="keyword">while</span> (sum != <span class="number">0</span>):  </span><br><span class="line">        e = sum &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span>  </span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> xrange(n, <span class="number">0</span>, <span class="number">-1</span>):  </span><br><span class="line">            z = v[p - <span class="number">1</span>]  </span><br><span class="line">            v[p] = (v[p] - ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (sum ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">            y = v[p]  </span><br><span class="line">        z = v[n]  </span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>) ^ (sum ^ y) + (k[<span class="number">0</span> &amp; <span class="number">3</span> ^ e] ^ z))) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">        y = v[<span class="number">0</span>]  </span><br><span class="line">        sum = (sum - _DELTA) &amp; <span class="number">0xffffffff</span>  </span><br><span class="line">    <span class="keyword">return</span> _long2str(v, <span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:  </span><br><span class="line">    <span class="keyword">print</span> decrypt(encrypt(<span class="string">'Hello XXTEA!'</span>, <span class="string">'16bytelongstring'</span>), <span class="string">'16bytelongstring'</span>)</span><br></pre></td></tr></table></figure>

<p>原文链接：<a href="https://blog.csdn.net/gsls200808/java/article/details/48243019" target="_blank" rel="noopener">https://blog.csdn.net/gsls200808/java/article/details/48243019</a></p>
<h3 id="write-readfile"><a href="#write-readfile" class="headerlink" title="write/readfile"></a>write/readfile</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">WriteFile</span><span class="params">( </span></span></span><br><span class="line"><span class="function"><span class="params">  HANDLE hFile, </span></span></span><br><span class="line"><span class="function"><span class="params">  LPCVOID lpBuffer, </span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD nNumberOfBytesToWrite, </span></span></span><br><span class="line"><span class="function"><span class="params">  LPDWORD lpNumberOfBytesWritten, </span></span></span><br><span class="line"><span class="function"><span class="params">  LPOVERLAPPED lpOverlapped</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>; </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">参量</span></span><br><span class="line"><span class="comment">hFile</span></span><br><span class="line"><span class="comment">[in]处理要写入的文件。必须已使用GENERIC_WRITE访问该文件的文件句柄。</span></span><br><span class="line"><span class="comment">lpBuffer</span></span><br><span class="line"><span class="comment">[in]指向包含要写入文件的数据的缓冲区的指针。</span></span><br><span class="line"><span class="comment">nNumberOfBytesToWrite</span></span><br><span class="line"><span class="comment">[输入]要写入文件的字节数。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">零值表示空写入操作。空写入操作不会写入任何字节，但是会导致时间戳发生变化。此功能不会截断文件。要截断或扩展文件，请使用SetEndOfFile函数。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">lpNumberOfBytesWritten</span></span><br><span class="line"><span class="comment">[out]指向此函数调用写入的字节数的指针。在执行操作或检查错误之前，此功能将此值设置为零。</span></span><br><span class="line"><span class="comment">lpOverlapped</span></span><br><span class="line"><span class="comment">[输入]不支持。设置为NULL。</span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">ReadFile</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  HANDLE hFile,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPVOID lpBuffer,</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD nNumberOfBytesToRead,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPDWORD lpNumberOfBytesRead,</span></span></span><br><span class="line"><span class="function"><span class="params">  LPOVERLAPPED lpOverlapped</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">参量</span></span><br><span class="line"><span class="comment">hFile</span></span><br><span class="line"><span class="comment">[in]处理要读取的文件。必须已使用GENERIC_READ访问该文件的文件句柄。此参数不能是套接字句柄。</span></span><br><span class="line"><span class="comment">lpBuffer</span></span><br><span class="line"><span class="comment">[out]指向缓冲区的指针，该缓冲区接收从文件读取的数据。</span></span><br><span class="line"><span class="comment">nNumberOfBytesToRead</span></span><br><span class="line"><span class="comment">[in]要从文件读取的字节数。</span></span><br><span class="line"><span class="comment">lpNumberOfBytesRead</span></span><br><span class="line"><span class="comment">[out]指向读取的字节数的指针。在执行操作或检查错误之前，此功能将此值设置为零。</span></span><br><span class="line"><span class="comment">lpOverlapped</span></span><br><span class="line"><span class="comment">[输入]不支持。设置为NUL</span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure>

<h3 id="AEH"><a href="#AEH" class="headerlink" title="AEH"></a>AEH</h3><p>AddVectoredExceptionHandler function</p>
<p>Registers a vectored exception handler.</p>
<ul>
<li>Syntax</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">PVOID <span class="title">AddVectoredExceptionHandler</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  ULONG                       First,</span></span></span><br><span class="line"><span class="function"><span class="params">  PVECTORED_EXCEPTION_HANDLER Handler</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>Return value</li>
</ul>
<p>If the function succeeds, the return value is a handle to the exception handler.</p>
<p>If the function fails, the return value is <strong>NULL</strong>.</p>
<p><a href="http://www.manongjc.com/article/36495.html" target="_blank" rel="noopener">异常处理</a></p>
<h3 id="pysm4"><a href="#pysm4" class="headerlink" title="pysm4"></a>pysm4</h3><p>pysm4是国密SM4算法的Python实现， 提供了<code>encrypt</code>、 <code>decrypt</code>、 <code>encrypt_ecb</code>、 <code>decrypt_ecb</code>、 <code>encrypt_cbc</code>、 <code>decrypt_cbc</code>等函数用于加密解密， 用法如下：</p>
<h4 id="1-encrypt和decrypt"><a href="#1-encrypt和decrypt" class="headerlink" title="1. encrypt和decrypt"></a>1. <code>encrypt</code>和<code>decrypt</code></h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; from pysm4 import encrypt, decrypt</span><br><span class="line"><span class="comment"># 明文</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; clear_num = <span class="number">0x0123456789abcdeffedcba9876543210</span></span><br><span class="line"><span class="comment"># 密钥</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; mk = <span class="number">0x0123456789abcdeffedcba9876543210</span></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; cipher_num = encrypt(clear_num, mk)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; hex(cipher_num)[<span class="number">2</span><span class="symbol">:</span>].replace(<span class="string">'L'</span>, <span class="string">''</span>)</span><br><span class="line"><span class="string">'681edf34d206965e86b3e94f536e4246'</span></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; clear_num == decrypt(cipher_num, mk)</span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<h4 id="2-encrypt-ecb和decrypt-ecb"><a href="#2-encrypt-ecb和decrypt-ecb" class="headerlink" title="2. encrypt_ecb和decrypt_ecb"></a>2. <code>encrypt_ecb</code>和<code>decrypt_ecb</code></h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; from pysm4 import encrypt_ecb, decrypt_ecb</span><br><span class="line"><span class="comment"># 明文</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; plain_text = <span class="string">'pysm4是国密SM4算法的Python实现'</span></span><br><span class="line"><span class="comment"># 密钥</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; key = <span class="string">'hello, world!'</span>  <span class="comment"># 密钥长度小于等于16字节</span></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; cipher_text = encrypt_ecb(plain_text, key)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; cipher_text</span><br><span class="line"><span class="string">'ng3L4ldgvsZciAgx3LhplDvIzrd0+GXiNqNmd1VW0YOlwo+ojtpownOCbnxbq/3y'</span></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; plain_text == decrypt_ecb(cipher_text, key)</span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<h4 id="3-encrypt-cbc和decrypt-cbc"><a href="#3-encrypt-cbc和decrypt-cbc" class="headerlink" title="3. encrypt_cbc和decrypt_cbc"></a>3. <code>encrypt_cbc</code>和<code>decrypt_cbc</code></h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; from pysm4 import encrypt_cbc, decrypt_cbc</span><br><span class="line"><span class="comment"># 明文</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; plain_text = <span class="string">'pysm4是国密SM4算法的Python实现'</span></span><br><span class="line"><span class="comment"># 密钥</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; key = <span class="string">'hello, world!'</span>  <span class="comment"># 密钥 长度小于等于16字节</span></span><br><span class="line"><span class="comment"># 初始化向量</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; iv = <span class="string">'11111111'</span>        <span class="comment"># 初始化向量  长度小于等于16字节</span></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; cipher_text = encrypt_cbc(plain_text, key, iv)</span><br><span class="line"><span class="string">'cTsdKRSH2FqIJf22NHMjX5ZFHghR4ZtJ10wbNwj2//bJSElBXVeMtFycjdlVKP15'</span></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; plain_text == decrypt_cbc(cipher_text, key, iv)</span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<h3 id="idc"><a href="#idc" class="headerlink" title="idc"></a>idc</h3><p><a href="https://blog.csdn.net/jazrynwong/article/details/84875699" target="_blank" rel="noopener">idc基础</a></p>
<h2 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h2><h3 id="CryptCreateHash-ALG-ID"><a href="#CryptCreateHash-ALG-ID" class="headerlink" title="CryptCreateHash:ALG_ID"></a>CryptCreateHash:ALG_ID</h3><table>
<thead>
<tr>
<th align="left">Identifier</th>
<th align="left">Value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CALG_3DES</td>
<td align="left">0x00006603</td>
<td align="left"><a href="https://docs.microsoft.com/windows/desktop/SecGloss/t-gly" target="_blank" rel="noopener"><em>Triple DES</em></a> encryption algorithm.</td>
</tr>
<tr>
<td align="left">CALG_3DES_112</td>
<td align="left">0x00006609</td>
<td align="left">Two-key <a href="https://docs.microsoft.com/windows/desktop/SecGloss/t-gly" target="_blank" rel="noopener"><em>triple DES</em></a> encryption with effective key length equal to 112 bits.</td>
</tr>
<tr>
<td align="left">CALG_AES</td>
<td align="left">0x00006611</td>
<td align="left">Advanced Encryption Standard (AES). This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-aes-cryptographic-provider" target="_blank" rel="noopener">Microsoft AES Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_AES_128</td>
<td align="left">0x0000660e</td>
<td align="left">128 bit AES. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-aes-cryptographic-provider" target="_blank" rel="noopener">Microsoft AES Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_AES_192</td>
<td align="left">0x0000660f</td>
<td align="left">192 bit AES. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-aes-cryptographic-provider" target="_blank" rel="noopener">Microsoft AES Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_AES_256</td>
<td align="left">0x00006610</td>
<td align="left">256 bit AES. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-aes-cryptographic-provider" target="_blank" rel="noopener">Microsoft AES Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_AGREEDKEY_ANY</td>
<td align="left">0x0000aa03</td>
<td align="left">Temporary algorithm identifier for handles of Diffie-Hellman–agreed keys.</td>
</tr>
<tr>
<td align="left">CALG_CYLINK_MEK</td>
<td align="left">0x0000660c</td>
<td align="left">An algorithm to create a 40-bit DES key that has parity bits and zeroed key bits to make its key length 64 bits. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_DES</td>
<td align="left">0x00006601</td>
<td align="left">DES encryption algorithm.</td>
</tr>
<tr>
<td align="left">CALG_DESX</td>
<td align="left">0x00006604</td>
<td align="left">DESX encryption algorithm.</td>
</tr>
<tr>
<td align="left">CALG_DH_EPHEM</td>
<td align="left">0x0000aa02</td>
<td align="left">Diffie-Hellman ephemeral key exchange algorithm.</td>
</tr>
<tr>
<td align="left">CALG_DH_SF</td>
<td align="left">0x0000aa01</td>
<td align="left">Diffie-Hellman store and forward key exchange algorithm.</td>
</tr>
<tr>
<td align="left">CALG_DSS_SIGN</td>
<td align="left">0x00002200</td>
<td align="left">DSA <a href="https://docs.microsoft.com/windows/desktop/SecGloss/p-gly" target="_blank" rel="noopener"><em>public key</em></a> signature algorithm.</td>
</tr>
<tr>
<td align="left">CALG_ECDH</td>
<td align="left">0x0000aa05</td>
<td align="left">Elliptic curve Diffie-Hellman key exchange algorithm.[!Note] This algorithm is supported only through <a href="https://docs.microsoft.com/windows/desktop/SecCNG/cng-portal" target="_blank" rel="noopener">Cryptography API: Next Generation</a>. <strong>Windows Server 2003 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_ECDH_EPHEM</td>
<td align="left">0x0000ae06</td>
<td align="left">Ephemeral elliptic curve Diffie-Hellman key exchange algorithm.[!Note] This algorithm is supported only through <a href="https://docs.microsoft.com/windows/desktop/SecCNG/cng-portal" target="_blank" rel="noopener">Cryptography API: Next Generation</a>. <strong>Windows Server 2003 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_ECDSA</td>
<td align="left">0x00002203</td>
<td align="left">Elliptic curve digital signature algorithm.[!Note] This algorithm is supported only through <a href="https://docs.microsoft.com/windows/desktop/SecCNG/cng-portal" target="_blank" rel="noopener">Cryptography API: Next Generation</a>. <strong>Windows Server 2003 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_ECMQV</td>
<td align="left">0x0000a001</td>
<td align="left">Elliptic curve Menezes, Qu, and Vanstone (MQV) key exchange algorithm. This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_HASH_REPLACE_OWF</td>
<td align="left">0x0000800b</td>
<td align="left">One way function hashing algorithm.</td>
</tr>
<tr>
<td align="left">CALG_HUGHES_MD5</td>
<td align="left">0x0000a003</td>
<td align="left">Hughes MD5 hashing algorithm.</td>
</tr>
<tr>
<td align="left">CALG_HMAC</td>
<td align="left">0x00008009</td>
<td align="left">HMAC keyed hash algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_KEA_KEYX</td>
<td align="left">0x0000aa04</td>
<td align="left">KEA key exchange algorithm (FORTEZZA). This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_MAC</td>
<td align="left">0x00008005</td>
<td align="left"><a href="https://docs.microsoft.com/windows/desktop/SecGloss/m-gly" target="_blank" rel="noopener"><em>MAC</em></a> keyed hash algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_MD2</td>
<td align="left">0x00008001</td>
<td align="left">MD2 hashing algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_MD4</td>
<td align="left">0x00008002</td>
<td align="left">MD4 hashing algorithm.</td>
</tr>
<tr>
<td align="left">CALG_MD5</td>
<td align="left">0x00008003</td>
<td align="left">MD5 hashing algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_NO_SIGN</td>
<td align="left">0x00002000</td>
<td align="left">No signature algorithm.</td>
</tr>
<tr>
<td align="left">CALG_OID_INFO_CNG_ONLY</td>
<td align="left">0xffffffff</td>
<td align="left">The algorithm is only implemented in CNG. The macro, IS_SPECIAL_OID_INFO_ALGID, can be used to determine whether a cryptography algorithm is only supported by using the CNG functions.</td>
</tr>
<tr>
<td align="left">CALG_OID_INFO_PARAMETERS</td>
<td align="left">0xfffffffe</td>
<td align="left">The algorithm is defined in the encoded parameters. The algorithm is only supported by using CNG. The macro, IS_SPECIAL_OID_INFO_ALGID, can be used to determine whether a cryptography algorithm is only supported by using the CNG functions.</td>
</tr>
<tr>
<td align="left">CALG_PCT1_MASTER</td>
<td align="left">0x00004c04</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_RC2</td>
<td align="left">0x00006602</td>
<td align="left">RC2 block encryption algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_RC4</td>
<td align="left">0x00006801</td>
<td align="left">RC4 stream encryption algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_RC5</td>
<td align="left">0x0000660d</td>
<td align="left">RC5 block encryption algorithm.</td>
</tr>
<tr>
<td align="left">CALG_RSA_KEYX</td>
<td align="left">0x0000a400</td>
<td align="left">RSA public key exchange algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_RSA_SIGN</td>
<td align="left">0x00002400</td>
<td align="left">RSA public key signature algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_SCHANNEL_ENC_KEY</td>
<td align="left">0x00004c07</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SCHANNEL_MAC_KEY</td>
<td align="left">0x00004c03</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SCHANNEL_MASTER_HASH</td>
<td align="left">0x00004c02</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SEAL</td>
<td align="left">0x00006802</td>
<td align="left">SEAL encryption algorithm. This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SHA</td>
<td align="left">0x00008004</td>
<td align="left">SHA hashing algorithm. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_SHA1</td>
<td align="left">0x00008004</td>
<td align="left">Same as <strong>CALG_SHA</strong>. This algorithm is supported by the <a href="https://docs.microsoft.com/zh-cn/windows/win32/seccrypto/microsoft-base-cryptographic-provider" target="_blank" rel="noopener">Microsoft Base Cryptographic Provider</a>.</td>
</tr>
<tr>
<td align="left">CALG_SHA_256</td>
<td align="left">0x0000800c</td>
<td align="left">256 bit SHA hashing algorithm. This algorithm is supported by Microsoft Enhanced RSA and AES Cryptographic Provider..<strong>Windows XP with SP3:</strong> This algorithm is supported by the Microsoft Enhanced RSA and AES Cryptographic Provider (Prototype). <strong>Windows XP with SP2, Windows XP with SP1 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SHA_384</td>
<td align="left">0x0000800d</td>
<td align="left">384 bit SHA hashing algorithm. This algorithm is supported by Microsoft Enhanced RSA and AES Cryptographic Provider.<strong>Windows XP with SP3:</strong> This algorithm is supported by the Microsoft Enhanced RSA and AES Cryptographic Provider (Prototype). <strong>Windows XP with SP2, Windows XP with SP1 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SHA_512</td>
<td align="left">0x0000800e</td>
<td align="left">512 bit SHA hashing algorithm. This algorithm is supported by Microsoft Enhanced RSA and AES Cryptographic Provider.<strong>Windows XP with SP3:</strong> This algorithm is supported by the Microsoft Enhanced RSA and AES Cryptographic Provider (Prototype). <strong>Windows XP with SP2, Windows XP with SP1 and Windows XP:</strong> This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SKIPJACK</td>
<td align="left">0x0000660a</td>
<td align="left">Skipjack block encryption algorithm (FORTEZZA). This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_SSL2_MASTER</td>
<td align="left">0x00004c05</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SSL3_MASTER</td>
<td align="left">0x00004c01</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_SSL3_SHAMD5</td>
<td align="left">0x00008008</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_TEK</td>
<td align="left">0x0000660b</td>
<td align="left">TEK (FORTEZZA). This algorithm is not supported.</td>
</tr>
<tr>
<td align="left">CALG_TLS1_MASTER</td>
<td align="left">0x00004c06</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
<tr>
<td align="left">CALG_TLS1PRF</td>
<td align="left">0x0000800a</td>
<td align="left">Used by the Schannel.dll operations system. This <strong>ALG_ID</strong> should not be used by applications.</td>
</tr>
</tbody></table>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/buuctf/" rel="tag"># buuctf</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/25/成绩单/" rel="next" title="成绩单">
                <i class="fa fa-chevron-left"></i> 成绩单
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/01/09/hello-world/" rel="prev" title="Hello World">
                Hello World <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/zzx.jpg" alt="SunDaSheng">
            
              <p class="site-author-name" itemprop="name">SunDaSheng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/st12138" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:best_st@outlook.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#day1-5-5"><span class="nav-number">1.</span> <span class="nav-text">day1    5.5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#easyre"><span class="nav-number">1.1.</span> <span class="nav-text">easyre</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse1"><span class="nav-number">1.2.</span> <span class="nav-text">reverse1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reserve2"><span class="nav-number">1.3.</span> <span class="nav-text">reserve2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#新年快乐"><span class="nav-number">1.4.</span> <span class="nav-text">新年快乐</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day2-5-6"><span class="nav-number">2.</span> <span class="nav-text">day2    5.6</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#helloworld"><span class="nav-number">2.1.</span> <span class="nav-text">helloworld</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内涵软件"><span class="nav-number">2.2.</span> <span class="nav-text">内涵软件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xor"><span class="nav-number">2.3.</span> <span class="nav-text">xor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#guessgame"><span class="nav-number">2.4.</span> <span class="nav-text">guessgame</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reserve-3"><span class="nav-number">2.5.</span> <span class="nav-text">reserve_3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day3-5-7"><span class="nav-number">3.</span> <span class="nav-text">day3    5.7</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#不一样的flag"><span class="nav-number">3.1.</span> <span class="nav-text">不一样的flag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#刮开有奖"><span class="nav-number">3.2.</span> <span class="nav-text">刮开有奖</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day4-5-8"><span class="nav-number">4.</span> <span class="nav-text">day4    5.8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#simpleRev"><span class="nav-number">4.1.</span> <span class="nav-text">simpleRev</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#java逆向解密"><span class="nav-number">4.2.</span> <span class="nav-text">java逆向解密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#findit"><span class="nav-number">4.3.</span> <span class="nav-text">findit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8086"><span class="nav-number">4.4.</span> <span class="nav-text">8086</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rsa"><span class="nav-number">4.5.</span> <span class="nav-text">rsa</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day5-5-9"><span class="nav-number">5.</span> <span class="nav-text">day5    5.9</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CrackRTF"><span class="nav-number">5.1.</span> <span class="nav-text">CrackRTF</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day6-5-10"><span class="nav-number">6.</span> <span class="nav-text">day6    5.10</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注册器"><span class="nav-number">6.1.</span> <span class="nav-text">注册器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#luck-guy"><span class="nav-number">6.2.</span> <span class="nav-text">luck_guy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#younger-drive"><span class="nav-number">6.3.</span> <span class="nav-text">younger_drive</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day7-5-11"><span class="nav-number">7.</span> <span class="nav-text">day7    5.11</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pyre"><span class="nav-number">7.1.</span> <span class="nav-text">pyre</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#相册"><span class="nav-number">7.2.</span> <span class="nav-text">相册</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyRE"><span class="nav-number">7.3.</span> <span class="nav-text">easyRE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day8-5-12"><span class="nav-number">8.</span> <span class="nav-text">day8   5.12</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#singin"><span class="nav-number">8.1.</span> <span class="nav-text">singin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#justre"><span class="nav-number">8.2.</span> <span class="nav-text">justre</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day9-5-13"><span class="nav-number">9.</span> <span class="nav-text">day9 5.13</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#strngecpp"><span class="nav-number">9.1.</span> <span class="nav-text">strngecpp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day10-5-14"><span class="nav-number">10.</span> <span class="nav-text">day10   5.14</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day11-5-15"><span class="nav-number">11.</span> <span class="nav-text">day11 5.15</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#re"><span class="nav-number">11.1.</span> <span class="nav-text">re</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crackMe"><span class="nav-number">11.2.</span> <span class="nav-text">crackMe</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day12-5-16"><span class="nav-number">12.</span> <span class="nav-text">day12 5.16</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GUET-2019-re"><span class="nav-number">12.1.</span> <span class="nav-text">[GUET-2019]re</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day13-5-17"><span class="nav-number">13.</span> <span class="nav-text">day13 5.17</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CSre"><span class="nav-number">13.1.</span> <span class="nav-text">CSre</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day14-5-18"><span class="nav-number">14.</span> <span class="nav-text">day14 5.18</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ACTF新生赛2020-easyre"><span class="nav-number">14.1.</span> <span class="nav-text">[ACTF新生赛2020]easyre</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FlareOn4-login"><span class="nav-number">14.2.</span> <span class="nav-text">[FlareOn4]login</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day15-5-19"><span class="nav-number">15.</span> <span class="nav-text">day15 5.19</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BJDCTF2020-easy"><span class="nav-number">15.1.</span> <span class="nav-text">[BJDCTF2020]easy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GXYCTF2019-simple-CPP"><span class="nav-number">15.2.</span> <span class="nav-text">[GXYCTF2019]simple CPP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day16-5-20"><span class="nav-number">16.</span> <span class="nav-text">day16 5.20</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#xxor"><span class="nav-number">16.1.</span> <span class="nav-text">xxor</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day17-5-21"><span class="nav-number">17.</span> <span class="nav-text">day17 5.21</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BJDCTF2020-BJD-hamburger-competition"><span class="nav-number">17.1.</span> <span class="nav-text">[BJDCTF2020]BJD hamburger competition</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day18-5-22"><span class="nav-number">18.</span> <span class="nav-text">day18 5.22</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#usualcrypt"><span class="nav-number">18.1.</span> <span class="nav-text">usualcrypt</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day19-5-23"><span class="nav-number">19.</span> <span class="nav-text">day19 5.23</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FlareOn4-IgniteMe"><span class="nav-number">19.1.</span> <span class="nav-text">[FlareOn4]IgniteMe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rome"><span class="nav-number">19.2.</span> <span class="nav-text">rome</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day20-5-24"><span class="nav-number">20.</span> <span class="nav-text">day20 5.24</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day21-5-25"><span class="nav-number">21.</span> <span class="nav-text">day21 5.25</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#19红帽-xx"><span class="nav-number">21.1.</span> <span class="nav-text">[19红帽]xx</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day22-5-27"><span class="nav-number">22.</span> <span class="nav-text">day22 5.27</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MRCTF2020-Transform"><span class="nav-number">22.1.</span> <span class="nav-text">[MRCTF2020]Transform</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HDCTF2019-Maze"><span class="nav-number">22.2.</span> <span class="nav-text">[HDCTF2019]Maze</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day23-5-29"><span class="nav-number">23.</span> <span class="nav-text">day23 5.29</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WUSTCTF2020-level1"><span class="nav-number">23.1.</span> <span class="nav-text">[WUSTCTF2020]level1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安洵杯-2019-crackMe"><span class="nav-number">23.2.</span> <span class="nav-text">[安洵杯 2019]crackMe</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day24-5-30"><span class="nav-number">24.</span> <span class="nav-text">day24 5.30</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#eqution"><span class="nav-number">24.1.</span> <span class="nav-text">eqution</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day25-5-31"><span class="nav-number">25.</span> <span class="nav-text">day25 5.31</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WUSTCTF2020-level2"><span class="nav-number">25.1.</span> <span class="nav-text">[WUSTCTF2020]level2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FlareOn6-Overlong"><span class="nav-number">25.2.</span> <span class="nav-text">[FlareOn6]Overlong</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day26-6-1-6-2"><span class="nav-number">26.</span> <span class="nav-text">day26 6.1+6.2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GWCTF-2019-re3"><span class="nav-number">26.1.</span> <span class="nav-text">[GWCTF 2019]re3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day27-6-3"><span class="nav-number">27.</span> <span class="nav-text">day27 6.3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GUET-CTF2019-number-game"><span class="nav-number">27.1.</span> <span class="nav-text">[GUET-CTF2019]number_game</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day28-6-5"><span class="nav-number">28.</span> <span class="nav-text">day28 6.5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2019红帽杯-childRE"><span class="nav-number">28.1.</span> <span class="nav-text">[2019红帽杯]childRE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day29-6-6"><span class="nav-number">29.</span> <span class="nav-text">day29 6.6</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MRCTF2020-Xor"><span class="nav-number">29.1.</span> <span class="nav-text">[MRCTF2020]Xor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#findKey"><span class="nav-number">29.2.</span> <span class="nav-text">findKey</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day30-6-9"><span class="nav-number">30.</span> <span class="nav-text">day30 6.9</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WUSTCTF2020-level3"><span class="nav-number">30.1.</span> <span class="nav-text">[WUSTCTF2020]level3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day31-6-23"><span class="nav-number">31.</span> <span class="nav-text">day31 6.23</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MRCTF2020-hello-world-go"><span class="nav-number">31.1.</span> <span class="nav-text">[MRCTF2020]hello_world_go</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day32-7-1"><span class="nav-number">32.</span> <span class="nav-text">day32 7.1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FlareOn5-Minesweeper-Championship-Registration"><span class="nav-number">32.1.</span> <span class="nav-text">[FlareOn5]Minesweeper Championship Registration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网鼎杯-2020-青龙组-singal"><span class="nav-number">32.2.</span> <span class="nav-text">[网鼎杯 2020 青龙组]singal</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day33-7-2"><span class="nav-number">33.</span> <span class="nav-text">day33 7.2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MRCTF2020-PixelShooter"><span class="nav-number">33.1.</span> <span class="nav-text">[MRCTF2020]PixelShooter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RoarCTF2019-polyre"><span class="nav-number">33.2.</span> <span class="nav-text">[RoarCTF2019]polyre</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day34-7-3"><span class="nav-number">34.</span> <span class="nav-text">day34 7.3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GKCTF2020-Chelly’s-identity"><span class="nav-number">34.1.</span> <span class="nav-text">[GKCTF2020]Chelly’s identity</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day35-7-8"><span class="nav-number">35.</span> <span class="nav-text">day35 7.8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#challenge1"><span class="nav-number">35.1.</span> <span class="nav-text">challenge1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Zer0pts2020-easy-strcmp"><span class="nav-number">35.2.</span> <span class="nav-text">[Zer0pts2020]easy strcmp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day36-7-13"><span class="nav-number">36.</span> <span class="nav-text">day36 7.13</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安洵杯-2019-game"><span class="nav-number">36.1.</span> <span class="nav-text">[安洵杯 2019]game</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ACTF新生赛2020-Universe-final-answer"><span class="nav-number">36.2.</span> <span class="nav-text">[ACTF新生赛2020]Universe_final_answer</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day37-7-31"><span class="nav-number">37.</span> <span class="nav-text">day37 7.31</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ACTF新生赛2020-Oruga"><span class="nav-number">37.1.</span> <span class="nav-text">[ACTF新生赛2020]Oruga</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day38-8-1"><span class="nav-number">38.</span> <span class="nav-text">day38 8.1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FlareOn5-Ultimate-Minesweeper"><span class="nav-number">38.1.</span> <span class="nav-text">[FlareOn5]Ultimate Minesweeper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安洵杯-2019-game-1"><span class="nav-number">38.2.</span> <span class="nav-text">[安洵杯 2019]game</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#知识点"><span class="nav-number">39.</span> <span class="nav-text">知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#lo、hiword"><span class="nav-number">39.1.</span> <span class="nav-text">lo、hiword</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IDA逆向常用宏定义"><span class="nav-number">39.2.</span> <span class="nav-text">IDA逆向常用宏定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tea-XTea-XXTea"><span class="nav-number">39.3.</span> <span class="nav-text">Tea/XTea/XXTea</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Tea"><span class="nav-number">39.3.1.</span> <span class="nav-text">Tea</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XTea"><span class="nav-number">39.3.2.</span> <span class="nav-text">XTea</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XXTea"><span class="nav-number">39.3.3.</span> <span class="nav-text">XXTea</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#write-readfile"><span class="nav-number">39.4.</span> <span class="nav-text">write/readfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AEH"><span class="nav-number">39.5.</span> <span class="nav-text">AEH</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pysm4"><span class="nav-number">39.6.</span> <span class="nav-text">pysm4</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-encrypt和decrypt"><span class="nav-number">39.6.1.</span> <span class="nav-text">1. encrypt和decrypt</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-encrypt-ecb和decrypt-ecb"><span class="nav-number">39.6.2.</span> <span class="nav-text">2. encrypt_ecb和decrypt_ecb</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-encrypt-cbc和decrypt-cbc"><span class="nav-number">39.6.3.</span> <span class="nav-text">3. encrypt_cbc和decrypt_cbc</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#idc"><span class="nav-number">39.7.</span> <span class="nav-text">idc</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附件"><span class="nav-number">40.</span> <span class="nav-text">附件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CryptCreateHash-ALG-ID"><span class="nav-number">40.1.</span> <span class="nav-text">CryptCreateHash:ALG_ID</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SunDaSheng</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">40k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
